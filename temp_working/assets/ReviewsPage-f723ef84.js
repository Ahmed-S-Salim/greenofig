import{j as e}from"./vendor-ui-1f4695e3.js";import{r as s}from"./vendor-react-c35372bd.js";import{u as r,H as i,D as t,j as a,B as l,b as n,d as o,e as c,f as d,A as m,k as x,l as v,L as h,I as p,T as j,m as w,s as g,t as u}from"./index-6b8dec48.js";import{S as y}from"./SiteLayout-a0a74e79.js";import{C as f,c as N}from"./card-337a2a4f.js";import{aa as b,L as _,m as S,a3 as F,h as q}from"./vendor-utils-a892ab91.js";import"./vendor-editor-8f9f6f2d.js";import"./OnboardingSurvey-3783d7af.js";const C=({review:s,index:i})=>{const{i18n:t}=r(),a={hidden:{opacity:0,y:50},visible:{opacity:1,y:0,transition:{delay:.1*i}}},l=t.language,n="ar"===l&&s.customer_title_ar?s.customer_title_ar:s.customer_title,o="ar"===l&&s.quote_ar?s.quote_ar:s.quote;return e.jsx(S.div,{variants:a,initial:"hidden",animate:"visible",children:e.jsx(f,{className:"glass-effect h-full flex flex-col",children:e.jsxs(N,{className:"p-6 flex flex-col flex-grow",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsxs(m,{className:"h-12 w-12 border-2 border-primary",children:[e.jsx(x,{src:s.avatar_url||s.customer_image,alt:s.customer_name}),e.jsx(v,{children:(c=s.customer_name,c?c.split(" ").map(e=>e[0]).join("").toUpperCase():"U")})]}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"font-bold text-lg",children:s.customer_name}),n&&e.jsx("p",{className:"text-xs text-text-secondary",children:n}),e.jsx("div",{className:"flex items-center",children:[...Array(5)].map((r,i)=>e.jsx(F,{className:"w-4 h-4 "+(i<s.rating?"text-yellow-400 fill-yellow-400":"text-gray-500")},i))})]})]}),e.jsx("p",{className:"text-text-secondary text-sm flex-grow",children:o})]})})});var c},D=({setOpen:i})=>{const{t:t}=r(),[a,n]=s.useState({name:"",title:"",review:"",rating:0}),[o,c]=s.useState(!1);return e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),0!==a.rating){c(!0);try{const{error:e}=await g.from("testimonials").insert([{customer_name:a.name,customer_title:a.title,quote:a.review,rating:a.rating,is_featured:!1,is_approved:!0,display_order:9999,created_at:(new Date).toISOString()}]);if(e)throw e;u({title:t("reviews.reviewSubmitted"),description:t("reviews.thankYou")}),i(!1),window.location.reload()}catch(s){u({title:t("reviews.submissionFailed"),description:s.message||t("reviews.tryAgainLater"),variant:"destructive"})}finally{c(!1)}}else u({title:t("reviews.ratingRequiredError"),description:t("reviews.ratingRequiredMessage"),variant:"destructive"})},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"name",children:t("reviews.yourName")}),e.jsx(p,{id:"name",placeholder:t("reviews.namePlaceholder"),value:a.name,onChange:e=>n({...a,name:e.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"review-title",children:t("reviews.reviewTitle")}),e.jsx(p,{id:"review-title",placeholder:t("reviews.reviewTitlePlaceholder"),value:a.title,onChange:e=>n({...a,title:e.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"review",children:t("reviews.yourReview")}),e.jsx(j,{id:"review",placeholder:t("reviews.reviewPlaceholder"),value:a.review,onChange:e=>n({...a,review:e.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:t("reviews.ratingRequired")}),e.jsx("div",{className:"flex items-center space-x-1",children:[...Array(5)].map((s,r)=>e.jsx(F,{className:"w-6 h-6 cursor-pointer transition-colors "+(r<a.rating?"text-yellow-400 fill-yellow-400":"text-gray-300 hover:text-yellow-400"),onClick:()=>n({...a,rating:r+1})},r))})]}),e.jsx(w,{children:e.jsx(l,{type:"submit",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"mr-2 h-4 w-4 animate-spin"}),t("reviews.submitting")]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),t("reviews.submitReview")]})})})]})},R=({logoUrl:m})=>{const{t:x,i18n:v}=r(),[h,p]=s.useState(!1),[j,w]=s.useState([]),[f,N]=s.useState(!0);return s.useEffect(()=>{(async()=>{N(!0);const{data:e,error:s}=await g.from("testimonials").select("*").eq("is_approved",!0).order("created_at",{ascending:!1});s?(u({title:x("reviews.errorLoadingReviews"),description:s.message,variant:"destructive"}),w([])):w(e||[]),N(!1)})()},[x,v.language]),e.jsxs(e.Fragment,{children:[e.jsxs(i,{children:[e.jsxs("title",{children:[x("reviews.title")," - GreenoFig"]}),e.jsx("meta",{name:"description",content:x("reviews.metaDescription")}),e.jsx("link",{rel:"canonical",href:"https://greenofig.com/reviews"}),e.jsx("meta",{property:"og:title",content:`${x("reviews.title")} - GreenoFig`}),e.jsx("meta",{property:"og:description",content:x("reviews.metaDescription")}),e.jsx("meta",{property:"og:url",content:"https://greenofig.com/reviews"}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{name:"robots",content:"index, follow"})]}),e.jsxs(y,{logoUrl:m,pageTitle:e.jsx(e.Fragment,{children:x("reviews.pageTitle")}),pageDescription:x("reviews.pageDescription"),children:[e.jsx("div",{className:"text-center mb-12",children:e.jsxs(t,{open:h,onOpenChange:p,children:[e.jsx(a,{asChild:!0,children:e.jsxs(l,{size:"lg",className:"bg-primary hover:bg-primary/90 hover:shadow-xl transition-all text-primary-foreground shadow-lg",children:[e.jsx(b,{className:"mr-2 h-5 w-5"}),x("reviews.writeReview")]})}),e.jsxs(n,{className:"sm:max-w-[425px] glass-effect",children:[e.jsxs(o,{children:[e.jsx(c,{children:x("reviews.shareYourStory")}),e.jsx(d,{children:x("reviews.experienceDescription")})]}),e.jsx(D,{setOpen:p})]})]})}),f?e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx(_,{className:"w-12 h-12 animate-spin text-primary"})}):0===j.length?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:x("reviews.noReviewsYet")}),e.jsx("p",{className:"text-text-secondary mt-2",children:x("reviews.beTheFirst")})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:j.map((s,r)=>e.jsx(C,{review:s,index:r},s.id||r))})]})]})};export{R as default};
