var e=Object.defineProperty,s=(s,t,a)=>(((s,t,a)=>{t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a})(s,"symbol"!=typeof t?t+"":t,a),a);import{j as t}from"./vendor-ui-1f4695e3.js";import{R as a,u as l,r as i}from"./vendor-react-c35372bd.js";import{B as n,s as r,t as c,I as o,g as d,L as m}from"./index-6b8dec48.js";import{C as h,a as x,b as u,c as p,e as g}from"./card-337a2a4f.js";import{au as j,aQ as v,L as f,aq as w,F as N,y,p as b,g as S,aE as k,ar as C,cp as _,at as P,aJ as T,E as A,C as E,i as I,a1 as D,X as M,z as $,as as O,S as F,cq as B,a_ as z,aI as G,aA as q,a2 as R,a8 as L,a6 as W,cr as V,cs as U,w as H,aG as J}from"./vendor-utils-a892ab91.js";import{T as Q,a as K,b as Y,c as X}from"./tabs-fb6868c7.js";import{C as Z}from"./checkbox-7ffa2cd8.js";import{S as ee,a as se,b as te,c as ae,d as le}from"./select-2a07d39b.js";import{S as ie}from"./switch-9ad3fbc0.js";import{A as ne}from"./AIBlogAssistant-056e3d94.js";import re from"./BlogTagsManager-515206b7.js";class ce extends a.Component{constructor(e){super(e),s(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})}),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,s){this.setState({error:e,errorInfo:s})}render(){return this.state.hasError?t.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:t.jsxs(h,{className:"max-w-2xl w-full glass-effect",children:[t.jsx(x,{children:t.jsxs(u,{className:"flex items-center gap-3 text-2xl",children:[t.jsx(j,{className:"w-8 h-8 text-red-500"}),"Something Went Wrong"]})}),t.jsxs(p,{className:"space-y-4",children:[t.jsx("p",{className:"text-text-secondary",children:"We encountered an unexpected error. This has been logged and we'll look into it."}),this.state.error&&t.jsx("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-lg",children:t.jsx("p",{className:"font-mono text-sm text-red-400",children:this.state.error.toString()})}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs(n,{onClick:this.handleReset,className:"flex items-center gap-2",children:[t.jsx(v,{className:"w-4 h-4"}),"Try Again"]}),t.jsx(n,{variant:"outline",onClick:()=>{const e=window.location.hostname.includes("github.io")?"/greenofig":"";window.location.href=`${e}/app/admin`},children:"Go to Dashboard"})]}),!1]})]})}):this.props.children}}const oe=({user:e})=>{const s=l(),[a,m]=i.useState([]),[F,B]=i.useState([]),[z,G]=i.useState([]),[q,R]=i.useState(""),[L,W]=i.useState("all"),[V,U]=i.useState("all"),[H,J]=i.useState("all"),[ee,se]=i.useState(!0),[te,ae]=i.useState("posts"),[le,ie]=i.useState([]),[ne,re]=i.useState([]),[ce,oe]=i.useState([]),[de,me]=i.useState([]),[he,xe]=i.useState({totalPosts:0,publishedPosts:0,draftPosts:0,scheduledPosts:0,totalViews:0,totalComments:0,pendingComments:0,avgViewsPerPost:0});i.useEffect(()=>{ue(),pe(),ge(),je(),ve()},[]),i.useEffect(()=>{fe()},[q,L,V,H,a]);const ue=async()=>{se(!0);try{const{data:e,error:s}=await r.from("blog_posts").select("\n          *,\n          author:user_profiles!blog_posts_author_id_fkey(id, full_name, email)\n        ").order("created_at",{ascending:!1});if(s)throw s;m(e||[])}catch(e){c({variant:"destructive",title:"Error",description:"Failed to fetch blog posts"})}finally{se(!1)}},pe=async()=>{try{const{data:e,error:s}=await r.from("blog_categories").select("*").order("name",{ascending:!0});if(s)throw s;B(e||[])}catch(e){}},ge=async()=>{try{const{data:e,error:s}=await r.from("user_profiles").select("id, full_name, email, role").in("role",["nutritionist","admin","super_admin"]).order("full_name",{ascending:!0});if(s)throw s;re(e||[])}catch(e){}},je=async()=>{try{const{data:e,error:s}=await r.from("blog_comments").select("\n          *,\n          blog_post:blog_posts(title, slug),\n          user:user_profiles(full_name)\n        ").order("created_at",{ascending:!1});if(s)throw s;oe(e||[]),me((null==e?void 0:e.filter(e=>!e.is_approved))||[])}catch(e){}},ve=async()=>{try{const{data:e}=await r.from("blog_posts").select("status, view_count"),{data:s}=await r.from("blog_comments").select("is_approved");if(e){const t=e.reduce((e,s)=>e+(s.view_count||0),0),a={totalPosts:e.length,publishedPosts:e.filter(e=>"published"===e.status).length,draftPosts:e.filter(e=>"draft"===e.status).length,scheduledPosts:e.filter(e=>"scheduled"===e.status).length,totalViews:t,totalComments:(null==s?void 0:s.length)||0,pendingComments:(null==s?void 0:s.filter(e=>!e.is_approved).length)||0,avgViewsPerPost:e.length>0?Math.round(t/e.length):0};xe(a)}}catch(e){}},fe=()=>{let e=a;q&&(e=e.filter(e=>{var s,t;return(null==(s=e.title)?void 0:s.toLowerCase().includes(q.toLowerCase()))||(null==(t=e.excerpt)?void 0:t.toLowerCase().includes(q.toLowerCase()))})),"all"!==L&&(e=e.filter(e=>e.status===L)),"all"!==V&&(e=e.filter(e=>e.author_id===V)),"all"!==H&&(e=e.filter(e=>e.category===H)),G(e)},we=async e=>{if(0!==le.length)try{switch(e){case"publish":await r.from("blog_posts").update({status:"published",published_at:(new Date).toISOString()}).in("id",le),c({title:`Published ${le.length} posts`});break;case"draft":await r.from("blog_posts").update({status:"draft"}).in("id",le),c({title:`Moved ${le.length} posts to draft`});break;case"archive":await r.from("blog_posts").update({status:"archived"}).in("id",le),c({title:`Archived ${le.length} posts`});break;case"delete":confirm(`Delete ${le.length} posts permanently?`)&&(await r.from("blog_posts").delete().in("id",le),c({title:`Deleted ${le.length} posts`}))}ie([]),ue(),ve()}catch(s){c({variant:"destructive",title:"Error",description:"Failed to perform bulk action"})}else c({variant:"destructive",title:"No posts selected",description:"Please select posts to perform bulk actions"})},Ne=({icon:e,title:s,value:a,change:l,color:i})=>t.jsx(h,{children:t.jsx(p,{className:"p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:s}),t.jsx("h3",{className:"text-3xl font-bold text-foreground",children:a}),l&&t.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 mt-1 flex items-center gap-1",children:[t.jsx(A,{className:"w-4 h-4"}),l]})]}),t.jsx("div",{className:`p-4 rounded-full ${i||"bg-primary/10"}`,children:t.jsx(e,{className:"w-6 h-6 text-primary"})})]})})}),ye=({post:a})=>{var l;const i=le.includes(a.id);return t.jsx(h,{className:"glass-effect hover:shadow-lg transition-all "+(i?"ring-2 ring-primary":""),children:t.jsxs(p,{className:"p-6",children:[t.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[t.jsx(Z,{checked:i,onCheckedChange:()=>{return e=a.id,void ie(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e]);var e}}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"font-semibold text-lg mb-1",children:a.title}),t.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:a.excerpt||"No excerpt"})]}),t.jsx(d,{className:{draft:"bg-gray-500",published:"bg-green-500",scheduled:"bg-blue-500",archived:"bg-red-500"}[a.status],children:a.status})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx($,{className:"w-4 h-4 text-muted-foreground"}),t.jsx("span",{children:(null==(l=a.author)?void 0:l.full_name)||"Unknown"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(T,{className:"w-4 h-4 text-muted-foreground"}),t.jsxs("span",{children:[a.view_count||0," views"]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(E,{className:"w-4 h-4 text-muted-foreground"}),t.jsx("span",{children:a.published_at?I(new Date(a.published_at),"MMM d"):"Not published"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(b,{className:"w-4 h-4 text-muted-foreground"}),t.jsx("span",{children:a.focus_keyword||"No keyword"})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(n,{variant:"outline",size:"sm",onClick:()=>{const t="nutritionist"===(null==e?void 0:e.role)?"nutritionist":"admin";s(`/app/${t}/blog/edit/${a.id}`)},className:"flex-1",children:[t.jsx(O,{className:"w-4 h-4 mr-1"}),"Edit"]}),t.jsx(n,{variant:"outline",size:"sm",onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this post?"))try{const{error:s}=await r.from("blog_posts").delete().eq("id",e);if(s)throw s;c({title:"Post deleted successfully"}),ue(),ve()}catch(s){c({variant:"destructive",title:"Error",description:"Failed to delete post"})}})(a.id),className:"text-destructive",children:t.jsx(P,{className:"w-4 h-4"})}),"published"===a.status&&t.jsx(n,{variant:"outline",size:"sm",onClick:()=>{const e=window.location.hostname.includes("github.io")?"/greenofig":"";window.open(`${e}/blog/${a.slug}`,"_blank")},children:t.jsx(T,{className:"w-4 h-4"})})]})]})})};return ee?t.jsx("div",{className:"flex items-center justify-center h-96",children:t.jsx(f,{className:"w-12 h-12 animate-spin text-primary"})}):t.jsx("div",{className:"min-h-screen",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-6 py-4 sm:py-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg sm:text-xl lg:text-2xl font-bold",children:"Blog Management"}),t.jsx("p",{className:"text-xs sm:text-sm text-text-secondary mt-1",children:"Manage all blog posts, categories, and comments"})]}),t.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[t.jsxs(n,{variant:"outline",size:"sm",onClick:ue,className:"h-8 px-2 text-xs sm:h-9 sm:px-3 sm:text-sm",children:[t.jsx(v,{className:"w-4 h-4 sm:mr-2"}),t.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),t.jsxs(n,{size:"sm",onClick:()=>{const t="nutritionist"===(null==e?void 0:e.role)?"nutritionist":"admin";s(`/app/${t}/blog/new`)},className:"h-8 px-2 text-xs sm:h-9 sm:px-3 sm:text-sm",children:[t.jsx(w,{className:"w-4 h-4 sm:mr-2"}),t.jsx("span",{className:"hidden sm:inline",children:"Create Post"}),t.jsx("span",{className:"inline sm:hidden",children:"New"})]})]})]}),t.jsxs(Q,{value:te,onValueChange:ae,children:[t.jsx("div",{className:"flex justify-center mb-6",children:t.jsxs(K,{className:"w-full max-w-full overflow-x-auto flex-nowrap scrollbar-hide h-auto justify-start sm:justify-center px-1",children:[t.jsxs(Y,{value:"posts",className:"flex-shrink-0 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[t.jsx(N,{className:"w-3 h-3 sm:w-4 sm:h-4 sm:mr-1"}),t.jsx("span",{className:"hidden sm:inline",children:"Posts"}),t.jsx("span",{className:"inline sm:hidden",children:"Posts"}),t.jsxs("span",{className:"ml-1",children:["(",he.totalPosts,")"]})]}),t.jsxs(Y,{value:"analytics",className:"flex-shrink-0 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[t.jsx(y,{className:"w-3 h-3 sm:w-4 sm:h-4 sm:mr-1"}),t.jsx("span",{className:"hidden sm:inline",children:"Analytics"}),t.jsx("span",{className:"inline sm:hidden",children:"Stats"})]}),t.jsxs(Y,{value:"categories",className:"flex-shrink-0 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[t.jsx(b,{className:"w-3 h-3 sm:w-4 sm:h-4 sm:mr-1"}),t.jsx("span",{className:"hidden sm:inline",children:"Categories"}),t.jsx("span",{className:"inline sm:hidden",children:"Cat"}),t.jsxs("span",{className:"ml-1",children:["(",F.length,")"]})]}),t.jsxs(Y,{value:"comments",className:"flex-shrink-0 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[t.jsx(S,{className:"w-3 h-3 sm:w-4 sm:h-4 sm:mr-1"}),t.jsx("span",{className:"hidden sm:inline",children:"Comments"}),t.jsx("span",{className:"inline sm:hidden",children:"Msgs"}),t.jsxs("span",{className:"ml-1",children:["(",he.pendingComments,")"]})]})]})}),t.jsxs(X,{value:"posts",className:"space-y-4",children:[t.jsx(h,{className:"glass-effect",children:t.jsx(p,{className:"p-4",children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx(k,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),t.jsx(o,{placeholder:"Search posts...",value:q,onChange:e=>R(e.target.value),className:"pl-10"})]}),t.jsxs("select",{value:L,onChange:e=>W(e.target.value),className:"px-3 py-2 bg-background border border-border rounded-md",children:[t.jsx("option",{value:"all",children:"All Status"}),t.jsx("option",{value:"published",children:"Published"}),t.jsx("option",{value:"draft",children:"Draft"}),t.jsx("option",{value:"scheduled",children:"Scheduled"}),t.jsx("option",{value:"archived",children:"Archived"})]}),t.jsxs("select",{value:V,onChange:e=>U(e.target.value),className:"px-3 py-2 bg-background border border-border rounded-md",children:[t.jsx("option",{value:"all",children:"All Authors"}),ne.map(e=>t.jsx("option",{value:e.id,children:e.full_name},e.id))]}),t.jsxs("select",{value:H,onChange:e=>J(e.target.value),className:"px-3 py-2 bg-background border border-border rounded-md",children:[t.jsx("option",{value:"all",children:"All Categories"}),F.map(e=>t.jsx("option",{value:e.slug,children:e.name},e.id))]})]}),le.length>0&&t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 p-3 bg-primary/10 rounded-lg",children:[t.jsxs("span",{className:"text-xs sm:text-sm font-medium",children:[le.length," selected"]}),t.jsxs("div",{className:"flex flex-wrap gap-2 w-full sm:w-auto sm:ml-auto",children:[t.jsxs(n,{size:"sm",variant:"outline",onClick:()=>we("publish"),className:"h-8 px-2 text-xs",children:[t.jsx(C,{className:"w-3 h-3 sm:w-4 sm:h-4 sm:mr-1"}),t.jsx("span",{className:"hidden sm:inline",children:"Publish"})]}),t.jsxs(n,{size:"sm",variant:"outline",onClick:()=>we("draft"),className:"h-8 px-2 text-xs",children:[t.jsx(N,{className:"w-3 h-3 sm:w-4 sm:h-4 sm:mr-1"}),t.jsx("span",{className:"hidden sm:inline",children:"Draft"})]}),t.jsxs(n,{size:"sm",variant:"outline",onClick:()=>we("archive"),className:"h-8 px-2 text-xs",children:[t.jsx(_,{className:"w-3 h-3 sm:w-4 sm:h-4 sm:mr-1"}),t.jsx("span",{className:"hidden sm:inline",children:"Archive"})]}),t.jsxs(n,{size:"sm",variant:"outline",onClick:()=>we("delete"),className:"h-8 px-2 text-xs text-destructive",children:[t.jsx(P,{className:"w-3 h-3 sm:w-4 sm:h-4 sm:mr-1"}),t.jsx("span",{className:"hidden sm:inline",children:"Delete"})]})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Z,{checked:le.length===z.length&&z.length>0,onCheckedChange:()=>{le.length===z.length?ie([]):ie(z.map(e=>e.id))}}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:["Select All (",z.length," posts)"]})]})]})})}),z.length>0?t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:z.map(e=>t.jsx(ye,{post:e},e.id))}):t.jsx(h,{className:"glass-effect",children:t.jsxs(p,{className:"p-12 text-center",children:[t.jsx(N,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4 opacity-50"}),t.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No posts found"}),t.jsx("p",{className:"text-muted-foreground",children:q||"all"!==L?"Try adjusting your filters":"No blog posts yet"})]})})]}),t.jsxs(X,{value:"analytics",className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsx(Ne,{icon:N,title:"Total Posts",value:he.totalPosts}),t.jsx(Ne,{icon:C,title:"Published",value:he.publishedPosts}),t.jsx(Ne,{icon:T,title:"Total Views",value:he.totalViews.toLocaleString()}),t.jsx(Ne,{icon:A,title:"Avg Views/Post",value:he.avgViewsPerPost})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsx(Ne,{icon:N,title:"Drafts",value:he.draftPosts}),t.jsx(Ne,{icon:E,title:"Scheduled",value:he.scheduledPosts}),t.jsx(Ne,{icon:S,title:"Total Comments",value:he.totalComments}),t.jsx(Ne,{icon:j,title:"Pending Comments",value:he.pendingComments})]}),t.jsxs(h,{children:[t.jsx(x,{children:t.jsx(u,{children:"Top Performing Posts"})}),t.jsx(p,{children:t.jsx("div",{className:"space-y-3",children:a.filter(e=>"published"===e.status).sort((e,s)=>(s.view_count||0)-(e.view_count||0)).slice(0,10).map((e,s)=>{var a;return t.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-primary/10 text-primary font-bold",children:s+1}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:e.title}),t.jsx("p",{className:"text-sm text-muted-foreground",children:null==(a=e.author)?void 0:a.full_name})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"font-bold",children:e.view_count||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"views"})]})]},e.id)})})})]})]}),t.jsx(X,{value:"categories",className:"space-y-4",children:t.jsxs(h,{children:[t.jsxs(x,{children:[t.jsx(u,{children:"Blog Categories"}),t.jsx(g,{children:"Manage content categories"})]}),t.jsx(p,{children:t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:F.map(e=>t.jsxs("div",{className:"p-4 bg-card border border-border rounded-lg",children:[t.jsx("h3",{className:"font-semibold mb-1",children:e.name}),t.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:e.description||"No description"}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("span",{className:"text-xs text-muted-foreground",children:[a.filter(s=>s.category===e.slug).length," posts"]}),t.jsx(d,{variant:"outline",children:e.slug})]})]},e.id))})})]})}),t.jsxs(X,{value:"comments",className:"space-y-4",children:[t.jsxs(h,{children:[t.jsxs(x,{children:[t.jsxs(u,{children:["Pending Comments (",de.length,")"]}),t.jsx(g,{children:"Review and moderate comments"})]}),t.jsx(p,{children:de.length>0?t.jsx("div",{className:"space-y-3",children:de.map(e=>{var s,a;return t.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:e.author_name||(null==(s=e.user)?void 0:s.full_name)}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:['on "',null==(a=e.blog_post)?void 0:a.title,'"']})]}),t.jsx("span",{className:"text-xs text-muted-foreground",children:I(new Date(e.created_at),"MMM d, yyyy")})]}),t.jsx("p",{className:"text-sm mb-3",children:e.content}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(n,{size:"sm",onClick:()=>(async e=>{try{const{error:s}=await r.from("blog_comments").update({is_approved:!0}).eq("id",e);if(s)throw s;c({title:"Comment approved"}),je(),ve()}catch(s){c({variant:"destructive",title:"Error",description:"Failed to approve comment"})}})(e.id),children:[t.jsx(D,{className:"w-4 h-4 mr-1"}),"Approve"]}),t.jsxs(n,{size:"sm",variant:"outline",onClick:()=>(async e=>{if(confirm("Delete this comment?"))try{const{error:s}=await r.from("blog_comments").delete().eq("id",e);if(s)throw s;c({title:"Comment deleted"}),je(),ve()}catch(s){c({variant:"destructive",title:"Error",description:"Failed to delete comment"})}})(e.id),children:[t.jsx(M,{className:"w-4 h-4 mr-1"}),"Delete"]})]})]},e.id)})}):t.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No pending comments"})})]}),t.jsxs(h,{children:[t.jsx(x,{children:t.jsx(u,{children:"Recent Comments"})}),t.jsx(p,{children:t.jsx("div",{className:"space-y-3",children:ce.filter(e=>e.is_approved).slice(0,10).map(e=>{var s,a;return t.jsxs("div",{className:"p-3 bg-muted/30 rounded-lg",children:[t.jsxs("div",{className:"flex items-start justify-between mb-1",children:[t.jsx("p",{className:"font-medium text-sm",children:e.author_name||(null==(s=e.user)?void 0:s.full_name)}),t.jsx("span",{className:"text-xs text-muted-foreground",children:I(new Date(e.created_at),"MMM d")})]}),t.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:['on "',null==(a=e.blog_post)?void 0:a.title,'"']}),t.jsx("p",{className:"text-sm",children:e.content})]},e.id)})})})]})]})]})]})})},de=({user:e})=>{const[s,a]=i.useState(""),[l,j]=i.useState(""),[v,f]=i.useState("general"),[w,y]=i.useState("guide"),[S,k]=i.useState("professional"),[C,_]=i.useState("2000"),[P,T]=i.useState(!1),[E,I]=i.useState(null),D=[{value:"guide",label:"Ultimate Guide",description:"Comprehensive how-to guides"},{value:"listicle",label:"Listicle",description:"Top 10, Best of lists"},{value:"comparison",label:"Comparison",description:"Product/method comparisons"},{value:"tutorial",label:"Tutorial",description:"Step-by-step instructions"},{value:"case-study",label:"Case Study",description:"Success stories & results"},{value:"faq",label:"FAQ",description:"Question & answer format"}],M=[{value:"general",label:"General Audience"},{value:"beginners",label:"Beginners"},{value:"fitness-enthusiasts",label:"Fitness Enthusiasts"},{value:"weight-loss",label:"Weight Loss Seekers"},{value:"muscle-building",label:"Muscle Builders"},{value:"busy-professionals",label:"Busy Professionals"}],$=[{value:"professional",label:"Professional"},{value:"friendly",label:"Friendly & Conversational"},{value:"motivational",label:"Motivational"},{value:"educational",label:"Educational"},{value:"casual",label:"Casual"}];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[t.jsx(F,{className:"w-6 h-6 text-primary"}),"AI Blog Content Generator"]}),t.jsx("p",{className:"text-text-secondary mt-1",children:"Generate SEO-optimized blog posts instantly with AI. Perfect for ranking on Google!"})]}),t.jsxs(h,{children:[t.jsxs(x,{children:[t.jsxs(u,{className:"flex items-center gap-2",children:[t.jsx(B,{className:"w-5 h-5 text-primary"}),"Content Specifications"]}),t.jsx(g,{children:"Provide details about the blog post you want to create"})]}),t.jsxs(p,{className:"space-y-4",children:[t.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(m,{htmlFor:"topic",children:"Blog Topic *"}),t.jsx(o,{id:"topic",placeholder:"e.g., How to Lose Weight with AI Health Coaching",value:s,onChange:e=>a(e.target.value),disabled:P})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(m,{htmlFor:"keywords",children:"Target Keywords (comma-separated)"}),t.jsx(o,{id:"keywords",placeholder:"e.g., ai health coach, weight loss, meal planning",value:l,onChange:e=>j(e.target.value),disabled:P})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(m,{htmlFor:"content-type",children:"Content Type"}),t.jsxs(ee,{value:w,onValueChange:y,disabled:P,children:[t.jsx(se,{children:t.jsx(te,{})}),t.jsx(ae,{children:D.map(e=>t.jsx(le,{value:e.value,children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:e.label}),t.jsx("div",{className:"text-xs text-muted-foreground",children:e.description})]})},e.value))})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(m,{htmlFor:"audience",children:"Target Audience"}),t.jsxs(ee,{value:v,onValueChange:f,disabled:P,children:[t.jsx(se,{children:t.jsx(te,{})}),t.jsx(ae,{children:M.map(e=>t.jsx(le,{value:e.value,children:e.label},e.value))})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(m,{htmlFor:"tone",children:"Writing Tone"}),t.jsxs(ee,{value:S,onValueChange:k,disabled:P,children:[t.jsx(se,{children:t.jsx(te,{})}),t.jsx(ae,{children:$.map(e=>t.jsx(le,{value:e.value,children:e.label},e.value))})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(m,{htmlFor:"word-count",children:"Target Word Count"}),t.jsxs(ee,{value:C,onValueChange:_,disabled:P,children:[t.jsx(se,{children:t.jsx(te,{})}),t.jsxs(ae,{children:[t.jsx(le,{value:"1000",children:"1,000 words (5 min read)"}),t.jsx(le,{value:"1500",children:"1,500 words (7 min read)"}),t.jsx(le,{value:"2000",children:"2,000 words (10 min read)"}),t.jsx(le,{value:"2500",children:"2,500 words (12 min read)"}),t.jsx(le,{value:"3000",children:"3,000 words (15 min read)"})]})]})]})]}),t.jsx(n,{onClick:async()=>{var e,t,a,i;if(s.trim()){T(!0);try{const o=`You are an expert SEO content writer specializing in health, wellness, nutrition, and fitness.\n\nCreate a comprehensive, SEO-optimized blog post with the following specifications:\n\n**Topic**: ${s}\n**Target Keywords**: ${l||"Derive from topic"}\n**Target Audience**: ${null==(e=M.find(e=>e.value===v))?void 0:e.label}\n**Content Type**: ${null==(t=D.find(e=>e.value===w))?void 0:t.label}\n**Tone**: ${null==(a=$.find(e=>e.value===S))?void 0:a.label}\n**Target Word Count**: ${C} words\n\n**Requirements**:\n1. Create a compelling, click-worthy headline (50-60 characters)\n2. Write an engaging meta description (150-160 characters)\n3. Start with a hook that grabs attention\n4. Use H2 and H3 headers for structure (include keywords naturally)\n5. Include actionable tips and practical advice\n6. Add internal linking suggestions (to other relevant topics)\n7. Include a call-to-action at the end\n8. Naturally integrate the target keywords throughout\n9. Write in ${null==(i=$.find(e=>e.value===S))?void 0:i.label.toLowerCase()} tone\n10. Make it valuable, informative, and engaging\n\n**Format the response as JSON**:\n{\n  "title": "SEO-optimized blog title",\n  "slug": "url-friendly-slug",\n  "metaDescription": "Compelling meta description",\n  "content": "Full blog post content in markdown format",\n  "excerpt": "2-3 sentence excerpt for previews",\n  "keywords": ["keyword1", "keyword2", "keyword3"],\n  "readingTime": "estimated reading time in minutes",\n  "seoScore": "estimated SEO score out of 100"\n}\n\nGenerate the blog post now.`,{data:d,error:m}=await r.functions.invoke("openai-chat",{body:{messages:[{role:"system",content:"You are an expert SEO content writer. Always respond with valid JSON as specified."},{role:"user",content:o}],model:"gpt-4",temperature:.7,max_tokens:4e3}});if(m)throw m;let h;try{const e=d.response.match(/\{[\s\S]*\}/);h=e?JSON.parse(e[0]):{title:s,slug:s.toLowerCase().replace(/[^a-z0-9]+/g,"-"),metaDescription:`Discover everything you need to know about ${s}`,content:d.response,excerpt:d.response.substring(0,200)+"...",keywords:l.split(",").map(e=>e.trim()).filter(Boolean),readingTime:Math.ceil(d.response.split(" ").length/200),seoScore:75}}catch(n){throw new Error("Failed to parse AI response")}I(h),c({title:"Blog Post Generated! ✨",description:`Created a ${h.readingTime}-minute read with SEO score: ${h.seoScore}/100`})}catch(o){c({title:"Generation Failed",description:o.message||"Failed to generate blog post. Please try again.",variant:"destructive"})}finally{T(!1)}}else c({title:"Topic Required",description:"Please enter a blog topic",variant:"destructive"})},disabled:P,className:"w-full gap-2",size:"lg",children:P?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Generating with AI..."]}):t.jsxs(t.Fragment,{children:[t.jsx(F,{className:"w-5 h-5"}),"Generate Blog Post"]})})]})]}),E&&t.jsxs(h,{children:[t.jsx(x,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsxs(u,{className:"flex items-center gap-2",children:[t.jsx(N,{className:"w-5 h-5 text-primary"}),"Generated Content"]}),t.jsx(g,{className:"mt-2",children:t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsxs(d,{variant:"outline",className:"gap-1",children:[t.jsx(b,{className:"w-3 h-3"}),"SEO Score: ",E.seoScore,"/100"]}),t.jsxs(d,{variant:"outline",className:"gap-1",children:[t.jsx(A,{className:"w-3 h-3"}),E.readingTime," min read"]}),E.keywords.map(e=>t.jsx(d,{variant:"secondary",children:e},e))]})})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(n,{size:"sm",variant:"outline",onClick:()=>{return e=E.content,navigator.clipboard.writeText(e),void c({title:"Copied!",description:"Content copied to clipboard"});var e},children:[t.jsx(z,{className:"w-4 h-4 mr-2"}),"Copy"]}),t.jsxs(n,{size:"sm",variant:"outline",onClick:()=>{if(!E)return;const e=`---\ntitle: ${E.title}\nslug: ${E.slug}\nmetaDescription: ${E.metaDescription}\nkeywords: ${E.keywords.join(", ")}\nreadingTime: ${E.readingTime} min\n---\n\n# ${E.title}\n\n${E.content}\n`,s=new Blob([e],{type:"text/markdown"}),t=URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download=`${E.slug}.md`,a.click(),URL.revokeObjectURL(t),c({title:"Downloaded",description:"Blog post downloaded as markdown file"})},children:[t.jsx(G,{className:"w-4 h-4 mr-2"}),"Download"]}),t.jsxs(n,{size:"sm",onClick:async()=>{if(E)try{const{error:s}=await r.from("blog_posts").insert({title:E.title,slug:E.slug,content:E.content,excerpt:E.excerpt,meta_description:E.metaDescription,author_id:e.id,published:!1,created_at:(new Date).toISOString()});if(s)throw s;c({title:"Saved to Drafts",description:"Blog post has been saved. Edit and publish from the Blog Manager."})}catch(s){c({title:"Save Failed",description:s.message,variant:"destructive"})}},children:[t.jsx(q,{className:"w-4 h-4 mr-2"}),"Save to Drafts"]})]})]})}),t.jsxs(p,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(m,{className:"text-xs text-text-secondary",children:"TITLE"}),t.jsx("h3",{className:"text-2xl font-bold mt-1",children:E.title})]}),t.jsxs("div",{children:[t.jsx(m,{className:"text-xs text-text-secondary",children:"META DESCRIPTION"}),t.jsx("p",{className:"text-sm text-text-secondary mt-1",children:E.metaDescription})]}),t.jsxs("div",{children:[t.jsx(m,{className:"text-xs text-text-secondary",children:"EXCERPT"}),t.jsx("p",{className:"text-sm mt-1",children:E.excerpt})]}),t.jsxs("div",{children:[t.jsx(m,{className:"text-xs text-text-secondary",children:"CONTENT PREVIEW"}),t.jsx("div",{className:"mt-2 p-4 bg-muted rounded-lg max-h-96 overflow-y-auto",children:t.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:E.content.split("\n").map((e,s)=>t.jsx("p",{className:"mb-2",children:e},s))})})]})]})]}),t.jsxs(h,{className:"border-primary/30 bg-primary/5",children:[t.jsx(x,{children:t.jsx(u,{className:"text-lg",children:"SEO Tips for Maximum Impact"})}),t.jsx(p,{children:t.jsxs("ul",{className:"space-y-2 text-sm",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-primary mt-1",children:"•"}),t.jsx("span",{children:"Use the target keyword in the title, first paragraph, and headers"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-primary mt-1",children:"•"}),t.jsx("span",{children:"Add internal links to other relevant blog posts and pages"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-primary mt-1",children:"•"}),t.jsx("span",{children:"Include images with alt text containing your keywords"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-primary mt-1",children:"•"}),t.jsx("span",{children:"Publish consistently (3-5 posts per week) for best results"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-primary mt-1",children:"•"}),t.jsx("span",{children:"Share on social media and encourage engagement"})]})]})})]})]})},me=({user:e})=>{const[s,a]=i.useState(!1),[l,j]=i.useState(3),[f,N]=i.useState("09:00"),[y,b]=i.useState(!1),[S,k]=i.useState([]),[C,_]=i.useState([]),[T,A]=i.useState(!1),[I,D]=i.useState(""),[M,$]=i.useState(""),[O,B]=i.useState(null);i.useEffect(()=>{z(),G(),q()},[]);const z=async()=>{try{const{data:e,error:s}=await r.from("platform_settings").select("*").eq("key","auto_blog_scheduler").single();if(s&&"PGRST116"!==s.code)throw s;if(null==e?void 0:e.value){const s=e.value;a(s.enabled||!1),j(s.postsPerWeek||3),N(s.publishTime||"09:00"),b(s.autoPublish||!1),B(s)}}catch(e){}},G=async()=>{try{const{data:e,error:s}=await r.from("blog_content_queue").select("*").eq("status","pending").order("created_at",{ascending:!0});if(s&&"PGRST116"!==s.code)return;k(e||[])}catch(e){}},q=async()=>{try{const{data:s,error:t}=await r.from("blog_posts").select("*").eq("author_id",e.id).order("created_at",{ascending:!1}).limit(10);if(t)throw t;_(s||[])}catch(s){}},H=()=>{const e=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],s=parseInt(l);if(0===s)return[];const t=Math.floor(7/s),a=[];for(let l=0;l<s;l++)a.push(e[l*t]);return a};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[t.jsx(R,{className:"w-6 h-6 text-primary"}),"Automated Blog Scheduler"]}),t.jsx("p",{className:"text-text-secondary mt-1",children:"Set it and forget it! Automatically generate and publish blog posts to rank on Google."})]}),t.jsxs(Q,{defaultValue:"settings",className:"w-full",children:[t.jsxs(K,{className:"grid w-full grid-cols-3",children:[t.jsxs(Y,{value:"settings",children:[t.jsx(L,{className:"w-4 h-4 mr-2"}),"Settings"]}),t.jsxs(Y,{value:"queue",children:[t.jsx(E,{className:"w-4 h-4 mr-2"}),"Content Queue (",S.length,")"]}),t.jsxs(Y,{value:"history",children:[t.jsx(W,{className:"w-4 h-4 mr-2"}),"Generated (",C.length,")"]})]}),t.jsxs(X,{value:"settings",className:"space-y-6",children:[t.jsxs(h,{children:[t.jsxs(x,{children:[t.jsx(u,{children:"Automation Settings"}),t.jsx(g,{children:"Configure how often and when blog posts should be generated"})]}),t.jsxs(p,{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(m,{className:"text-base font-semibold",children:"Enable Auto-Blogging"}),t.jsx("p",{className:"text-sm text-text-secondary",children:"Automatically generate and publish blog posts"})]}),t.jsx(ie,{checked:s,onCheckedChange:a})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(m,{children:"Posts Per Week"}),t.jsxs(ee,{value:l.toString(),onValueChange:j,children:[t.jsx(se,{children:t.jsx(te,{})}),t.jsxs(ae,{children:[t.jsx(le,{value:"1",children:"1 post per week"}),t.jsx(le,{value:"2",children:"2 posts per week"}),t.jsx(le,{value:"3",children:"3 posts per week (Recommended)"}),t.jsx(le,{value:"4",children:"4 posts per week"}),t.jsx(le,{value:"5",children:"5 posts per week"}),t.jsx(le,{value:"7",children:"Daily (7 posts per week)"})]})]}),t.jsxs("p",{className:"text-xs text-text-secondary",children:["Schedule: ",H().join(", ")," at ",f]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(m,{children:"Publish Time (24-hour format)"}),t.jsx(o,{type:"time",value:f,onChange:e=>N(e.target.value)}),t.jsx("p",{className:"text-xs text-text-secondary",children:"Best times for engagement: 9:00 AM or 2:00 PM"})]}),t.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(m,{className:"text-base font-semibold",children:"Auto-Publish"}),t.jsx("p",{className:"text-sm text-text-secondary",children:"Publish immediately without review (or save as draft)"})]}),t.jsx(ie,{checked:y,onCheckedChange:b})]}),t.jsx(n,{onClick:async()=>{try{const e={enabled:s,postsPerWeek:parseInt(l),publishTime:f,autoPublish:y,lastRun:(null==O?void 0:O.lastRun)||null,totalGenerated:(null==O?void 0:O.totalGenerated)||0,updatedAt:(new Date).toISOString()},{error:t}=await r.from("platform_settings").upsert({key:"auto_blog_scheduler",value:e,updated_at:(new Date).toISOString()},{onConflict:"key"});if(t)throw t;B(e),c({title:"Scheduler Updated",description:"Auto-blogging is now "+(s?"enabled":"disabled")})}catch(e){c({title:"Error",description:e.message,variant:"destructive"})}},className:"w-full",size:"lg",children:"Save Settings"})]})]}),t.jsxs(h,{className:"border-primary/30 bg-primary/5",children:[t.jsx(x,{children:t.jsx(u,{className:"text-lg",children:"Publishing Schedule Preview"})}),t.jsx(p,{children:t.jsx("div",{className:"space-y-2",children:s?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-2 text-green-500",children:[t.jsx(V,{className:"w-5 h-5"}),t.jsx("span",{className:"font-semibold",children:"Scheduler is ACTIVE"})]}),t.jsxs("p",{className:"text-sm",children:[l," blog post",l>1?"s":""," will be generated every week"]}),t.jsxs("p",{className:"text-sm",children:["Publishing on: ",H().join(", ")]}),t.jsxs("p",{className:"text-sm",children:["Time: ",f]}),t.jsxs("p",{className:"text-sm",children:["Mode: ",y?"Auto-publish immediately":"Save as draft for review"]})]}):t.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[t.jsx(U,{className:"w-5 h-5"}),t.jsx("span",{children:"Scheduler is currently disabled"})]})})})]})]}),t.jsxs(X,{value:"queue",className:"space-y-4",children:[t.jsxs(h,{children:[t.jsxs(x,{children:[t.jsx(u,{children:"Add Topics to Queue"}),t.jsx(g,{children:"Add blog topics that will be generated automatically"})]}),t.jsxs(p,{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(m,{children:"Blog Topic"}),t.jsx(o,{placeholder:"e.g., How to Lose Weight with AI Health Coaching",value:I,onChange:e=>D(e.target.value)})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(m,{children:"Target Keywords (comma-separated)"}),t.jsx(o,{placeholder:"e.g., ai health coach, weight loss, meal planning",value:M,onChange:e=>$(e.target.value)})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(n,{onClick:async()=>{if(I.trim())try{const{error:e}=await r.from("blog_content_queue").select("id").limit(1);if(e&&"42P01"===e.code)return void c({title:"Setting up Blog Queue",description:"Creating content queue table... Please run the migration first.",variant:"destructive"});const{error:s}=await r.from("blog_content_queue").insert({topic:I,keywords:M,status:"pending",created_at:(new Date).toISOString()});if(s)throw s;D(""),$(""),G(),c({title:"Topic Added",description:"Topic added to content queue"})}catch(e){c({title:"Error",description:e.message,variant:"destructive"})}else c({title:"Topic Required",description:"Please enter a blog topic",variant:"destructive"})},className:"flex-1",children:[t.jsx(w,{className:"w-4 h-4 mr-2"}),"Add to Queue"]}),t.jsxs(n,{onClick:async()=>{const e=[{topic:"The Ultimate Guide to AI Health Coaching",keywords:"ai health coach, ai coaching app, personalized health"},{topic:"How to Lose Weight with Personalized Meal Plans",keywords:"weight loss, meal planning, personalized nutrition"},{topic:"Complete Guide to Tracking Macros for Beginners",keywords:"macro tracking, macronutrients, calorie counting"},{topic:"Best Foods for Muscle Building and Recovery",keywords:"muscle building, protein foods, recovery nutrition"},{topic:"30-Day Fitness Challenge with AI Coaching",keywords:"fitness challenge, 30 day workout, ai fitness"},{topic:"Intermittent Fasting: A Complete Guide",keywords:"intermittent fasting, fasting benefits, weight loss"},{topic:"Sleep and Weight Loss: The Surprising Connection",keywords:"sleep quality, weight loss, health habits"},{topic:"How to Stay Motivated on Your Health Journey",keywords:"motivation, health goals, consistency"},{topic:"Understanding BMI and Body Composition",keywords:"bmi calculator, body composition, health metrics"},{topic:"Meal Prep for Busy Professionals",keywords:"meal prep, healthy eating, time management"}];try{for(const s of e)await r.from("blog_content_queue").insert({topic:s.topic,keywords:s.keywords,status:"pending",created_at:(new Date).toISOString()});G(),c({title:"Topics Added",description:`${e.length} topics added to queue`})}catch(s){c({title:"Error",description:s.message,variant:"destructive"})}},variant:"outline",children:[t.jsx(F,{className:"w-4 h-4 mr-2"}),"Add 10 Topics"]})]})]})]}),t.jsxs(h,{children:[t.jsx(x,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(u,{children:["Content Queue (",S.length," topics)"]}),t.jsx(n,{size:"sm",variant:"outline",onClick:async()=>{if(0!==S.length){A(!0);try{const t=S[0],a=`You are an expert SEO content writer specializing in health, wellness, nutrition, and fitness.\n\nCreate a comprehensive, SEO-optimized blog post with the following specifications:\n\n**Topic**: ${t.topic}\n**Target Keywords**: ${t.keywords}\n**Target Audience**: Health-conscious individuals seeking AI-powered wellness solutions\n**Content Type**: Ultimate Guide\n**Tone**: Professional yet friendly\n**Target Word Count**: 2000 words\n\n**Requirements**:\n1. Create a compelling, click-worthy headline (50-60 characters)\n2. Write an engaging meta description (150-160 characters)\n3. Start with a hook that grabs attention\n4. Use H2 and H3 headers for structure (include keywords naturally)\n5. Include actionable tips and practical advice\n6. Add internal linking suggestions (to other relevant topics)\n7. Include a call-to-action at the end\n8. Naturally integrate the target keywords throughout\n9. Make it valuable, informative, and engaging\n\n**Format the response as JSON**:\n{\n  "title": "SEO-optimized blog title",\n  "slug": "url-friendly-slug",\n  "metaDescription": "Compelling meta description",\n  "content": "Full blog post content in markdown format",\n  "excerpt": "2-3 sentence excerpt for previews",\n  "keywords": ["keyword1", "keyword2", "keyword3"],\n  "readingTime": "estimated reading time in minutes",\n  "seoScore": "estimated SEO score out of 100"\n}\n\nGenerate the blog post now. Return ONLY the JSON object, no other text.`,l=await fetch("/api-generate-blog.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:a})});if(!l.ok)throw new Error(`Gemini API error: ${l.status}`);const i=await l.json();if(!i.candidates||!i.candidates[0])throw new Error("No content generated from Gemini");const n=i.candidates[0].content.parts[0].text;let o;try{const e=n.match(/```json\n([\s\S]*?)\n```/)||n.match(/\{[\s\S]*\}/);o=e?JSON.parse(e[1]||e[0]):{title:t.topic,slug:t.topic.toLowerCase().replace(/[^a-z0-9]+/g,"-"),metaDescription:`Discover everything you need to know about ${t.topic}`,content:n,excerpt:n.substring(0,200)+"...",keywords:t.keywords.split(",").map(e=>e.trim()),readingTime:Math.ceil(n.split(" ").length/200),seoScore:75}}catch(s){throw new Error("Failed to parse AI response")}const{error:d}=await r.from("blog_posts").insert({title:o.title,slug:o.slug,content:o.content,excerpt:o.excerpt,meta_description:o.metaDescription,author_id:e.id,status:y?"published":"draft",created_at:(new Date).toISOString(),published_at:y?(new Date).toISOString():null});if(d)throw d;await r.from("blog_content_queue").update({status:"generated",generated_at:(new Date).toISOString()}).eq("id",t.id),G(),q(),c({title:"Blog Post Generated!",description:`"${o.title}" has been ${y?"published":"saved as draft"}`})}catch(t){c({title:"Generation Failed",description:t.message,variant:"destructive"})}finally{A(!1)}}else c({title:"Queue Empty",description:"Add topics to the queue first",variant:"destructive"})},disabled:T,children:T?t.jsxs(t.Fragment,{children:[t.jsx(v,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating..."]}):t.jsxs(t.Fragment,{children:[t.jsx(R,{className:"w-4 h-4 mr-2"}),"Generate Next"]})})]})}),t.jsx(p,{children:0===S.length?t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(E,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{children:"No topics in queue"}),t.jsx("p",{className:"text-sm mt-1",children:"Add topics to start auto-generating content"})]}):t.jsx("div",{className:"space-y-3",children:S.map((e,s)=>t.jsxs("div",{className:"flex items-start gap-3 p-4 border rounded-lg hover:bg-muted/30",children:[t.jsxs(d,{variant:"outline",className:"mt-1",children:["#",s+1]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"font-medium",children:e.topic}),t.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Keywords: ",e.keywords]})]}),t.jsx(n,{size:"sm",variant:"ghost",onClick:()=>(async e=>{try{const{error:s}=await r.from("blog_content_queue").delete().eq("id",e);if(s)throw s;G(),c({title:"Removed",description:"Topic removed from queue"})}catch(s){c({title:"Error",description:s.message,variant:"destructive"})}})(e.id),children:t.jsx(P,{className:"w-4 h-4"})})]},e.id))})})]})]}),t.jsx(X,{value:"history",className:"space-y-4",children:t.jsxs(h,{children:[t.jsxs(x,{children:[t.jsx(u,{children:"Recently Generated Posts"}),t.jsx(g,{children:"Last 10 blog posts generated by the auto-blogger"})]}),t.jsx(p,{children:0===C.length?t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(W,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{children:"No posts generated yet"})]}):t.jsx("div",{className:"space-y-3",children:C.map(e=>t.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/30",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"font-medium",children:e.title}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:new Date(e.created_at).toLocaleString()})]}),t.jsx(d,{variant:e.published?"default":"secondary",children:e.published?"Published":"Draft"})]})},e.id))})})]})})]})]})},he=({user:e})=>{const[s,a]=i.useState("posts");return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Blog Management"}),t.jsx("p",{className:"text-text-secondary mt-1",children:"Manage blog posts, generate AI content, and automate publishing"})]}),t.jsxs(Q,{value:s,onValueChange:a,className:"w-full",children:[t.jsxs(K,{className:"grid w-full grid-cols-5 mb-6",children:[t.jsxs(Y,{value:"posts",className:"flex items-center gap-2",children:[t.jsx(N,{className:"w-4 h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Blog Posts"})]}),t.jsxs(Y,{value:"ai-writer",className:"flex items-center gap-2",children:[t.jsx(F,{className:"w-4 h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"AI Writer"})]}),t.jsxs(Y,{value:"ai-assistant",className:"flex items-center gap-2",children:[t.jsx(H,{className:"w-4 h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"AI Assistant"})]}),t.jsxs(Y,{value:"auto-scheduler",className:"flex items-center gap-2",children:[t.jsx(E,{className:"w-4 h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Scheduler"})]}),t.jsxs(Y,{value:"tags",className:"flex items-center gap-2",children:[t.jsx(J,{className:"w-4 h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Tags"})]})]}),t.jsx(X,{value:"posts",className:"mt-0",children:t.jsx(oe,{user:e})}),t.jsx(X,{value:"ai-writer",className:"mt-0",children:t.jsx(de,{user:e})}),t.jsx(X,{value:"ai-assistant",className:"mt-0",children:t.jsx(ne,{})}),t.jsx(X,{value:"auto-scheduler",className:"mt-0",children:t.jsx(me,{user:e})}),t.jsx(X,{value:"tags",className:"mt-0",children:t.jsx(re,{})})]})]})};export{he as B,ce as E};
