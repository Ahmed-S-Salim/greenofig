import{j as e}from"./vendor-ui-gkPPHEPH.js";import{a as t}from"./vendor-react-Dds8VpLH.js";import{u as s,s as a}from"./index-CKU5P2TY.js";import{Q as i}from"./QuickLogMeal-xtw0w_X_.js";import{m as l,g as r,r as d}from"./vendor-utils-CisQTPNT.js";import"./dialog-D_VtZS95.js";import"./input-EoRmzMlo.js";import"./label-qLSsZ5R6.js";import"./select-BoESt1cj.js";import"./vendor-editor-DGqHsWbs.js";const NutritionPageFunctional=()=>{const{userProfile:o}=s(),[n,c]=t.useState([]),[m,x]=t.useState(null),[u,h]=t.useState(!0),[f,g]=t.useState(0);t.useEffect(()=>{(null==o?void 0:o.id)&&fetchNutritionData()},[null==o?void 0:o.id,f]);const fetchNutritionData=()=>{return e=null,t=null,s=function*(){h(!0);try{const e=(new Date).toISOString().split("T")[0],{data:t}=yield a.from("meal_logs").select("*").eq("user_id",o.id).eq("date",e).order("consumed_at",{ascending:!1});c(t||[]);const{data:s}=yield a.from("daily_metrics").select("*").eq("user_id",o.id).eq("date",e).single();x(s)}catch(e){console.error("Error fetching nutrition data:",e)}finally{h(!1)}},new Promise((a,i)=>{var fulfilled=e=>{try{step(s.next(e))}catch(t){i(t)}},rejected=e=>{try{step(s.throw(e))}catch(t){i(t)}},step=e=>e.done?a(e.value):Promise.resolve(e.value).then(fulfilled,rejected);step((s=s.apply(e,t)).next())});var e,t,s},p=n.reduce((e,t)=>({calories:e.calories+(t.calories||0),protein:e.protein+(t.protein_g||0),carbs:e.carbs+(t.carbs_g||0),fats:e.fats+(t.fats_g||0)}),{calories:0,protein:0,carbs:0,fats:0}),j={calories:(null==o?void 0:o.target_calories)||2200,protein:(null==o?void 0:o.target_protein)||150,carbs:(null==o?void 0:o.target_carbs)||220,fats:(null==o?void 0:o.target_fats)||70},calculateProgress=(e,t)=>Math.min(e/t*100,100);return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs(l.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Nutrition Tracker"}),e.jsx("p",{className:"text-text-secondary text-lg",children:"Track your meals and macros"})]}),e.jsx(i,{onSuccess:()=>{g(e=>e+1)}})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-effect rounded-xl p-6 shadow-xl",children:[e.jsx("h3",{className:"text-sm text-muted-foreground mb-2",children:"Calories"}),e.jsx("p",{className:"text-3xl font-bold mb-1",children:Math.round(p.calories)}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["of ",j.calories," kcal"]}),e.jsx("div",{className:"mt-4 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx(l.div,{initial:{width:0},animate:{width:`${calculateProgress(p.calories,j.calories)}%`},transition:{duration:1},className:"h-full bg-gradient-to-r from-orange-500 to-red-500"})})]}),e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"glass-effect rounded-xl p-6 shadow-xl",children:[e.jsx("h3",{className:"text-sm text-muted-foreground mb-2",children:"Protein"}),e.jsxs("p",{className:"text-3xl font-bold mb-1",children:[Math.round(p.protein),"g"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["of ",j.protein,"g"]}),e.jsx("div",{className:"mt-4 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx(l.div,{initial:{width:0},animate:{width:`${calculateProgress(p.protein,j.protein)}%`},transition:{duration:1,delay:.2},className:"h-full bg-gradient-to-r from-pink-500 to-rose-500"})})]}),e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"glass-effect rounded-xl p-6 shadow-xl",children:[e.jsx("h3",{className:"text-sm text-muted-foreground mb-2",children:"Carbs"}),e.jsxs("p",{className:"text-3xl font-bold mb-1",children:[Math.round(p.carbs),"g"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["of ",j.carbs,"g"]}),e.jsx("div",{className:"mt-4 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx(l.div,{initial:{width:0},animate:{width:`${calculateProgress(p.carbs,j.carbs)}%`},transition:{duration:1,delay:.3},className:"h-full bg-gradient-to-r from-blue-500 to-cyan-500"})})]}),e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"glass-effect rounded-xl p-6 shadow-xl",children:[e.jsx("h3",{className:"text-sm text-muted-foreground mb-2",children:"Fats"}),e.jsxs("p",{className:"text-3xl font-bold mb-1",children:[Math.round(p.fats),"g"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["of ",j.fats,"g"]}),e.jsx("div",{className:"mt-4 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx(l.div,{initial:{width:0},animate:{width:`${calculateProgress(p.fats,j.fats)}%`},transition:{duration:1,delay:.4},className:"h-full bg-gradient-to-r from-yellow-500 to-amber-500"})})]})]}),e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"glass-effect rounded-xl p-6 shadow-xl",children:[e.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2",children:[e.jsx(r,{className:"w-6 h-6 text-primary"}),"Today's Meals"]}),u?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:e.jsx("div",{className:"animate-pulse",children:"Loading meals..."})}):0===n.length?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(d,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg",children:"No meals logged today"}),e.jsx("p",{className:"text-sm mt-2",children:'Click "Log Meal" above to add your first meal'})]}):e.jsx("div",{className:"space-y-4",children:n.map((t,s)=>e.jsxs(l.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.6+.1*s},className:"p-4 bg-muted rounded-lg hover:bg-muted/80 transition-all",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:t.meal_name||"Meal"}),e.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:t.meal_type}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t.description})]}),e.jsxs("span",{className:"px-3 py-1 bg-orange-500/20 text-orange-600 dark:text-orange-300 rounded-full text-sm font-semibold",children:[t.calories||0," kcal"]})]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Protein: ",e.jsxs("span",{className:"text-foreground font-semibold",children:[t.protein_g||0,"g"]})]}),e.jsxs("span",{className:"text-muted-foreground",children:["Carbs: ",e.jsxs("span",{className:"text-foreground font-semibold",children:[t.carbs_g||0,"g"]})]}),e.jsxs("span",{className:"text-muted-foreground",children:["Fats: ",e.jsxs("span",{className:"text-foreground font-semibold",children:[t.fats_g||0,"g"]})]})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-2",children:new Date(t.consumed_at).toLocaleTimeString()})]},t.id))})]})]})};export{NutritionPageFunctional as default};
