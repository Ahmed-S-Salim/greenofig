var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,__defNormalProp=(s,t,a)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,__spreadValues=(e,s)=>{for(var t in s||(s={}))i.call(s,t)&&__defNormalProp(e,t,s[t]);if(a)for(var t of a(s))r.call(s,t)&&__defNormalProp(e,t,s[t]);return e},__spreadProps=(e,a)=>s(e,t(a)),__async=(e,s,t)=>new Promise((a,i)=>{var fulfilled=e=>{try{step(t.next(e))}catch(s){i(s)}},rejected=e=>{try{step(t.throw(e))}catch(s){i(s)}},step=e=>e.done?a(e.value):Promise.resolve(e.value).then(fulfilled,rejected);step((t=t.apply(e,s)).next())});import{j as l}from"./vendor-ui-gkPPHEPH.js";import{a as n}from"./vendor-react-Dds8VpLH.js";import{u as d,B as o,s as c,t as u,T as m,H as h}from"./index-CKU5P2TY.js";import{C as x,a as g,b as p,c as j}from"./card-Pj_OUEuM.js";import{D as f,a as v,b as y,c as _,d as w}from"./dialog-D_VtZS95.js";import{I as b}from"./input-EoRmzMlo.js";import{L as N}from"./label-qLSsZ5R6.js";import{x as k,D as S,aF as C,aG as F,ab as P,aH as q,G as D,aI as I,u as M,aJ as L,r as T,Z as $,J as A,aK as W,a8 as O,aL as E,m as G,v as B,aM as Y,aN as H,s as z,T as R,P as V}from"./vendor-utils-CisQTPNT.js";import{Q as U}from"./QuickLogMeal-xtw0w_X_.js";import{S as K,a as Q,b as J,c as Z,d as X}from"./select-BoESt1cj.js";import{T as ee,a as se,b as te,c as ae}from"./tabs-rmIyZk1l.js";import"./vendor-editor-DGqHsWbs.js";const QuickLogWeight=({onSuccess:e})=>{const{userProfile:s}=d(),[t,a]=n.useState(!1),[i,r]=n.useState(!1),[m,h]=n.useState({weight_kg:(null==s?void 0:s.weight_kg)||"",body_fat_percentage:"",date:(new Date).toISOString().split("T")[0]});return l.jsxs(f,{open:t,onOpenChange:a,children:[l.jsx(v,{asChild:!0,children:l.jsxs(o,{className:"w-full",children:[l.jsx(k,{className:"w-4 h-4 mr-2"}),"Log Weight"]})}),l.jsxs(y,{children:[l.jsx(_,{children:l.jsx(w,{children:"Log Your Weight"})}),l.jsxs("form",{onSubmit:t=>__async(null,null,function*(){t.preventDefault(),r(!0);try{const t=m.date,{data:i}=yield c.from("daily_metrics").select("*").eq("user_id",s.id).eq("date",t).single();if(i){const{error:e}=yield c.from("daily_metrics").update({weight_kg:parseFloat(m.weight_kg),body_fat_percentage:m.body_fat_percentage?parseFloat(m.body_fat_percentage):null}).eq("id",i.id);if(e)throw e}else{const{error:e}=yield c.from("daily_metrics").insert({user_id:s.id,date:t,weight_kg:parseFloat(m.weight_kg),body_fat_percentage:m.body_fat_percentage?parseFloat(m.body_fat_percentage):null});if(e)throw e}yield c.from("user_profiles").update({weight_kg:parseFloat(m.weight_kg)}).eq("id",s.id),yield c.from("activity_feed").insert({user_id:s.id,activity_type:"weight_update",activity_title:"Weight Updated",activity_description:`Logged weight: ${m.weight_kg} kg`,metadata:{weight_kg:parseFloat(m.weight_kg)}}),yield c.rpc("update_user_streak",{p_user_id:s.id,p_streak_type:"weight_log",p_activity_date:t}),u({title:"Weight Logged!",description:`Successfully logged ${m.weight_kg} kg`}),a(!1),e&&e()}catch(i){console.error("Error logging weight:",i),u({title:"Error",description:"Failed to log weight. Please try again.",variant:"destructive"})}finally{r(!1)}}),className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(N,{htmlFor:"date",children:"Date"}),l.jsx(b,{id:"date",type:"date",value:m.date,onChange:e=>h(__spreadProps(__spreadValues({},m),{date:e.target.value})),max:(new Date).toISOString().split("T")[0],required:!0})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"weight",children:"Weight (kg) *"}),l.jsx(b,{id:"weight",type:"number",step:"0.1",placeholder:"70.5",value:m.weight_kg,onChange:e=>h(__spreadProps(__spreadValues({},m),{weight_kg:e.target.value})),required:!0})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"body_fat",children:"Body Fat % (optional)"}),l.jsx(b,{id:"body_fat",type:"number",step:"0.1",placeholder:"18.5",value:m.body_fat_percentage,onChange:e=>h(__spreadProps(__spreadValues({},m),{body_fat_percentage:e.target.value}))})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(o,{type:"button",variant:"outline",onClick:()=>a(!1),className:"flex-1",children:"Cancel"}),l.jsx(o,{type:"submit",disabled:i,className:"flex-1",children:i?"Logging...":"Log Weight"})]})]})]})]})},QuickLogWorkout=({onSuccess:e})=>{const{userProfile:s}=d(),[t,a]=n.useState(!1),[i,r]=n.useState(!1),[h,x]=n.useState({workout_name:"",workout_type:"cardio",duration_minutes:"",calories_burned:"",intensity:"moderate",notes:"",feeling:"good",date:(new Date).toISOString().split("T")[0]});return l.jsxs(f,{open:t,onOpenChange:a,children:[l.jsx(v,{asChild:!0,children:l.jsxs(o,{className:"w-full",children:[l.jsx(S,{className:"w-10 h-10 mr-2",strokeWidth:3}),"Log Workout"]})}),l.jsxs(y,{className:"max-h-[90vh] overflow-y-auto",children:[l.jsx(_,{children:l.jsx(w,{children:"Log Your Workout"})}),l.jsxs("form",{onSubmit:t=>__async(null,null,function*(){t.preventDefault(),r(!0);try{const t={user_id:s.id,workout_name:h.workout_name,workout_type:h.workout_type,duration_minutes:parseInt(h.duration_minutes),calories_burned:h.calories_burned?parseInt(h.calories_burned):null,intensity:h.intensity,notes:h.notes,feeling:h.feeling,date:h.date},{error:i}=yield c.from("workout_logs").insert(t);if(i)throw i;const{data:r}=yield c.from("daily_metrics").select("*").eq("user_id",s.id).eq("date",h.date).single(),l=((null==r?void 0:r.calories_burned)||0)+(h.calories_burned?parseInt(h.calories_burned):0),n=((null==r?void 0:r.active_minutes)||0)+parseInt(h.duration_minutes);r?yield c.from("daily_metrics").update({calories_burned:l,active_minutes:n}).eq("id",r.id):yield c.from("daily_metrics").insert({user_id:s.id,date:h.date,calories_burned:l,active_minutes:n}),yield c.from("activity_feed").insert({user_id:s.id,activity_type:"completed_workout",activity_title:"Completed Workout",activity_description:h.workout_name,metadata:{duration:parseInt(h.duration_minutes),calories:h.calories_burned?parseInt(h.calories_burned):0}}),yield c.rpc("update_user_streak",{p_user_id:s.id,p_streak_type:"workout",p_activity_date:h.date}),u({title:"Workout Logged!",description:`Great job completing ${h.workout_name}!`}),x({workout_name:"",workout_type:"cardio",duration_minutes:"",calories_burned:"",intensity:"moderate",notes:"",feeling:"good",date:(new Date).toISOString().split("T")[0]}),a(!1),e&&e()}catch(i){console.error("Error logging workout:",i),u({title:"Error",description:"Failed to log workout. Please try again.",variant:"destructive"})}finally{r(!1)}}),className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(N,{htmlFor:"date",children:"Date"}),l.jsx(b,{id:"date",type:"date",value:h.date,onChange:e=>x(__spreadProps(__spreadValues({},h),{date:e.target.value})),max:(new Date).toISOString().split("T")[0],required:!0})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"workout_name",children:"Workout Name *"}),l.jsx(b,{id:"workout_name",placeholder:"e.g., Morning Run",value:h.workout_name,onChange:e=>x(__spreadProps(__spreadValues({},h),{workout_name:e.target.value})),required:!0})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"workout_type",children:"Workout Type *"}),l.jsxs(K,{value:h.workout_type,onValueChange:e=>x(__spreadProps(__spreadValues({},h),{workout_type:e})),children:[l.jsx(Q,{children:l.jsx(J,{})}),l.jsxs(Z,{children:[l.jsx(X,{value:"cardio",children:"Cardio"}),l.jsx(X,{value:"strength",children:"Strength Training"}),l.jsx(X,{value:"yoga",children:"Yoga"}),l.jsx(X,{value:"sports",children:"Sports"}),l.jsx(X,{value:"hiit",children:"HIIT"}),l.jsx(X,{value:"pilates",children:"Pilates"}),l.jsx(X,{value:"swimming",children:"Swimming"}),l.jsx(X,{value:"cycling",children:"Cycling"}),l.jsx(X,{value:"other",children:"Other"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(N,{htmlFor:"duration",children:"Duration (minutes) *"}),l.jsx(b,{id:"duration",type:"number",placeholder:"30",value:h.duration_minutes,onChange:e=>x(__spreadProps(__spreadValues({},h),{duration_minutes:e.target.value})),required:!0})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"calories",children:"Calories Burned"}),l.jsx(b,{id:"calories",type:"number",placeholder:"300",value:h.calories_burned,onChange:e=>x(__spreadProps(__spreadValues({},h),{calories_burned:e.target.value}))})]})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"intensity",children:"Intensity *"}),l.jsxs(K,{value:h.intensity,onValueChange:e=>x(__spreadProps(__spreadValues({},h),{intensity:e})),children:[l.jsx(Q,{children:l.jsx(J,{})}),l.jsxs(Z,{children:[l.jsx(X,{value:"light",children:"Light"}),l.jsx(X,{value:"moderate",children:"Moderate"}),l.jsx(X,{value:"intense",children:"Intense"})]})]})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"feeling",children:"How did you feel?"}),l.jsxs(K,{value:h.feeling,onValueChange:e=>x(__spreadProps(__spreadValues({},h),{feeling:e})),children:[l.jsx(Q,{children:l.jsx(J,{})}),l.jsxs(Z,{children:[l.jsx(X,{value:"exhausted",children:"Exhausted"}),l.jsx(X,{value:"tired",children:"Tired"}),l.jsx(X,{value:"good",children:"Good"}),l.jsx(X,{value:"energized",children:"Energized"})]})]})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"notes",children:"Notes (optional)"}),l.jsx(m,{id:"notes",placeholder:"How was your workout?",value:h.notes,onChange:e=>x(__spreadProps(__spreadValues({},h),{notes:e.target.value})),rows:2})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(o,{type:"button",variant:"outline",onClick:()=>a(!1),className:"flex-1",children:"Cancel"}),l.jsx(o,{type:"submit",disabled:i,className:"flex-1",children:i?"Logging...":"Log Workout"})]})]})]})]})},QuickLogWater=({onSuccess:e})=>{const{userProfile:s}=d(),[t,a]=n.useState(0),[i,r]=n.useState(!1),m=250;n.useEffect(()=>{(null==s?void 0:s.id)&&fetchTodayWater()},[null==s?void 0:s.id]);const fetchTodayWater=()=>__async(null,null,function*(){try{const e=(new Date).toISOString().split("T")[0],{data:t}=yield c.from("daily_metrics").select("water_ml").eq("user_id",s.id).eq("date",e).single();t&&a(t.water_ml||0)}catch(e){}}),updateWater=i=>__async(null,null,function*(){r(!0);try{const r=Math.max(0,t+i),l=(new Date).toISOString().split("T")[0],{data:n}=yield c.from("daily_metrics").select("*").eq("user_id",s.id).eq("date",l).single();n?yield c.from("daily_metrics").update({water_ml:r}).eq("id",n.id):yield c.from("daily_metrics").insert({user_id:s.id,date:l,water_ml:r}),a(r),i>0&&(yield c.from("activity_feed").insert({user_id:s.id,activity_type:"water_intake",activity_title:"Water Logged",activity_description:`Added ${i}ml of water`,metadata:{water_ml:i}}),yield c.rpc("update_user_streak",{p_user_id:s.id,p_streak_type:"water_intake",p_activity_date:l})),e&&e()}catch(l){console.error("Error updating water:",l),u({title:"Error",description:"Failed to update water intake.",variant:"destructive"})}finally{r(!1)}}),h=Math.min(t/2e3*100,100),f=Math.floor(t/m);return l.jsxs(x,{className:"glass-effect h-full",children:[l.jsx(g,{className:"pb-2",children:l.jsxs(p,{className:"text-xl font-bold flex items-center gap-2",children:[l.jsx(C,{className:"w-5 h-5 text-blue-500"}),"Water Intake"]})}),l.jsxs(j,{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-baseline gap-2",children:[l.jsxs("div",{className:"text-2xl font-bold text-blue-500",children:[t,"ml"]}),l.jsxs("div",{className:"text-sm text-muted-foreground",children:["/ ",2e3,"ml"]}),l.jsxs("div",{className:"text-xs text-muted-foreground ml-auto",children:[f," glasses"]})]}),l.jsx("div",{className:"w-full bg-muted rounded-full h-3",children:l.jsx("div",{className:"bg-blue-500 h-3 rounded-full transition-all duration-300 flex items-center justify-end pr-2",style:{width:`${h}%`},children:h>15&&l.jsxs("span",{className:"text-[10px] font-semibold text-white",children:[Math.round(h),"%"]})})}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs(o,{variant:"outline",size:"sm",onClick:()=>updateWater(-250),disabled:i||0===t,children:[l.jsx(F,{className:"w-4 h-4 mr-1"}),"Remove"]}),l.jsxs(o,{size:"sm",onClick:()=>updateWater(m),disabled:i,className:"bg-blue-500 hover:bg-blue-600",children:[l.jsx(P,{className:"w-4 h-4 mr-1"}),"Add Glass"]})]}),l.jsxs("div",{className:"text-xs text-center text-muted-foreground pt-1",children:["1 glass = ",m,"ml"]})]})]})},QuickLogSleep=({onSuccess:e})=>{const{userProfile:s}=d(),[t,a]=n.useState(!1),[i,r]=n.useState(!1),[m,h]=n.useState({sleep_hours:"",sleep_quality:"good",date:new Date(Date.now()-864e5).toISOString().split("T")[0]});return l.jsxs(f,{open:t,onOpenChange:a,children:[l.jsx(v,{asChild:!0,children:l.jsxs(o,{className:"w-full",children:[l.jsx(q,{className:"w-4 h-4 mr-2"}),"Log Sleep"]})}),l.jsxs(y,{children:[l.jsx(_,{children:l.jsx(w,{children:"Log Your Sleep"})}),l.jsxs("form",{onSubmit:t=>__async(null,null,function*(){t.preventDefault(),r(!0);try{const{data:t}=yield c.from("daily_metrics").select("*").eq("user_id",s.id).eq("date",m.date).single();t?yield c.from("daily_metrics").update({sleep_hours:parseFloat(m.sleep_hours),sleep_quality:m.sleep_quality}).eq("id",t.id):yield c.from("daily_metrics").insert({user_id:s.id,date:m.date,sleep_hours:parseFloat(m.sleep_hours),sleep_quality:m.sleep_quality}),yield c.from("activity_feed").insert({user_id:s.id,activity_type:"sleep_log",activity_title:"Sleep Logged",activity_description:`${m.sleep_hours}h of ${m.sleep_quality} sleep`,metadata:{hours:parseFloat(m.sleep_hours),quality:m.sleep_quality}}),u({title:"Sleep Logged!",description:`Logged ${m.sleep_hours} hours of sleep`}),h({sleep_hours:"",sleep_quality:"good",date:new Date(Date.now()-864e5).toISOString().split("T")[0]}),a(!1),e&&e()}catch(i){console.error("Error logging sleep:",i),u({title:"Error",description:"Failed to log sleep. Please try again.",variant:"destructive"})}finally{r(!1)}}),className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(N,{htmlFor:"date",children:"Night of"}),l.jsx(b,{id:"date",type:"date",value:m.date,onChange:e=>h(__spreadProps(__spreadValues({},m),{date:e.target.value})),max:(new Date).toISOString().split("T")[0],required:!0}),l.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select the night you went to bed"})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"sleep_hours",children:"Hours of Sleep *"}),l.jsx(b,{id:"sleep_hours",type:"number",step:"0.5",placeholder:"7.5",value:m.sleep_hours,onChange:e=>h(__spreadProps(__spreadValues({},m),{sleep_hours:e.target.value})),min:"0",max:"24",required:!0})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"sleep_quality",children:"Sleep Quality"}),l.jsxs(K,{value:m.sleep_quality,onValueChange:e=>h(__spreadProps(__spreadValues({},m),{sleep_quality:e})),children:[l.jsx(Q,{children:l.jsx(J,{})}),l.jsxs(Z,{children:[l.jsx(X,{value:"poor",children:"Poor ðŸ˜´"}),l.jsx(X,{value:"fair",children:"Fair ðŸ˜"}),l.jsx(X,{value:"good",children:"Good ðŸ˜Š"}),l.jsx(X,{value:"excellent",children:"Excellent ðŸŒŸ"})]})]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(o,{type:"button",variant:"outline",onClick:()=>a(!1),className:"flex-1",children:"Cancel"}),l.jsx(o,{type:"submit",disabled:i,className:"flex-1",children:i?"Logging...":"Log Sleep"})]})]})]})]})},ProgressCharts=()=>{const{userProfile:e}=d(),[s,t]=n.useState([]),[a,i]=n.useState([]),[r,o]=n.useState([]),[u,m]=n.useState(!0),[h,f]=n.useState("7");n.useEffect(()=>{(null==e?void 0:e.id)&&fetchProgressData()},[null==e?void 0:e.id,h]);const fetchProgressData=()=>__async(null,null,function*(){try{const s=new Date;s.setDate(s.getDate()-parseInt(h));const a=s.toISOString().split("T")[0],{data:r}=yield c.from("daily_metrics").select("*").eq("user_id",e.id).gte("date",a).order("date",{ascending:!0});r&&(t(r.filter(e=>e.weight_kg).map(e=>({date:e.date,value:e.weight_kg}))),i(r.map(e=>({date:e.date,burned:e.calories_burned||0,consumed:e.calories_consumed||0}))),o(r.filter(e=>e.sleep_hours).map(e=>({date:e.date,value:e.sleep_hours,quality:e.sleep_quality})))),m(!1)}catch(s){console.error("Error fetching progress data:",s),m(!1)}}),renderSimpleChart=(e,s,t="",a="primary")=>{var i,r,n;if(0===e.length)return l.jsx("div",{className:"text-center py-8 text-muted-foreground",children:l.jsx("p",{children:"No data yet for the selected period"})});const d=Math.max(...e.map(e=>e.value||0)),o=Math.min(...e.map(e=>e.value||0)),c=d-o,u=(e=>{if(e.length<2)return{trend:"neutral",percent:0};const s=e.slice(-Math.min(3,e.length)),t=e.slice(0,Math.min(3,e.length)),a=s.reduce((e,s)=>e+s.value,0)/s.length,i=t.reduce((e,s)=>e+s.value,0)/t.length,r=(a-i)/i*100;return{trend:r>2?"up":r<-2?"down":"neutral",percent:Math.abs(r).toFixed(1)}})(e);return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"text-3xl font-bold",children:[(null==(r=null==(i=e[e.length-1])?void 0:i.value)?void 0:r.toFixed(1))||"N/A",(null==(n=e[e.length-1])?void 0:n.value)&&t]}),l.jsxs("div",{className:"text-sm text-muted-foreground",children:["Latest ",s]})]}),l.jsxs("div",{className:"flex items-center gap-2 "+("up"===u.trend?"text-green-500":"down"===u.trend?"text-red-500":"text-muted-foreground"),children:["up"===u.trend&&l.jsx(D,{className:"w-5 h-5"}),"down"===u.trend&&l.jsx(I,{className:"w-5 h-5"}),"neutral"===u.trend&&l.jsx(F,{className:"w-5 h-5"}),l.jsxs("span",{className:"text-sm font-semibold",children:[u.percent,"%"]})]})]}),l.jsx("div",{className:"space-y-2",children:e.map((e,s)=>{var a;const i=c>0?(e.value-o)/c*100:50;return l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"text-xs text-muted-foreground w-20",children:new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),l.jsxs("div",{className:"flex-1 h-8 bg-muted rounded-full overflow-hidden relative",children:[l.jsx("div",{className:"h-full bg-gradient-to-r from-primary to-green-400 rounded-full transition-all duration-300",style:{width:`${Math.max(i,5)}%`}}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-end pr-3",children:l.jsxs("span",{className:"text-xs font-medium",children:[null==(a=e.value)?void 0:a.toFixed(1),t]})})]})]},s)})}),e.length>1&&l.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t",children:[l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-sm font-semibold",children:[d.toFixed(1),t]}),l.jsx("div",{className:"text-xs text-muted-foreground",children:"Highest"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-sm font-semibold",children:[(e.reduce((e,s)=>e+s.value,0)/e.length).toFixed(1),t]}),l.jsx("div",{className:"text-xs text-muted-foreground",children:"Average"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-sm font-semibold",children:[o.toFixed(1),t]}),l.jsx("div",{className:"text-xs text-muted-foreground",children:"Lowest"})]})]})]})};return u?l.jsx(x,{className:"glass-effect",children:l.jsx(j,{className:"p-8 text-center text-muted-foreground",children:"Loading progress data..."})}):l.jsxs(x,{className:"glass-effect",children:[l.jsx(g,{children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx(p,{className:"text-xl font-bold",children:"Progress Tracking"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>f("7"),className:"px-3 py-1 rounded text-sm "+("7"===h?"bg-primary text-primary-foreground":"bg-muted"),children:"7D"}),l.jsx("button",{onClick:()=>f("30"),className:"px-3 py-1 rounded text-sm "+("30"===h?"bg-primary text-primary-foreground":"bg-muted"),children:"30D"}),l.jsx("button",{onClick:()=>f("90"),className:"px-3 py-1 rounded text-sm "+("90"===h?"bg-primary text-primary-foreground":"bg-muted"),children:"90D"})]})]})}),l.jsx(j,{children:l.jsxs(ee,{defaultValue:"weight",children:[l.jsxs(se,{className:"grid w-full grid-cols-3",children:[l.jsx(te,{value:"weight",children:"Weight"}),l.jsx(te,{value:"calories",children:"Calories"}),l.jsx(te,{value:"sleep",children:"Sleep"})]}),l.jsx(ae,{value:"weight",className:"mt-6",children:renderSimpleChart(s,"weight"," kg")}),l.jsx(ae,{value:"calories",className:"mt-6",children:0===a.length?l.jsx("div",{className:"text-center py-8 text-muted-foreground",children:l.jsx("p",{children:"No calorie data yet for the selected period"})}):l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-red-500",children:Math.round(a.reduce((e,s)=>e+s.consumed,0)/a.length)}),l.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Consumed"})]}),l.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-green-500",children:Math.round(a.reduce((e,s)=>e+s.burned,0)/a.length)}),l.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Burned"})]})]}),l.jsx("div",{className:"space-y-2",children:a.map((e,s)=>{const t=Math.max(e.consumed,e.burned,2e3);return l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-xs",children:"Consumed"}),l.jsx("span",{className:"text-xs font-semibold",children:e.consumed})]}),l.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-red-500 rounded-full",style:{width:e.consumed/t*100+"%"}})})]}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-xs",children:"Burned"}),l.jsx("span",{className:"text-xs font-semibold",children:e.burned})]}),l.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:e.burned/t*100+"%"}})})]})]})]},s)})})]})}),l.jsx(ae,{value:"sleep",className:"mt-6",children:renderSimpleChart(r,"sleep"," hrs")})]})})]})},AiMealPlanGenerator=({onSuccess:e})=>{var s;const{userProfile:t}=d(),[a,i]=n.useState(!1),[r,m]=n.useState(!1),[h,x]=n.useState(1),[g,p]=n.useState({plan_type:"daily",target_calories:"",dietary_preferences:"",meals_per_day:"3",allergies:"",cuisine_preference:"",cooking_time:"moderate"}),[j,k]=n.useState(null);return l.jsxs(f,{open:a,onOpenChange:i,children:[l.jsx(v,{asChild:!0,children:l.jsxs(o,{className:"w-full",size:"lg",children:[l.jsx(M,{className:"w-5 h-5 mr-2"}),"Generate AI Meal Plan"]})}),l.jsxs(y,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[l.jsx(_,{children:l.jsxs(w,{className:"flex items-center gap-2",children:[l.jsx(L,{className:"w-6 h-6 text-primary"}),"AI Meal Plan Generator"]})}),1===h?l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(N,{htmlFor:"plan_type",children:"Plan Type"}),l.jsxs(K,{value:g.plan_type,onValueChange:e=>p(__spreadProps(__spreadValues({},g),{plan_type:e})),children:[l.jsx(Q,{children:l.jsx(J,{})}),l.jsxs(Z,{children:[l.jsx(X,{value:"daily",children:"Daily Plan"}),l.jsx(X,{value:"weekly",children:"Weekly Plan"})]})]})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"target_calories",children:"Target Calories"}),l.jsx(b,{id:"target_calories",type:"number",placeholder:(null==t?void 0:t.target_calories)||"2000",value:g.target_calories,onChange:e=>p(__spreadProps(__spreadValues({},g),{target_calories:e.target.value}))})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(N,{htmlFor:"meals_per_day",children:"Meals per Day"}),l.jsxs(K,{value:g.meals_per_day,onValueChange:e=>p(__spreadProps(__spreadValues({},g),{meals_per_day:e})),children:[l.jsx(Q,{children:l.jsx(J,{})}),l.jsxs(Z,{children:[l.jsx(X,{value:"2",children:"2 Meals"}),l.jsx(X,{value:"3",children:"3 Meals"}),l.jsx(X,{value:"4",children:"4 Meals"}),l.jsx(X,{value:"5",children:"5 Meals"})]})]})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"cooking_time",children:"Cooking Time"}),l.jsxs(K,{value:g.cooking_time,onValueChange:e=>p(__spreadProps(__spreadValues({},g),{cooking_time:e})),children:[l.jsx(Q,{children:l.jsx(J,{})}),l.jsxs(Z,{children:[l.jsx(X,{value:"quick",children:"Quick (15-20 min)"}),l.jsx(X,{value:"moderate",children:"Moderate (30-40 min)"}),l.jsx(X,{value:"extended",children:"Extended (1+ hour)"})]})]})]})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"dietary_preferences",children:"Dietary Preferences"}),l.jsx(b,{id:"dietary_preferences",placeholder:(null==(s=null==t?void 0:t.dietary_restrictions)?void 0:s.join(", "))||"e.g., Vegetarian, Low-carb, Keto",value:g.dietary_preferences,onChange:e=>p(__spreadProps(__spreadValues({},g),{dietary_preferences:e.target.value}))})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"allergies",children:"Allergies/Restrictions"}),l.jsx(b,{id:"allergies",placeholder:"e.g., Nuts, Dairy, Gluten",value:g.allergies,onChange:e=>p(__spreadProps(__spreadValues({},g),{allergies:e.target.value}))})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"cuisine_preference",children:"Cuisine Preference (optional)"}),l.jsx(b,{id:"cuisine_preference",placeholder:"e.g., Mediterranean, Asian, American",value:g.cuisine_preference,onChange:e=>p(__spreadProps(__spreadValues({},g),{cuisine_preference:e.target.value}))})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(o,{type:"button",variant:"outline",onClick:()=>i(!1),className:"flex-1",children:"Cancel"}),l.jsx(o,{onClick:()=>__async(null,null,function*(){var e,s;m(!0);try{const a=`Create a ${g.plan_type} meal plan for a person with the following requirements:\n- Target Calories: ${g.target_calories||(null==t?void 0:t.target_calories)||2e3} kcal\n- Dietary Preferences: ${g.dietary_preferences||(null==(e=null==t?void 0:t.dietary_restrictions)?void 0:e.join(", "))||"None"}\n- Meals per Day: ${g.meals_per_day}\n- Allergies/Restrictions: ${g.allergies||"None"}\n- Cuisine Preference: ${g.cuisine_preference||"Any"}\n- Cooking Time: ${g.cooking_time}\n- Health Goals: ${(null==(s=null==t?void 0:t.health_goals)?void 0:s.join(", "))||"General wellness"}\n\nPlease provide detailed meal suggestions with ingredients, portions, and nutritional breakdown for each meal.`,i=generateMockMealPlan(g,t),{data:r,error:l}=yield c.from("ai_meal_plans").insert({user_id:t.id,plan_name:`${g.plan_type} Meal Plan - ${(new Date).toLocaleDateString()}`,plan_type:g.plan_type,target_date:(new Date).toISOString().split("T")[0],target_calories:parseInt(g.target_calories||2e3),meals:i.meals,ai_prompt:a,ai_model:"gpt-4",status:"active"}).select().single();if(l)throw l;k(i),x(2),u({title:"Meal Plan Generated!",description:"Your personalized meal plan is ready"})}catch(a){console.error("Error generating meal plan:",a),u({title:"Error",description:"Failed to generate meal plan. Please try again.",variant:"destructive"})}finally{m(!1)}}),disabled:r,className:"flex-1",children:r?l.jsxs(l.Fragment,{children:[l.jsx(M,{className:"w-4 h-4 mr-2 animate-pulse"}),"Generating..."]}):l.jsxs(l.Fragment,{children:[l.jsx(M,{className:"w-4 h-4 mr-2"}),"Generate Plan"]})})]})]}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"p-4 bg-primary/10 rounded-lg border border-primary/20",children:[l.jsx("h3",{className:"font-semibold mb-2",children:"Your Personalized Meal Plan"}),l.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Total Calories"}),l.jsx("div",{className:"font-semibold",children:null==j?void 0:j.totalCalories})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Protein"}),l.jsxs("div",{className:"font-semibold",children:[null==j?void 0:j.totalProtein,"g"]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Carbs"}),l.jsxs("div",{className:"font-semibold",children:[null==j?void 0:j.totalCarbs,"g"]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Fats"}),l.jsxs("div",{className:"font-semibold",children:[null==j?void 0:j.totalFats,"g"]})]})]})]}),l.jsx("div",{className:"space-y-4",children:null==j?void 0:j.meals.map((e,s)=>l.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(T,{className:"w-4 h-4 text-primary"}),l.jsx("h4",{className:"font-semibold capitalize",children:e.type})]}),l.jsxs("span",{className:"text-sm text-muted-foreground",children:[e.calories," kcal"]})]}),l.jsx("h5",{className:"font-medium",children:e.name}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.description}),l.jsxs("div",{className:"flex gap-4 mt-2 text-xs text-muted-foreground",children:[l.jsxs("span",{children:["P: ",e.protein,"g"]}),l.jsxs("span",{children:["C: ",e.carbs,"g"]}),l.jsxs("span",{children:["F: ",e.fats,"g"]})]}),e.ingredients&&l.jsxs("div",{className:"mt-2 text-sm",children:[l.jsx("strong",{children:"Ingredients:"})," ",e.ingredients]})]},s))}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(o,{type:"button",variant:"outline",onClick:()=>x(1),className:"flex-1",children:"Regenerate"}),l.jsx(o,{onClick:()=>__async(null,null,function*(){m(!0);try{const s=(new Date).toISOString().split("T")[0];for(const e of j.meals)yield c.from("meal_logs").insert({user_id:t.id,meal_type:e.type.toLowerCase(),meal_name:e.name,description:e.description,calories:e.calories,protein_g:e.protein,carbs_g:e.carbs,fats_g:e.fats,date:s,ai_generated:!0}),yield c.from("activity_feed").insert({user_id:t.id,activity_type:"ai_meal_plan",activity_title:"AI Meal Plan Created",activity_description:`Generated ${j.meals.length} meal suggestions`,metadata:{meal_count:j.meals.length}});u({title:"Meals Saved!",description:"Your meal plan has been added to today's log"}),i(!1),x(1),k(null),e&&e()}catch(s){console.error("Error saving meals:",s),u({title:"Error",description:"Failed to save meals. Please try again.",variant:"destructive"})}finally{m(!1)}}),disabled:r,className:"flex-1",children:r?"Saving...":"Save to Today"})]})]})]})]})},generateMockMealPlan=(e,s)=>{const t=parseInt(e.target_calories||2e3),a=parseInt(e.meals_per_day),i=Math.floor(t/a),r=["breakfast","lunch","dinner","snack"],l=[],n={breakfast:[{name:"Greek Yogurt Bowl",desc:"Greek yogurt with berries, granola, and honey",ingredients:"Greek yogurt, mixed berries, granola, honey, almonds"},{name:"Avocado Toast",desc:"Whole grain toast with mashed avocado and poached eggs",ingredients:"Whole grain bread, avocado, eggs, cherry tomatoes, olive oil"},{name:"Protein Smoothie",desc:"Banana, protein powder, spinach, and almond milk",ingredients:"Banana, protein powder, spinach, almond milk, peanut butter"}],lunch:[{name:"Grilled Chicken Salad",desc:"Mixed greens with grilled chicken, quinoa, and vinaigrette",ingredients:"Chicken breast, mixed greens, quinoa, cherry tomatoes, cucumber, olive oil"},{name:"Salmon Bowl",desc:"Brown rice with baked salmon, edamame, and avocado",ingredients:"Salmon fillet, brown rice, edamame, avocado, sesame seeds, soy sauce"},{name:"Turkey Wrap",desc:"Whole wheat wrap with turkey, hummus, and veggies",ingredients:"Whole wheat tortilla, turkey breast, hummus, lettuce, tomato, cucumber"}],dinner:[{name:"Stir-Fry Chicken",desc:"Chicken with colorful vegetables and brown rice",ingredients:"Chicken breast, broccoli, bell peppers, carrots, brown rice, soy sauce"},{name:"Baked Cod",desc:"Lemon herb cod with roasted vegetables",ingredients:"Cod fillet, lemon, herbs, sweet potato, asparagus, olive oil"},{name:"Lean Beef & Quinoa",desc:"Seasoned lean beef with quinoa and steamed broccoli",ingredients:"Lean beef, quinoa, broccoli, garlic, spices"}],snack:[{name:"Apple & Almond Butter",desc:"Sliced apple with natural almond butter",ingredients:"Apple, almond butter"},{name:"Protein Bar",desc:"High-protein, low-sugar protein bar",ingredients:"Protein bar"},{name:"Mixed Nuts",desc:"Handful of mixed nuts and dried fruit",ingredients:"Almonds, cashews, dried cranberries"}]};for(let d=0;d<a;d++){const e=r[d%4],s=n[e],t=s[Math.floor(Math.random()*s.length)];l.push({type:e,name:t.name,description:t.desc,ingredients:t.ingredients,calories:i+Math.floor(100*Math.random()-50),protein:Math.floor(.3*i/4),carbs:Math.floor(.4*i/4),fats:Math.floor(.3*i/9)})}return{meals:l,totalCalories:l.reduce((e,s)=>e+s.calories,0),totalProtein:l.reduce((e,s)=>e+s.protein,0),totalCarbs:l.reduce((e,s)=>e+s.carbs,0),totalFats:l.reduce((e,s)=>e+s.fats,0)}},AiWorkoutPlanner=({onSuccess:e})=>{const{userProfile:s}=d(),[t,a]=n.useState(!1),[i,r]=n.useState(!1),[m,h]=n.useState(1),[x,g]=n.useState({plan_type:"daily",fitness_level:"intermediate",workout_duration:"30",equipment:"bodyweight",focus_area:"full_body",intensity:"moderate"}),[p,j]=n.useState(null);return l.jsxs(f,{open:t,onOpenChange:a,children:[l.jsx(v,{asChild:!0,children:l.jsxs(o,{className:"w-full",size:"lg",variant:"outline",children:[l.jsx(M,{className:"w-5 h-5 mr-2"}),"Generate AI Workout"]})}),l.jsxs(y,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[l.jsx(_,{children:l.jsxs(w,{className:"flex items-center gap-2",children:[l.jsx(S,{className:"w-6 h-6 text-primary"}),"AI Workout Planner"]})}),1===m?l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(N,{htmlFor:"plan_type",children:"Plan Type"}),l.jsxs(K,{value:x.plan_type,onValueChange:e=>g(__spreadProps(__spreadValues({},x),{plan_type:e})),children:[l.jsx(Q,{children:l.jsx(J,{})}),l.jsxs(Z,{children:[l.jsx(X,{value:"daily",children:"Single Workout"}),l.jsx(X,{value:"weekly",children:"Weekly Program"})]})]})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"fitness_level",children:"Fitness Level"}),l.jsxs(K,{value:x.fitness_level,onValueChange:e=>g(__spreadProps(__spreadValues({},x),{fitness_level:e})),children:[l.jsx(Q,{children:l.jsx(J,{})}),l.jsxs(Z,{children:[l.jsx(X,{value:"beginner",children:"Beginner"}),l.jsx(X,{value:"intermediate",children:"Intermediate"}),l.jsx(X,{value:"advanced",children:"Advanced"})]})]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(N,{htmlFor:"duration",children:"Duration (minutes)"}),l.jsxs(K,{value:x.workout_duration,onValueChange:e=>g(__spreadProps(__spreadValues({},x),{workout_duration:e})),children:[l.jsx(Q,{children:l.jsx(J,{})}),l.jsxs(Z,{children:[l.jsx(X,{value:"15",children:"15 minutes"}),l.jsx(X,{value:"30",children:"30 minutes"}),l.jsx(X,{value:"45",children:"45 minutes"}),l.jsx(X,{value:"60",children:"60 minutes"})]})]})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"intensity",children:"Intensity"}),l.jsxs(K,{value:x.intensity,onValueChange:e=>g(__spreadProps(__spreadValues({},x),{intensity:e})),children:[l.jsx(Q,{children:l.jsx(J,{})}),l.jsxs(Z,{children:[l.jsx(X,{value:"light",children:"Light"}),l.jsx(X,{value:"moderate",children:"Moderate"}),l.jsx(X,{value:"intense",children:"Intense"})]})]})]})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"equipment",children:"Available Equipment"}),l.jsxs(K,{value:x.equipment,onValueChange:e=>g(__spreadProps(__spreadValues({},x),{equipment:e})),children:[l.jsx(Q,{children:l.jsx(J,{})}),l.jsxs(Z,{children:[l.jsx(X,{value:"bodyweight",children:"Bodyweight Only"}),l.jsx(X,{value:"dumbbells",children:"Dumbbells"}),l.jsx(X,{value:"gym",children:"Full Gym Access"}),l.jsx(X,{value:"home",children:"Home Equipment (bands, weights)"})]})]})]}),l.jsxs("div",{children:[l.jsx(N,{htmlFor:"focus_area",children:"Focus Area"}),l.jsxs(K,{value:x.focus_area,onValueChange:e=>g(__spreadProps(__spreadValues({},x),{focus_area:e})),children:[l.jsx(Q,{children:l.jsx(J,{})}),l.jsxs(Z,{children:[l.jsx(X,{value:"full_body",children:"Full Body"}),l.jsx(X,{value:"upper_body",children:"Upper Body"}),l.jsx(X,{value:"lower_body",children:"Lower Body"}),l.jsx(X,{value:"core",children:"Core & Abs"}),l.jsx(X,{value:"cardio",children:"Cardio"}),l.jsx(X,{value:"flexibility",children:"Flexibility & Mobility"})]})]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(o,{type:"button",variant:"outline",onClick:()=>a(!1),className:"flex-1",children:"Cancel"}),l.jsx(o,{onClick:()=>__async(null,null,function*(){var e;r(!0);try{const t=`Create a ${x.plan_type} workout plan with:\n- Fitness Level: ${x.fitness_level}\n- Duration: ${x.workout_duration} minutes\n- Equipment: ${x.equipment}\n- Focus Area: ${x.focus_area}\n- Intensity: ${x.intensity}\n- Health Goals: ${(null==(e=null==s?void 0:s.health_goals)?void 0:e.join(", "))||"General fitness"}\n\nProvide detailed exercises with sets, reps, and instructions.`,a=generateMockWorkoutPlan(x,s),{data:i,error:r}=yield c.from("ai_workout_plans").insert({user_id:s.id,plan_name:`${x.focus_area} Workout - ${(new Date).toLocaleDateString()}`,plan_type:x.plan_type,target_date:(new Date).toISOString().split("T")[0],difficulty:x.fitness_level,workouts:a.workouts,ai_prompt:t,ai_model:"gpt-4",status:"active"}).select().single();if(r)throw r;j(a),h(2),u({title:"Workout Plan Generated!",description:"Your personalized workout is ready"})}catch(t){console.error("Error generating workout:",t),u({title:"Error",description:"Failed to generate workout. Please try again.",variant:"destructive"})}finally{r(!1)}}),disabled:i,className:"flex-1",children:i?l.jsxs(l.Fragment,{children:[l.jsx(M,{className:"w-4 h-4 mr-2 animate-pulse"}),"Generating..."]}):l.jsxs(l.Fragment,{children:[l.jsx(M,{className:"w-4 h-4 mr-2"}),"Generate Workout"]})})]})]}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"p-4 bg-primary/10 rounded-lg border border-primary/20",children:[l.jsx("h3",{className:"font-semibold mb-2",children:null==p?void 0:p.name}),l.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Duration"}),l.jsxs("div",{className:"font-semibold",children:[null==p?void 0:p.totalDuration," min"]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Exercises"}),l.jsx("div",{className:"font-semibold",children:null==p?void 0:p.workouts.length})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Est. Calories"}),l.jsx("div",{className:"font-semibold",children:null==p?void 0:p.estimatedCalories})]})]})]}),l.jsx("div",{className:"space-y-3",children:null==p?void 0:p.workouts.map((e,s)=>l.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx($,{className:"w-4 h-4 text-primary"}),l.jsx("h4",{className:"font-semibold",children:e.name})]}),l.jsxs("span",{className:"text-sm text-muted-foreground",children:[e.sets,"x",e.reps]})]}),l.jsx("p",{className:"text-sm text-muted-foreground",children:e.instructions}),e.rest&&l.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Rest: ",e.rest,"s"]})]},s))}),l.jsxs("div",{className:"p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg text-sm",children:[l.jsx("strong",{children:"ðŸ’¡ Pro Tip:"})," Remember to warm up for 5 minutes before starting and cool down with stretching afterwards!"]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(o,{type:"button",variant:"outline",onClick:()=>h(1),className:"flex-1",children:"Regenerate"}),l.jsx(o,{onClick:()=>__async(null,null,function*(){r(!0);try{const t=(new Date).toISOString().split("T")[0];yield c.from("workout_logs").insert({user_id:s.id,workout_name:p.name,workout_type:x.focus_area,duration_minutes:p.totalDuration,calories_burned:p.estimatedCalories,intensity:x.intensity,exercises:p.workouts,date:t,ai_generated:!0,notes:"AI Generated Workout"}),yield c.from("activity_feed").insert({user_id:s.id,activity_type:"ai_workout_plan",activity_title:"AI Workout Plan Created",activity_description:p.name,metadata:{exercises:p.workouts.length}}),u({title:"Workout Saved!",description:"Your workout has been added to today's log"}),a(!1),h(1),j(null),e&&e()}catch(t){console.error("Error saving workout:",t),u({title:"Error",description:"Failed to save workout. Please try again.",variant:"destructive"})}finally{r(!1)}}),disabled:i,className:"flex-1",children:i?"Saving...":"Save Workout"})]})]})]})]})},generateMockWorkoutPlan=(e,s)=>{const t={full_body:[{name:"Push-ups",sets:3,reps:12,instructions:"Keep body straight, lower until chest nearly touches floor",rest:60},{name:"Squats",sets:3,reps:15,instructions:"Feet shoulder-width apart, lower until thighs parallel to ground",rest:60},{name:"Plank",sets:3,reps:"30s",instructions:"Hold body straight in plank position",rest:45},{name:"Lunges",sets:3,reps:"10 each",instructions:"Step forward, lower back knee toward floor",rest:60},{name:"Mountain Climbers",sets:3,reps:20,instructions:"Bring knees to chest alternately in plank position",rest:45}],upper_body:[{name:"Push-ups",sets:4,reps:12,instructions:"Standard push-up form",rest:60},{name:"Dips",sets:3,reps:10,instructions:"Use chair or parallel bars",rest:60},{name:"Pike Push-ups",sets:3,reps:8,instructions:"Hips up, head down between arms",rest:60},{name:"Arm Circles",sets:2,reps:30,instructions:"Small to large circles, both directions",rest:30}],lower_body:[{name:"Squats",sets:4,reps:15,instructions:"Bodyweight squats, full range of motion",rest:60},{name:"Lunges",sets:3,reps:"12 each",instructions:"Alternating forward lunges",rest:60},{name:"Glute Bridges",sets:3,reps:15,instructions:"Lift hips, squeeze glutes at top",rest:45},{name:"Calf Raises",sets:3,reps:20,instructions:"Rise up on toes, slow descent",rest:45}],core:[{name:"Plank",sets:3,reps:"45s",instructions:"Hold strong plank position",rest:45},{name:"Bicycle Crunches",sets:3,reps:20,instructions:"Bring opposite elbow to knee",rest:45},{name:"Russian Twists",sets:3,reps:30,instructions:"Rotate torso side to side",rest:45},{name:"Leg Raises",sets:3,reps:12,instructions:"Lift legs up, control descent",rest:60}],cardio:[{name:"Jumping Jacks",sets:3,reps:30,instructions:"Full range jumping jacks",rest:30},{name:"High Knees",sets:3,reps:40,instructions:"Run in place with high knees",rest:30},{name:"Burpees",sets:3,reps:10,instructions:"Full burpee with jump",rest:60},{name:"Mountain Climbers",sets:3,reps:30,instructions:"Fast-paced mountain climbers",rest:45}]},a=t[e.focus_area]||t.full_body,i=parseInt(e.workout_duration),r="intense"===e.intensity?10:"moderate"===e.intensity?7:5;return{name:`${e.focus_area.replace("_"," ").toUpperCase()} ${e.intensity} Workout`,workouts:a.slice(0,Math.floor(i/5)),totalDuration:i,estimatedCalories:i*r}},PersonalizedInsights=()=>{const{userProfile:e}=d(),[s,t]=n.useState([]),[a,i]=n.useState(!0);n.useEffect(()=>{(null==e?void 0:e.id)&&generateInsights()},[null==e?void 0:e.id]);const generateInsights=()=>__async(null,null,function*(){try{const s=(new Date).toISOString().split("T")[0],a=new Date;a.setDate(a.getDate()-7);const r=a.toISOString().split("T")[0],{data:l}=yield c.from("daily_metrics").select("*").eq("user_id",e.id).gte("date",r).order("date",{ascending:!0}),{data:n}=yield c.from("daily_metrics").select("*").eq("user_id",e.id).eq("date",s).single(),{data:d}=yield c.from("workout_logs").select("*").eq("user_id",e.id).gte("date",r),{data:o}=yield c.from("meal_logs").select("*").eq("user_id",e.id).gte("date",r),u=analyzeData(l||[],n,d||[],o||[],e);t(u),i(!1)}catch(s){console.error("Error generating insights:",s),i(!1)}}),analyzeData=(e,s,t,a,i)=>{var r,l;const n=[],d=e.filter(e=>e.weight_kg);if(d.length>=2){const e=d[0].weight_kg,s=d[d.length-1].weight_kg-e;Math.abs(s)>.5&&n.push({type:s<0?"success":"info",icon:D,title:s<0?"Weight Loss Progress":"Weight Gain",message:`You've ${s<0?"lost":"gained"} ${Math.abs(s).toFixed(1)}kg this week. ${s<0?"Great work! Keep it up!":"This might be muscle gain if you're strength training."}`})}if(s){const e=s.calories_consumed||0;s.calories_burned;const t=i.target_calories||2e3;e<.8*t?n.push({type:"warning",icon:A,title:"Low Calorie Intake",message:`You've consumed ${e} calories today, which is below your goal of ${t}. Consider adding a healthy snack!`}):e>1.2*t&&n.push({type:"info",icon:W,title:"High Calorie Day",message:`You've consumed ${e} calories today. If this was planned, great! Otherwise, try balancing tomorrow.`})}if(s){const e=s.water_ml||0;e<1500?n.push({type:"warning",icon:A,title:"Hydration Reminder",message:`You've had ${e}ml of water today. Aim for at least 2000ml for optimal hydration!`}):e>=2e3&&n.push({type:"success",icon:O,title:"Great Hydration!",message:`You've hit your water goal with ${e}ml today. Keep up the excellent hydration!`})}const o=e.filter(e=>e.sleep_hours);if(o.length>=3){const e=o.reduce((e,s)=>e+s.sleep_hours,0)/o.length;e<6.5?n.push({type:"warning",icon:A,title:"Insufficient Sleep",message:`Your average sleep is ${e.toFixed(1)} hours. Aim for 7-9 hours for better recovery and health.`}):e>=7&&e<=9&&n.push({type:"success",icon:O,title:"Excellent Sleep Pattern",message:`You're averaging ${e.toFixed(1)} hours of sleep. This is optimal for recovery and performance!`})}if(0===t.length?n.push({type:"info",icon:W,title:"Time to Move",message:"No workouts logged this week. Even a 15-minute walk can make a difference! Try our AI workout generator."}):t.length>=3&&n.push({type:"success",icon:O,title:"Active Week!",message:`You've completed ${t.length} workouts this week. You're crushing your fitness goals!`}),0===a.length&&n.push({type:"info",icon:W,title:"Start Tracking Meals",message:"Logging your meals helps you stay accountable and reach your nutrition goals faster."}),null==(r=i.health_goals)?void 0:r.includes("lose_weight")){(consumed||0)-(burned||0)>0&&s&&n.push({type:"info",icon:W,title:"Calorie Deficit",message:"To lose weight, aim to burn more calories than you consume. Consider adding a workout or reducing portion sizes."})}if(null==(l=i.health_goals)?void 0:l.includes("build_muscle")){const s=1.6*(i.weight_kg||70),t=e.reduce((e,s)=>e+(s.protein_g||0),0)/Math.max(e.length,1);t<.8*s&&n.push({type:"info",icon:W,title:"Increase Protein Intake",message:`For muscle building, aim for ${s.toFixed(0)}g of protein daily. You're averaging ${t.toFixed(0)}g.`})}return 0===n.length&&n.push({type:"success",icon:O,title:"Looking Good!",message:"Keep logging your data to get personalized insights and track your progress effectively."}),n.slice(0,5)},getIconColor=e=>{switch(e){case"success":return"text-green-500";case"warning":return"text-yellow-500";case"info":return"text-blue-500";default:return"text-muted-foreground"}},getBgColor=e=>{switch(e){case"success":return"bg-green-500/10 border-green-500/20";case"warning":return"bg-yellow-500/10 border-yellow-500/20";case"info":return"bg-blue-500/10 border-blue-500/20";default:return"bg-muted border-border"}};return a?l.jsx(x,{className:"glass-effect",children:l.jsx(j,{className:"p-8 text-center text-muted-foreground",children:"Analyzing your data..."})}):l.jsxs(x,{className:"glass-effect",children:[l.jsx(g,{children:l.jsxs(p,{className:"text-xl font-bold flex items-center gap-2",children:[l.jsx(E,{className:"w-5 h-5 text-primary"}),"Personalized Insights"]})}),l.jsx(j,{className:"space-y-3",children:s.map((e,s)=>{const t=e.icon;return l.jsx("div",{className:`p-4 rounded-lg border ${getBgColor(e.type)}`,children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(t,{className:`w-5 h-5 flex-shrink-0 mt-0.5 ${getIconColor(e.type)}`}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"font-semibold mb-1",children:e.title}),l.jsx("p",{className:"text-sm text-muted-foreground",children:e.message})]})]})},s)})})]})},ie=n.memo(({logoUrl:e})=>{var s;const{userProfile:t}=d(),[a,i]=n.useState(null),[r,o]=n.useState([]),[u,m]=n.useState([]),[f,v]=n.useState(!0),[y,_]=n.useState(0);n.useEffect(()=>{(null==t?void 0:t.id)&&fetchDashboardData()},[null==t?void 0:t.id,y]);const fetchDashboardData=()=>__async(null,null,function*(){try{const e=(new Date).toISOString().split("T")[0],{data:s}=yield c.from("daily_metrics").select("*").eq("user_id",t.id).eq("date",e).single();i(s);const{data:a}=yield c.from("activity_feed").select("*").eq("user_id",t.id).order("created_at",{ascending:!1}).limit(5);o(a||[]);const{data:r}=yield c.from("user_streaks").select("*").eq("user_id",t.id);m(r||[]),v(!1)}catch(e){console.error("Error fetching dashboard data:",e),v(!1)}}),handleRefresh=()=>{_(e=>e+1)},getGoalIcon=e=>{switch(e){case"lose_weight":return l.jsx(k,{className:"w-6 h-6 text-primary"});case"build_muscle":return l.jsx(S,{className:"w-6 h-6 text-primary"});case"improve_endurance":return l.jsx(B,{className:"w-6 h-6 text-primary"});case"eat_healthier":return l.jsx(V,{className:"w-6 h-6 text-primary"});case"increase_energy":return l.jsx($,{className:"w-6 h-6 text-primary"});default:return l.jsx(R,{className:"w-6 h-6 text-primary"})}},{bmi:w,category:b}=n.useMemo(()=>((e,s)=>{if(!e||!s)return{bmi:"N/A",category:"N/A"};const t=s/100,a=(e/(t*t)).toFixed(1);let i="";return i=a<18.5?"Underweight":a>=18.5&&a<=24.9?"Normal":a>=25&&a<=29.9?"Overweight":"Obese",{bmi:a,category:i}})(null==t?void 0:t.weight_kg,null==t?void 0:t.height_cm),[null==t?void 0:t.weight_kg,null==t?void 0:t.height_cm]),N=n.useMemo(()=>({hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}}),[]),F=n.useMemo(()=>({hidden:{y:20,opacity:0},visible:{y:0,opacity:1}}),[]);return l.jsxs(l.Fragment,{children:[l.jsxs(h,{children:[l.jsx("title",{children:"Dashboard - GreenoFig"}),l.jsx("meta",{name:"description",content:"Your personal health and wellness dashboard."})]}),l.jsxs(G.div,{variants:N,initial:"hidden",animate:"visible",className:"space-y-8",children:[l.jsxs(G.div,{variants:F,children:[l.jsxs("h1",{className:"text-4xl font-bold",children:["Welcome back, ",l.jsxs("span",{className:"gradient-text",children:[(null==(s=null==t?void 0:t.full_name)?void 0:s.split(" ")[0])||"User","!"]})]}),l.jsx("p",{className:"text-text-secondary mt-2",children:"Here's your wellness snapshot for today. Let's make it a great one!"})]}),l.jsxs(G.div,{variants:N,className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsx(G.div,{variants:F,className:"lg:col-span-2",children:l.jsxs(x,{className:"glass-effect",children:[l.jsx(g,{children:l.jsx(p,{className:"text-xl font-bold",children:"Quick Actions"})}),l.jsxs(j,{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[l.jsx(QuickLogWeight,{onSuccess:handleRefresh}),l.jsx(U,{onSuccess:handleRefresh}),l.jsx(QuickLogWorkout,{onSuccess:handleRefresh}),l.jsx(QuickLogSleep,{onSuccess:handleRefresh})]})]})}),l.jsx(G.div,{variants:F,children:l.jsx(QuickLogWater,{onSuccess:handleRefresh})})]}),l.jsxs(G.div,{variants:N,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsx(G.div,{variants:F,children:l.jsxs(x,{className:"glass-effect h-full",children:[l.jsxs(g,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[l.jsx(p,{className:"text-sm font-medium",children:"Weight"}),l.jsx(k,{className:"h-4 w-4 text-muted-foreground"})]}),l.jsxs(j,{children:[l.jsxs("div",{className:"text-2xl font-bold",children:[(null==a?void 0:a.weight_kg)||(null==t?void 0:t.weight_kg)||"N/A",((null==a?void 0:a.weight_kg)||(null==t?void 0:t.weight_kg))&&" kg"]}),l.jsx("p",{className:"text-xs text-muted-foreground",children:(null==a?void 0:a.weight_kg)?"Today's weight":"Last logged weight"})]})]})}),l.jsx(G.div,{variants:F,children:l.jsxs(x,{className:"glass-effect h-full",children:[l.jsxs(g,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[l.jsx(p,{className:"text-sm font-medium",children:"BMI"}),l.jsx(B,{className:"h-4 w-4 text-muted-foreground"})]}),l.jsxs(j,{children:[l.jsx("div",{className:"text-2xl font-bold",children:w}),l.jsx("p",{className:"text-xs text-muted-foreground",children:b})]})]})}),l.jsx(G.div,{variants:F,children:l.jsxs(x,{className:"glass-effect h-full",children:[l.jsxs(g,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[l.jsx(p,{className:"text-sm font-medium",children:"Calories Today"}),l.jsx(Y,{className:"h-4 w-4 text-muted-foreground"})]}),l.jsxs(j,{children:[l.jsx("div",{className:"text-2xl font-bold",children:(null==a?void 0:a.calories_burned)||0}),l.jsxs("p",{className:"text-xs text-muted-foreground",children:["Burned â€¢ ",(null==a?void 0:a.calories_consumed)||0," consumed"]})]})]})}),l.jsx(G.div,{variants:F,children:l.jsxs(x,{className:"glass-effect h-full",children:[l.jsxs(g,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[l.jsx(p,{className:"text-sm font-medium",children:"Sleep"}),l.jsx(q,{className:"h-4 w-4 text-muted-foreground"})]}),l.jsxs(j,{children:[l.jsx("div",{className:"text-2xl font-bold",children:(null==a?void 0:a.sleep_hours)?`${a.sleep_hours}h`:"Not logged"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:(null==a?void 0:a.sleep_quality)||"Log your sleep"})]})]})})]}),1===u.length&&l.jsx(G.div,{variants:F,children:l.jsx(x,{className:"glass-effect",children:l.jsx(j,{className:"py-4",children:l.jsxs("div",{className:"flex items-center justify-center gap-4",children:[l.jsx(H,{className:"w-5 h-5 text-yellow-500"}),l.jsxs("div",{className:"flex items-baseline gap-2",children:[l.jsx("span",{className:"text-2xl font-bold text-primary",children:u[0].current_streak}),l.jsx("span",{className:"text-sm text-muted-foreground",children:"day"}),l.jsxs("span",{className:"text-sm font-medium capitalize",children:[u[0].streak_type.replace(/_/g," ")," streak"]})]}),l.jsxs("div",{className:"text-xs text-muted-foreground",children:["Best: ",u[0].longest_streak," days"]})]})})})}),u.length>=2&&l.jsx(G.div,{variants:F,children:l.jsxs(x,{className:"glass-effect",children:[l.jsx(g,{children:l.jsxs(p,{className:"text-xl font-bold flex items-center gap-2",children:[l.jsx(H,{className:"w-5 h-5 text-yellow-500"}),"Your Streaks"]})}),l.jsx(j,{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:u.map(e=>l.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[l.jsx("div",{className:"text-3xl font-bold text-primary",children:e.current_streak}),l.jsx("div",{className:"text-sm text-muted-foreground capitalize",children:e.streak_type.replace(/_/g," ")}),l.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Best: ",e.longest_streak]})]},e.id))})]})}),l.jsxs(G.div,{variants:N,className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsx(G.div,{variants:F,className:"lg:col-span-2",children:l.jsxs(x,{className:"glass-effect h-full",children:[l.jsx(g,{children:l.jsxs(p,{className:"text-xl font-bold flex items-center gap-2",children:[l.jsx(z,{className:"w-5 h-5"}),"Recent Activity"]})}),l.jsx(j,{className:"space-y-3",children:r.length>0?r.map(e=>l.jsxs(G.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-start gap-3 p-3 bg-muted rounded-lg",children:[l.jsxs("div",{className:"flex-shrink-0 p-2 rounded-full bg-primary/20",children:["logged_meal"===e.activity_type&&l.jsx(T,{className:"w-4 h-4 text-primary"}),"completed_workout"===e.activity_type&&l.jsx(S,{className:"w-4 h-4 text-primary"}),"weight_update"===e.activity_type&&l.jsx(k,{className:"w-4 h-4 text-primary"}),"sleep_log"===e.activity_type&&l.jsx(q,{className:"w-4 h-4 text-primary"}),"water_intake"===e.activity_type&&l.jsx(C,{className:"w-4 h-4 text-primary"})]}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"font-medium",children:e.activity_title}),l.jsx("div",{className:"text-sm text-muted-foreground",children:e.activity_description}),l.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:new Date(e.created_at).toLocaleString()})]})]},e.id)):l.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[l.jsx(z,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),l.jsx("p",{children:"No activity yet. Start logging your health data!"})]})})]})}),l.jsx(G.div,{variants:F,children:l.jsxs(x,{className:"glass-effect h-full",children:[l.jsx(g,{children:l.jsx(p,{className:"text-xl font-bold",children:"Your Goals"})}),l.jsx(j,{className:"space-y-4",children:(null==t?void 0:t.health_goals)&&t.health_goals.length>0?t.health_goals.map(e=>l.jsxs(G.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"flex items-center gap-4 bg-muted p-3 rounded-lg",children:[getGoalIcon(e),l.jsx("span",{className:"font-medium text-text-primary capitalize",children:e.replace(/_/g," ")})]},e)):l.jsx("p",{className:"text-text-secondary",children:"No goals set yet. Update your profile to add goals!"})})]})})]}),l.jsx(G.div,{variants:F,children:l.jsx(ProgressCharts,{})}),l.jsxs(G.div,{variants:N,className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsx(G.div,{variants:F,children:l.jsx(PersonalizedInsights,{})}),l.jsx(G.div,{variants:F,children:l.jsxs(x,{className:"glass-effect h-full",children:[l.jsx(g,{children:l.jsx(p,{className:"text-xl font-bold",children:"AI-Powered Tools"})}),l.jsxs(j,{className:"space-y-3",children:[l.jsx(AiMealPlanGenerator,{onSuccess:handleRefresh}),l.jsx(AiWorkoutPlanner,{onSuccess:handleRefresh})]})]})})]})]})]})});ie.displayName="UserDashboard";export{ie as default};
