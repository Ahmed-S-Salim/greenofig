import{j as e}from"./vendor-ui-5701c8ab.js";import{r as s,u as t,f as a}from"./vendor-react-c35372bd.js";import{u as r,a as l,B as i,t as n,s as o,H as c,c as d}from"./index-8b14cb79.js";import{S as m}from"./SiteLayout-c184b565.js";import{D as x,a as p,b as u,c as h,d as y}from"./dialog-da002b66.js";import{E as f,Z as g,L as j,a as b,m as v,V as N}from"./vendor-utils-278148e0.js";import"./vendor-editor-1616b420.js";import"./OnboardingSurvey-c8353612.js";const w=({open:t,onOpenChange:a,plan:c,billingCycle:d="monthly"})=>{var m,v;const{user:N}=r(),[w,k]=s.useState(!1);if(!c)return null;const C="yearly"===d?c.price_yearly:c.price_monthly;"yearly"===d?c.price_yearly:c.price_monthly;const P="yearly"===d?12*c.price_monthly-c.price_yearly:0;return e.jsx(x,{open:t,onOpenChange:a,children:e.jsxs(p,{className:"glass-effect custom-scrollbar max-w-[95vw] sm:max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs(u,{children:[e.jsxs(h,{className:"flex items-center gap-2 text-base sm:text-lg",children:[e.jsx(f,{className:"w-4 h-4 sm:w-5 sm:h-5","aria-hidden":"true"}),"Checkout"]}),e.jsx(y,{className:"text-sm",children:"Complete your subscription purchase"})]}),e.jsxs("div",{className:"space-y-6 min-w-0 max-w-full",children:[e.jsxs("div",{className:"p-4 rounded-lg border border-border bg-background/50",role:"region","aria-label":"Plan summary",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-2 mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold",children:c.name}),e.jsx("p",{className:"text-sm text-text-secondary mt-1",children:c.description})]}),c.is_popular&&e.jsx(l,{className:"bg-primary/20 text-primary self-start",children:"Popular"})]}),e.jsxs("div",{className:"space-y-2 pt-4 border-t border-border",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Billing Cycle:"}),e.jsx("span",{className:"font-semibold capitalize",children:d})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Price:"}),e.jsxs("span",{className:"font-semibold",children:["$",C.toFixed(2),"/","yearly"===d?"year":"month"]})]}),"yearly"===d&&P>0&&e.jsxs("div",{className:"flex justify-between text-sm text-green-400",children:[e.jsx("span",{children:"You Save:"}),e.jsxs("span",{className:"font-semibold",children:["$",P.toFixed(2),"/year"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"What's included:"}),e.jsxs("ul",{className:"space-y-2",children:[null==(m=c.features)?void 0:m.slice(0,5).map((s,t)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx(g,{className:"w-4 h-4 text-green-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:s})]},t)),(null==(v=c.features)?void 0:v.length)>5&&e.jsxs("li",{className:"text-sm text-text-secondary",children:["+ ",c.features.length-5," more features"]})]})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-primary/10 border border-primary/20",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold",children:"Total Due Today:"}),e.jsxs("span",{className:"text-2xl font-bold",children:["$",C.toFixed(2)]})]}),"yearly"===d&&e.jsxs("p",{className:"text-xs text-text-secondary mt-2",children:["Billed annually ($",(C/12).toFixed(2),"/month)"]})]}),e.jsxs("div",{className:"space-y-3 min-w-0",children:[e.jsx(i,{onClick:async()=>{var e,s;if(N){k(!0);try{const{data:{session:e}}=await o.auth.getSession();if(!e)throw new Error("Authentication session not found");const{data:s,error:t}=await o.functions.invoke("create-checkout-session",{body:{planId:c.id,billingCycle:d,successUrl:`${window.location.origin}/app/user?payment=success`,cancelUrl:`${window.location.origin}/pricing?payment=cancelled`}});if(t)throw t;if(!(null==s?void 0:s.url))throw new Error("No checkout URL returned");window.location.href=s.url}catch(t){let a="An error occurred during checkout";(null==(e=t.message)?void 0:e.includes("not configured"))||(null==(s=t.message)?void 0:s.includes("STRIPE_SECRET_KEY"))?a="Payment system is not configured yet. Please contact support.":t.message&&(a=t.message),n({title:"Payment Failed",description:a,variant:"destructive"}),k(!1)}}else n({title:"Not Logged In",description:"Please log in to purchase a subscription",variant:"destructive"})},disabled:w,className:"w-full min-w-0 h-11 sm:h-12 text-base","aria-label":w?"Processing payment":"Complete purchase",children:w?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4 mr-2 animate-spin","aria-hidden":"true"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Complete Purchase"]})}),e.jsx(i,{onClick:()=>a(!1),disabled:w,variant:"outline",className:"w-full min-w-0 h-11 sm:h-12 text-base","aria-label":"Cancel checkout",children:"Cancel"})]}),e.jsxs("div",{className:"text-center text-xs text-text-secondary",role:"note",children:[e.jsx(b,{className:"w-3 h-3 inline mr-1","aria-hidden":"true"}),"Secure payment powered by Stripe"]})]})]})})},k=({logoUrl:l})=>{const x=t(),p=a(),{user:u}=r(),[h,y]=s.useState("monthly"),[f,g]=s.useState([]),[b,k]=s.useState(!0),[C,P]=s.useState(null),[F,S]=s.useState(null),[_,E]=s.useState(!1),A={Base:["âš ï¸ Ad-supported experience","2 AI meal plans per month","2 AI workout plans per month","10 AI chat messages per month","Basic progress tracking","Community access","Mobile app access","Smart meal logging"],Premium:["âœ¨ Ad-free experience","Unlimited AI meal plans","Unlimited AI workout plans","Unlimited AI chat support","Advanced progress analytics","Goal tracking & insights","Custom meal preferences","Wearable device sync","Weekly & monthly reports","Community access","Mobile app access"],Ultimate:["âœ¨ Everything in Premium","Access to certified nutritionists","Priority customer support","Video consultations (2/month)","Advanced meal planning tools","Custom workout builder","Performance optimization","Body composition analysis","Exclusive challenges"],Elite:["âœ¨ Everything in Ultimate","ðŸ“¸ Photo food recognition & logging","Unlimited video coaching","Doctor consultations (2/month)","Priority 24/7 support","Personalized supplement plan","VIP community access","Concierge service"]};s.useEffect(()=>{var e;(null==(e=p.state)?void 0:e.recommendedPlan)&&P(p.state.recommendedPlan)},[p.state]),s.useEffect(()=>{(async()=>{k(!0);const{data:e,error:s}=await o.from("subscription_plans").select("*").eq("is_active",!0).order("price_monthly",{ascending:!0});s?n({title:"Error fetching pricing",description:s.message,variant:"destructive"}):g(e),k(!1)})()},[]);const I=e=>{u?(S(e),E(!0)):x("/signup",{state:{selectedPlan:e.name}})};return e.jsxs(m,{logoUrl:l,pageTitle:e.jsxs(e.Fragment,{children:["Simple, Transparent ",e.jsx("span",{className:"gradient-text",children:"Pricing"})]}),pageDescription:"Choose the perfect plan to kickstart your health transformation. No hidden fees.",children:[e.jsxs(c,{children:[e.jsx("title",{children:"Pricing - GreenoFig"}),e.jsx("meta",{name:"description",content:"Explore GreenoFig's flexible pricing plans and find the perfect fit for your health and wellness journey."}),e.jsx("link",{rel:"canonical",href:"https://greenofig.com/pricing"}),e.jsx("meta",{property:"og:title",content:"Pricing - GreenoFig"}),e.jsx("meta",{property:"og:description",content:"Explore GreenoFig's flexible pricing plans and find the perfect fit for your health and wellness journey."}),e.jsx("meta",{property:"og:url",content:"https://greenofig.com/pricing"}),e.jsx("meta",{property:"og:type",content:"website"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"mb-12 flex items-center gap-2 glass-effect p-1 rounded-full",style:{backdropFilter:"blur(16px) saturate(180%)",WebkitBackdropFilter:"blur(16px) saturate(180%)"},children:[e.jsx(i,{onClick:()=>y("monthly"),variant:"monthly"===h?"default":"ghost",className:"rounded-full px-6",children:"Monthly"}),e.jsxs(i,{onClick:()=>y("yearly"),variant:"yearly"===h?"default":"ghost",className:"rounded-full px-6 relative",children:["Yearly",e.jsxs("span",{className:"absolute -top-2 -right-2 bg-destructive text-destructive-foreground text-xs font-bold px-2 py-0.5 rounded-full",children:["Save ",25,"%"]})]})]}),b?e.jsx("div",{className:"flex justify-center items-center h-96",children:e.jsx(j,{className:"w-12 h-12 animate-spin text-primary"})}):e.jsxs("div",{className:"w-full space-y-8",children:[f.filter(e=>0===e.price_monthly).map(s=>{const t=C===s.name;return e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:d("glass-effect p-6 rounded-xl border-2 relative max-w-2xl mx-auto",t?"border-primary ring-4 ring-primary/50":"border-primary/50"),style:{backdropFilter:"blur(24px) saturate(180%)",WebkitBackdropFilter:"blur(24px) saturate(180%)"},children:[t&&e.jsx("div",{className:"absolute top-0 -translate-y-1/2 left-1/2 -translate-x-1/2 px-3 py-1 text-xs font-semibold text-primary-foreground bg-green-500 rounded-full",children:"Recommended"}),e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h3",{className:"text-2xl font-bold mb-2",children:s.name}),e.jsx("p",{className:"text-text-secondary text-sm mb-4",children:s.description}),e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"text-4xl font-extrabold",children:"Free"}),e.jsx("p",{className:"text-text-secondary text-sm mt-1",children:"Forever"})]}),e.jsx(i,{onClick:()=>I(s),size:"default",className:"px-8",children:"Get Started Free"})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-3 mt-4",children:(A[s.name]||s.features||[]).map((s,t)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(N,{className:"w-4 h-4 text-primary flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm",children:s})]},t))})]},s.id)}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:f.filter(e=>e.price_monthly>0).map((s,t)=>{const a=C===s.name;return e.jsxs(v.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.5},transition:{duration:.6},className:d("glass-effect p-5 rounded-xl flex flex-col border-2 relative hover:shadow-xl hover:shadow-primary/10 transition-all duration-300",a?"border-primary ring-4 ring-primary/50":s.is_popular?"border-primary":"border-border"),style:{backdropFilter:"blur(20px) saturate(180%)",WebkitBackdropFilter:"blur(20px) saturate(180%)"},children:[a&&e.jsx("div",{className:"absolute top-0 -translate-y-1/2 left-1/2 -translate-x-1/2 px-3 py-1 text-xs font-semibold text-primary-foreground bg-green-500 rounded-full",children:"Recommended"}),!a&&s.is_popular&&e.jsx("div",{className:"absolute top-0 -translate-y-1/2 left-1/2 -translate-x-1/2 px-3 py-1 text-xs font-semibold text-primary-foreground bg-primary rounded-full",children:"Most Popular"}),e.jsx("h3",{className:"text-xl font-bold text-center mb-1",children:s.name}),e.jsx("p",{className:"text-text-secondary text-center text-sm min-h-[35px] mb-4",children:s.description}),e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-4xl font-extrabold",children:"monthly"===h?`$${s.price_monthly}`:`$${(s.price_yearly/12).toFixed(2)}`}),e.jsx("span",{className:"text-base font-medium text-text-secondary",children:"/month"}),"yearly"===h&&e.jsxs("p",{className:"text-xs text-text-secondary mt-1",children:["billed annually ($",s.price_yearly,"/year)"]})]}),e.jsx("div",{className:"flex-grow",children:e.jsx("ul",{className:"space-y-2",children:(A[s.name]||s.features||[]).map((s,t)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(N,{className:"w-4 h-4 text-primary flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm",children:s})]},t))})}),e.jsx(i,{onClick:()=>I(s),className:"w-full mt-5",variant:a||s.is_popular?"default":"outline",children:"Choose Plan"})]},s.id)})})]})]}),e.jsx(w,{open:_,onOpenChange:E,plan:F,billingCycle:h})]})};export{k as default};
