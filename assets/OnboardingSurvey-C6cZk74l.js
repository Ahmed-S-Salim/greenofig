var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,__defNormalProp=(s,t,i)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,__spreadValues=(e,s)=>{for(var t in s||(s={}))a.call(s,t)&&__defNormalProp(e,t,s[t]);if(i)for(var t of i(s))r.call(s,t)&&__defNormalProp(e,t,s[t]);return e},__spreadProps=(e,i)=>s(e,t(i));import{j as l}from"./vendor-ui-gkPPHEPH.js";import{u as n,a as c,L as d}from"./vendor-react-Dds8VpLH.js";import{u as o,B as m,H as x,t as h,s as u}from"./index-CKU5P2TY.js";import{D as p,b as g}from"./dialog-D_VtZS95.js";import{m as b,A as j,f as v,a as y,c as f,af as N,e as w,x as _,D as k,v as C,Z as z}from"./vendor-utils-CisQTPNT.js";import"./vendor-editor-DGqHsWbs.js";const OnboardingSurvey=({logoUrl:e,isOpen:s,setIsOpen:t,inline:i=!1})=>{const{user:a,userProfile:r,refreshUserProfile:F}=o(),P=n(),[S,G]=c.useState(1),[O,L]=c.useState(!1),[A,Y]=c.useState("metric"),[E,B]=c.useState({age:(null==r?void 0:r.age)||"",gender:(null==r?void 0:r.gender)||"",height_cm:(null==r?void 0:r.height_cm)||"",weight_kg:(null==r?void 0:r.weight_kg)||"",activity_level:(null==r?void 0:r.activity_level)||"",health_goals:(null==r?void 0:r.health_goals)||[]});c.useEffect(()=>{r&&B({age:r.age||"",gender:r.gender||"",height_cm:r.height_cm||"",weight_kg:r.weight_kg||"",activity_level:r.activity_level||"",health_goals:r.health_goals||[]})},[r]);const M=[{id:"sedentary",label:"Sedentary",description:"Little or no exercise"},{id:"lightly_active",label:"Lightly Active",description:"Light exercise/sports 1-3 days/week"},{id:"moderately_active",label:"Moderately Active",description:"Moderate exercise/sports 3-5 days/week"},{id:"very_active",label:"Very Active",description:"Hard exercise/sports 6-7 days a week"},{id:"super_active",label:"Super Active",description:"Very hard exercise & physical job"}],H=[{id:"lose_weight",label:"Lose Weight",icon:_},{id:"build_muscle",label:"Build Muscle",icon:k},{id:"improve_endurance",label:"Improve Endurance",icon:C},{id:"eat_healthier",label:"Eat Healthier",icon:C},{id:"increase_energy",label:"Increase Energy",icon:z}],handleInputChange=e=>{const{name:s,value:t}=e.target;B(e=>__spreadProps(__spreadValues({},e),{[s]:t}))},handleHeightChange=e=>{const s=e.target.value;if("metric"===A)B(e=>__spreadProps(__spreadValues({},e),{height_cm:s}));else{const e=(2.54*s).toFixed(1);B(s=>__spreadProps(__spreadValues({},s),{height_cm:e}))}},handleWeightChange=e=>{const s=e.target.value;if("metric"===A)B(e=>__spreadProps(__spreadValues({},e),{weight_kg:s}));else{const e=(s/2.20462).toFixed(1);B(s=>__spreadProps(__spreadValues({},s),{weight_kg:e}))}},nextStep=()=>{S<4&&G(e=>e+1)},prevStep=()=>{S>1&&G(e=>e-1)},handleSubmit=()=>{return e=null,s=null,t=function*(){if(!a)return h({title:"Sign Up Required",description:"Please sign up to save your personalized profile"}),void P("/signup");L(!0);try{const{error:e}=yield u.from("user_profiles").update(E).eq("id",a.id);if(e)throw console.error("Error updating profile:",e),e;yield F(),h({title:"Success! ðŸŽ‰",description:"Your profile has been updated successfully"}),L(!1),G(e=>e+1)}catch(e){console.error("Submit error:",e),L(!1),h({title:"Error updating profile",description:e.message||"Something went wrong. Please try again.",variant:"destructive"})}},new Promise((i,a)=>{var fulfilled=e=>{try{step(t.next(e))}catch(s){a(s)}},rejected=e=>{try{step(t.throw(e))}catch(s){a(s)}},step=e=>e.done?i(e.value):Promise.resolve(e.value).then(fulfilled,rejected);step((t=t.apply(e,s)).next())});var e,s,t},finishOnboarding=()=>{i?G(1):(t&&(t(!1),G(1)),P("/app",{replace:!0}))},handleClose=()=>{t&&(t(!1),G(1))},renderStep=()=>{switch(S){case 1:return l.jsxs(b.div,{className:"space-y-3",children:[l.jsx("h2",{className:"text-lg font-bold",children:"About You"}),l.jsxs("div",{className:"space-y-2.5",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1",children:"Age"}),l.jsx("input",{type:"number",name:"age",value:E.age,onChange:handleInputChange,className:"w-full bg-background border border-border rounded-md p-2 text-sm",placeholder:"e.g., 28"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1",children:"Gender"}),l.jsxs("select",{name:"gender",value:E.gender,onChange:handleInputChange,className:"w-full bg-background border border-border rounded-md p-2 text-sm",children:[l.jsx("option",{value:"",children:"Select gender"}),l.jsx("option",{value:"male",children:"Male"}),l.jsx("option",{value:"female",children:"Female"}),l.jsx("option",{value:"other",children:"Other"}),l.jsx("option",{value:"prefer_not_to_say",children:"Prefer not to say"})]})]})]})]},"step1");case 2:return l.jsxs(b.div,{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h2",{className:"text-lg font-bold",children:"Your Body Metrics"}),l.jsxs("div",{className:"flex gap-1 bg-muted rounded-md p-0.5",children:[l.jsx("button",{onClick:()=>Y("metric"),className:"px-2 py-1 text-xs rounded-md transition-colors "+("metric"===A?"bg-primary text-primary-foreground":"text-muted-foreground"),children:"Metric"}),l.jsx("button",{onClick:()=>Y("imperial"),className:"px-2 py-1 text-xs rounded-md transition-colors "+("imperial"===A?"bg-primary text-primary-foreground":"text-muted-foreground"),children:"Imperial"})]})]}),l.jsxs("div",{className:"space-y-2.5",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-xs font-medium text-text-secondary mb-1",children:["Height ","metric"===A?"(cm)":"(inches)"]}),l.jsx("input",{type:"number",value:E.height_cm?"metric"===A?E.height_cm:(E.height_cm/2.54).toFixed(1):"",onChange:handleHeightChange,className:"w-full bg-background border border-border rounded-md p-2 text-sm",placeholder:"metric"===A?"e.g., 175":"e.g., 69",step:"0.1"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-xs font-medium text-text-secondary mb-1",children:["Weight ","metric"===A?"(kg)":"(lbs)"]}),l.jsx("input",{type:"number",value:E.weight_kg?"metric"===A?E.weight_kg:(2.20462*E.weight_kg).toFixed(1):"",onChange:handleWeightChange,className:"w-full bg-background border border-border rounded-md p-2 text-sm",placeholder:"metric"===A?"e.g., 70":"e.g., 154",step:"0.1"})]})]})]},"step2");case 3:return l.jsxs(b.div,{className:"space-y-3",children:[l.jsx("h2",{className:"text-lg font-bold",children:"Your Lifestyle"}),l.jsxs("div",{className:"space-y-1.5",children:[l.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1",children:"Activity Level"}),M.map(e=>l.jsxs("button",{onClick:()=>B(s=>__spreadProps(__spreadValues({},s),{activity_level:e.id})),className:"w-full text-left p-2 rounded-md border-2 transition-all "+(E.activity_level===e.id?"border-primary bg-primary/10":"border-border hover:border-primary/50"),children:[l.jsx("p",{className:"text-xs font-semibold",children:e.label}),l.jsx("p",{className:"text-xs text-text-secondary",children:e.description})]},e.id))]})]},"step3");case 4:return l.jsxs(b.div,{className:"space-y-3",children:[l.jsx("h2",{className:"text-lg font-bold",children:"Your Goals"}),l.jsx("p",{className:"text-xs text-text-secondary",children:"Select your primary health and fitness goals. You can select multiple."}),l.jsx("div",{className:"grid grid-cols-2 gap-2",children:H.map(e=>{const s=e.icon;return l.jsxs("button",{onClick:()=>{return s=e.id,void B(e=>{const t=e.health_goals.includes(s)?e.health_goals.filter(e=>e!==s):[...e.health_goals,s];return __spreadProps(__spreadValues({},e),{health_goals:t})});var s},className:"flex flex-col items-center justify-center p-2 aspect-square rounded-md border-2 transition-all "+(E.health_goals.includes(e.id)?"border-primary bg-primary/10":"border-border hover:border-primary/50"),children:[l.jsx(s,{className:"w-5 h-5 mb-1 text-primary"}),l.jsx("span",{className:"text-xs font-semibold text-center",children:e.label})]},e.id)})})]},"step4");case 5:return l.jsxs(b.div,{className:"text-center flex flex-col items-center py-3",children:[l.jsx(w,{className:"w-12 h-12 text-green-500 mb-3"}),l.jsx("h2",{className:"text-lg font-bold",children:"Setup Complete!"}),l.jsx("p",{className:"text-xs text-text-secondary mt-1.5 mb-4",children:"Your profile is personalized. Get ready to start your wellness journey."}),l.jsx(m,{onClick:finishOnboarding,size:"sm",children:"Go to Dashboard"})]},"step5");default:return null}};if(i){const s=a&&r;return l.jsx("div",{className:"w-full max-w-4xl mx-auto",children:l.jsxs("div",{className:"glass-effect rounded-lg p-4 shadow-lg border border-border",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[l.jsx("img",{src:e,alt:"GreenoFig Logo",className:"w-8 h-8"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h2",{className:"text-sm font-bold gradient-text",children:s?"Complete Your Profile":"Get Personalized Health Guidance"}),l.jsx("p",{className:"text-xs text-text-secondary",children:s?"Personalize your GreenoFig experience":"Sign up to create your custom health plan"})]}),!s&&l.jsx(m,{size:"sm",onClick:()=>P("/signup"),className:"bg-primary text-primary-foreground text-xs px-3 py-1 h-auto",children:"Sign Up"})]}),l.jsx("div",{className:"mb-3",children:l.jsx("div",{className:"w-full bg-muted rounded-full h-1.5",children:l.jsx(b.div,{className:"bg-primary h-1.5 rounded-full",initial:{width:"0%"},animate:{width:(S-1)/4*100+"%"}})})}),l.jsx(j,{mode:"wait",children:l.jsx(b.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:renderStep()},S)}),S<=4&&l.jsxs("div",{className:"flex justify-between items-center mt-4",children:[l.jsxs(m,{variant:"outline",size:"sm",onClick:prevStep,disabled:1===S||O,className:"text-xs",children:[l.jsx(v,{className:"w-3 h-3 mr-1"})," Back"]}),S<4?l.jsxs(m,{size:"sm",onClick:nextStep,className:"text-xs",children:["Next ",l.jsx(y,{className:"w-3 h-3 ml-1"})]}):l.jsxs(m,{size:"sm",onClick:handleSubmit,disabled:O,className:"text-xs",children:[O&&l.jsx(f,{className:"w-3 h-3 mr-1 animate-spin"}),"Finish"]})]})]})})}return void 0!==s&&t?l.jsx(p,{open:s,onOpenChange:t,children:l.jsx(g,{className:"max-w-md max-h-[90vh] overflow-y-auto p-0",children:l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("img",{src:e,alt:"GreenoFig Logo",className:"w-8 h-8"}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-base font-bold gradient-text",children:"Welcome to GreenoFig"}),l.jsx("p",{className:"text-xs text-text-secondary",children:"Let's personalize your experience."})]})]}),l.jsx(m,{variant:"ghost",size:"icon",onClick:handleClose,className:"h-8 w-8",children:l.jsx(N,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"glass-effect rounded-lg p-3 sm:p-4",children:[l.jsx("div",{className:"mb-3",children:S<=4&&l.jsx("div",{className:"w-full bg-muted rounded-full h-1.5",children:l.jsx(b.div,{className:"bg-primary h-1.5 rounded-full",initial:{width:"0%"},animate:{width:(S-1)/4*100+"%"}})})}),l.jsx(j,{mode:"wait",children:l.jsx(b.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},children:renderStep()},S)}),S<=4&&l.jsxs("div",{className:"flex justify-between items-center mt-4",children:[l.jsxs(m,{variant:"outline",size:"sm",onClick:prevStep,disabled:1===S||O,className:"text-xs",children:[l.jsx(v,{className:"w-3 h-3 mr-1"})," Back"]}),S<4?l.jsxs(m,{size:"sm",onClick:nextStep,className:"text-xs",children:["Next ",l.jsx(y,{className:"w-3 h-3 ml-1"})]}):l.jsxs(m,{size:"sm",onClick:handleSubmit,disabled:O,className:"text-xs",children:[O&&l.jsx(f,{className:"w-3 h-3 mr-1 animate-spin"}),"Finish"]})]})]})]})})}):l.jsxs(l.Fragment,{children:[l.jsxs(x,{children:[l.jsx("title",{children:"Onboarding - GreenoFig"}),l.jsx("meta",{name:"description",content:"Personalize your GreenoFig experience."})]}),l.jsx("div",{className:"flex flex-col items-center py-8 px-3 sm:px-4 bg-background text-foreground",children:l.jsxs("div",{className:"w-full max-w-md",children:[l.jsxs("div",{className:"text-center mb-3",children:[l.jsx(d,{to:"/home",className:"inline-block mb-1.5",children:l.jsx("img",{src:e,alt:"GreenoFig Logo",className:"w-10 h-10"})}),l.jsx("h1",{className:"text-xl font-bold gradient-text",children:"Welcome to GreenoFig"}),l.jsx("p",{className:"text-xs text-text-secondary",children:"Let's personalize your experience."})]}),l.jsxs("div",{className:"glass-effect rounded-lg p-3 sm:p-4 shadow-xl",children:[l.jsx("div",{className:"mb-3",children:S<=4&&l.jsx("div",{className:"w-full bg-muted rounded-full h-1.5",children:l.jsx(b.div,{className:"bg-primary h-1.5 rounded-full",initial:{width:"0%"},animate:{width:(S-1)/4*100+"%"}})})}),l.jsx(j,{mode:"wait",children:l.jsx(b.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},children:renderStep()},S)}),S<=4&&l.jsxs("div",{className:"flex justify-between items-center mt-4",children:[l.jsxs(m,{variant:"outline",size:"sm",onClick:prevStep,disabled:1===S||O,className:"text-xs",children:[l.jsx(v,{className:"w-3 h-3 mr-1"})," Back"]}),S<4?l.jsxs(m,{size:"sm",onClick:nextStep,className:"text-xs",children:["Next ",l.jsx(y,{className:"w-3 h-3 ml-1"})]}):l.jsxs(m,{size:"sm",onClick:handleSubmit,disabled:O,className:"text-xs",children:[O&&l.jsx(f,{className:"w-3 h-3 mr-1 animate-spin"}),"Finish"]})]})]})]})})]})};export{OnboardingSurvey as default};
