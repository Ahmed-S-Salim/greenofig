import{j as e}from"./vendor-ui-fc6158c5.js";import{r as s}from"./vendor-react-c35372bd.js";import{u as t,B as a,T as r,s as i,t as l,a as c}from"./index-05318a06.js";import{C as n,a as d,b as o,e as m,c as u}from"./card-aef3fa8a.js";import{I as x}from"./input-a2afde68.js";import{S as h,a as j,b as p,c as b,d as g}from"./select-74e79011.js";import{T as f,a as y,b as v,c as N}from"./tabs-9cefe97b.js";import{m as w,w as k,bC as S,bD as C,M as T,L as D,e as _,k as M,bd as q,x as F,a8 as P,r as I,b6 as E}from"./vendor-utils-1c344488.js";import"./vendor-editor-c22fa4d3.js";const L=()=>{const{userProfile:L}=t(),[H,V]=s.useState(!1),[W,A]=s.useState([]),[G,U]=s.useState([]),[Y,B]=s.useState(!0),[Q,$]=s.useState(""),[z,O]=s.useState(""),[R,J]=s.useState(""),[K,X]=s.useState("medium"),[Z,ee]=s.useState(0),[se,te]=s.useState("suggestion"),[ae,re]=s.useState(""),ie=async()=>{if(!(null==L?void 0:L.id))return;B(!0);const{data:e,error:s}=await i.from("issues").select("*").eq("user_id",L.id).order("created_at",{ascending:!1});s||U(e||[]),B(!1)};s.useEffect(()=>{(null==L?void 0:L.id)&&((async()=>{const{data:e}=await i.from("issue_categories").select("*").eq("is_active",!0).order("display_order");e&&A(e)})(),ie())},[null==L?void 0:L.id]);const le=s=>{switch(s){case"open":return e.jsxs(c,{className:"bg-blue-500/20 text-blue-300 border-blue-500/30",children:[e.jsx(I,{className:"w-3 h-3 mr-1"}),"Open"]});case"in_progress":return e.jsxs(c,{className:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30",children:[e.jsx(P,{className:"w-3 h-3 mr-1"}),"In Progress"]});case"resolved":return e.jsxs(c,{className:"bg-green-500/20 text-green-400 border-green-500/30",children:[e.jsx(F,{className:"w-3 h-3 mr-1"}),"Resolved"]});case"closed":return e.jsx(c,{variant:"outline",children:"Closed"});default:return e.jsx(c,{children:s})}},ce=s=>{switch(s){case"urgent":return e.jsxs(c,{className:"bg-red-500/20 text-red-300 border-red-500/30",children:[e.jsx(E,{className:"w-3 h-3 mr-1"}),"Urgent"]});case"high":return e.jsxs(c,{className:"bg-orange-500/20 text-orange-300 border-orange-500/30",children:[e.jsx(E,{className:"w-3 h-3 mr-1"}),"High"]});case"medium":return e.jsx(c,{className:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30",children:"Medium"});case"low":return e.jsx(c,{className:"bg-gray-500/20 text-gray-300 border-gray-500/30",children:"Low"});default:return e.jsx(c,{children:s})}};return e.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[e.jsxs(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Support Center"}),e.jsx("p",{className:"text-text-secondary",children:"Need help? Submit a ticket and our team will assist you."})]}),e.jsxs(f,{defaultValue:"feedback",className:"w-full",children:[e.jsxs(y,{className:"grid w-full grid-cols-3",children:[e.jsx(v,{value:"feedback",children:"Quick Feedback"}),e.jsx(v,{value:"create",children:"Create Ticket"}),e.jsxs(v,{value:"mytickets",children:["My Tickets (",G.length,")"]})]}),e.jsx(N,{value:"feedback",children:e.jsxs(n,{className:"glass-effect",children:[e.jsxs(d,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-6 h-6 text-yellow-500"}),"Quick Feedback"]}),e.jsx(m,{children:"Share your thoughts, suggestions, or report issues quickly"})]}),e.jsx(u,{children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!ae.trim())return void l({title:"Missing Information",description:"Please provide your feedback",variant:"destructive"});V(!0);const s=`${"suggestion"===se?"💡 Suggestion":"complaint"===se?"⚠️ Complaint":"⭐ Praise"} - ${Z} stars`,{error:t}=await i.from("issues").insert({user_id:L.id,subject:s,description:ae.trim(),category:"feedback",priority:"complaint"===se?"high":"low",status:"open"});t?l({title:"Error Submitting Feedback",description:t.message,variant:"destructive"}):(l({title:"Feedback Submitted! 🎉",description:"Thank you! A conversation has been created with our team. Check Messages for any follow-up."}),ee(0),te("suggestion"),re(""),ie()),V(!1)},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-3",children:"How would you rate your experience?"}),e.jsx("div",{className:"flex gap-2 justify-center py-4",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>ee(s),className:"transition-all transform hover:scale-110",children:e.jsx(k,{className:"w-10 h-10 "+(s<=Z?"fill-yellow-500 text-yellow-500":"text-gray-400")})},s))}),Z>0&&e.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:[5===Z&&"🎉 Excellent!",4===Z&&"😊 Great!",3===Z&&"👍 Good",2===Z&&"😐 Could be better",1===Z&&"😞 Needs improvement"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"What type of feedback is this?"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs(a,{type:"button",variant:"suggestion"===se?"default":"outline",onClick:()=>te("suggestion"),className:"h-auto py-4 flex flex-col items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5"}),e.jsx("span",{children:"Suggestion"})]}),e.jsxs(a,{type:"button",variant:"complaint"===se?"default":"outline",onClick:()=>te("complaint"),className:"h-auto py-4 flex flex-col items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5"}),e.jsx("span",{children:"Issue"})]}),e.jsxs(a,{type:"button",variant:"praise"===se?"default":"outline",onClick:()=>te("praise"),className:"h-auto py-4 flex flex-col items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5"}),e.jsx("span",{children:"Praise"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Tell us more ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx(r,{placeholder:"suggestion"===se?"What feature or improvement would you like to see?":"complaint"===se?"What issue did you encounter? Please provide details...":"What did you love about your experience?",value:ae,onChange:e=>re(e.target.value),rows:6,required:!0})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(T,{className:"w-5 h-5 text-blue-400 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-blue-300 mb-1",children:"Direct conversation with our team"}),e.jsx("p",{className:"text-blue-200/70",children:"Your feedback will create a conversation with our support team. You'll be able to chat with them in the Messages section."})]})]}),e.jsx(a,{type:"submit",className:"w-full",disabled:H||!ae.trim(),children:H?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2 animate-spin"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Send Feedback"]})})]})})]})}),e.jsx(N,{value:"create",children:e.jsxs(n,{className:"glass-effect",children:[e.jsxs(d,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-6 h-6"}),"Submit a Support Ticket"]}),e.jsx(m,{children:"Describe your issue and we'll get back to you within 24 hours"})]}),e.jsx(u,{children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!Q.trim()||!z.trim()||!R)return void l({title:"Missing Information",description:"Please fill in all required fields",variant:"destructive"});V(!0);const{error:s}=await i.from("issues").insert({user_id:L.id,subject:Q.trim(),description:z.trim(),category:R,priority:K,status:"open"});s?l({title:"Error Creating Ticket",description:s.message,variant:"destructive"}):(l({title:"Support Ticket Created!",description:"A conversation has been started with our support team. Check the Messages page for updates."}),$(""),O(""),J(""),X("medium"),ie()),V(!1)},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Subject ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx(x,{type:"text",placeholder:"Brief description of your issue",value:Q,onChange:e=>$(e.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Category ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs(h,{value:R,onValueChange:J,required:!0,children:[e.jsx(j,{children:e.jsx(p,{placeholder:"Select a category"})}),e.jsx(b,{children:W.map(s=>e.jsxs(g,{value:s.slug,children:[s.name," - ",s.description]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Priority"}),e.jsxs(h,{value:K,onValueChange:X,children:[e.jsx(j,{children:e.jsx(p,{})}),e.jsxs(b,{children:[e.jsx(g,{value:"low",children:"Low - General inquiry"}),e.jsx(g,{value:"medium",children:"Medium - Standard issue"}),e.jsx(g,{value:"high",children:"High - Affects my work"}),e.jsx(g,{value:"urgent",children:"Urgent - Critical issue"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Description ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx(r,{placeholder:"Please provide as much detail as possible about your issue...",value:z,onChange:e=>O(e.target.value),rows:8,required:!0}),e.jsx("p",{className:"text-xs text-text-secondary mt-2",children:"Include steps to reproduce the issue, error messages, or screenshots if applicable"})]}),e.jsx(a,{type:"submit",className:"w-full",disabled:H,children:H?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2 animate-spin"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Submit Ticket"]})})]})})]})}),e.jsx(N,{value:"mytickets",children:e.jsxs(n,{className:"glass-effect",children:[e.jsxs(d,{children:[e.jsx(o,{children:"My Support Tickets"}),e.jsx(m,{children:"View and track your submitted support tickets"})]}),e.jsx(u,{children:Y?e.jsx("div",{className:"flex justify-center items-center py-10",children:e.jsx(D,{className:"h-8 w-8 animate-spin text-primary"})}):0===G.length?e.jsxs("div",{className:"text-center py-10",children:[e.jsx(q,{className:"w-16 h-16 mx-auto text-text-secondary opacity-50 mb-4"}),e.jsx("p",{className:"text-text-secondary",children:"You haven't submitted any tickets yet"})]}):e.jsx("div",{className:"space-y-4",children:G.map(s=>e.jsxs(w.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-4 rounded-lg glass-effect border border-white/10 hover:border-primary/30 transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg mb-1",children:s.subject}),e.jsx("p",{className:"text-sm text-text-secondary line-clamp-2",children:s.description})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[le(s.status),ce(s.priority)]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-text-secondary",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:["Ticket #",s.id.slice(0,8)]}),s.category&&e.jsxs("span",{className:"capitalize",children:["Category: ",s.category.replace("_"," ")]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:["Created: ",new Date(s.created_at).toLocaleDateString()]}),e.jsxs("span",{children:["Updated: ",new Date(s.updated_at).toLocaleDateString()]})]})]}),"resolved"===s.status&&e.jsx("div",{className:"mt-3 pt-3 border-t border-white/10",children:e.jsx("p",{className:"text-sm text-green-400",children:"✓ This issue has been resolved. If you need further assistance, please create a new ticket."})})]},s.id))})})]})})]})]})};export{L as default};
