var e=Object.defineProperty,s=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,__defNormalProp=(s,t,a)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,__async=(e,s,t)=>new Promise((a,r)=>{var fulfilled=e=>{try{step(t.next(e))}catch(s){r(s)}},rejected=e=>{try{step(t.throw(e))}catch(s){r(s)}},step=e=>e.done?a(e.value):Promise.resolve(e.value).then(fulfilled,rejected);step((t=t.apply(e,s)).next())});import{j as r}from"./vendor-ui-gkPPHEPH.js";import{a as l,e as n,u as i}from"./vendor-react-Dds8VpLH.js";import{B as c,e as o,t as d,u as h,T as m,s as x}from"./index-CKU5P2TY.js";import{I as u}from"./input-EoRmzMlo.js";import{C as g,a as p,b as j,c as f}from"./card-Pj_OUEuM.js";import{L as v}from"./label-qLSsZ5R6.js";import{S as y}from"./switch-oXOcT0uw.js";import{T as b,a as w,b as N,c as S}from"./tabs-rmIyZk1l.js";import{S as k,a as C,b as E,c as O,d as _}from"./select-BoESt1cj.js";import{u as T,i as z,a as P,b as I,c as A,d as L,E as B}from"./vendor-editor-DGqHsWbs.js";import{ap as R,aq as q,ar as H,as as D,at as F,au as G,av as U,aw as M,ax as K,ay as W,az as Y,aA as J,aB as $,aC as V,ak as Z,aD as Q,q as X,U as ee,c as se,h as te,ah as ae,u as re,aE as le,e as ne,m as ie,f as ce,o as oe,l as de,af as he,b as me,g as xe,ao as ue,am as ge,a5 as pe}from"./vendor-utils-CisQTPNT.js";const MenuBar=({editor:e})=>{if(!e)return null;return r.jsxs("div",{className:"border-b border-white/10 p-2 flex flex-wrap gap-1",children:[r.jsx(c,{type:"button",variant:"ghost",size:"sm",onClick:()=>e.chain().focus().toggleBold().run(),className:e.isActive("bold")?"bg-white/10":"",children:r.jsx(R,{className:"w-4 h-4"})}),r.jsx(c,{type:"button",variant:"ghost",size:"sm",onClick:()=>e.chain().focus().toggleItalic().run(),className:e.isActive("italic")?"bg-white/10":"",children:r.jsx(q,{className:"w-4 h-4"})}),r.jsx(c,{type:"button",variant:"ghost",size:"sm",onClick:()=>e.chain().focus().toggleHeading({level:1}).run(),className:e.isActive("heading",{level:1})?"bg-white/10":"",children:r.jsx(H,{className:"w-4 h-4"})}),r.jsx(c,{type:"button",variant:"ghost",size:"sm",onClick:()=>e.chain().focus().toggleHeading({level:2}).run(),className:e.isActive("heading",{level:2})?"bg-white/10":"",children:r.jsx(D,{className:"w-4 h-4"})}),r.jsx(c,{type:"button",variant:"ghost",size:"sm",onClick:()=>e.chain().focus().toggleHeading({level:3}).run(),className:e.isActive("heading",{level:3})?"bg-white/10":"",children:r.jsx(F,{className:"w-4 h-4"})}),r.jsx(c,{type:"button",variant:"ghost",size:"sm",onClick:()=>e.chain().focus().toggleBulletList().run(),className:e.isActive("bulletList")?"bg-white/10":"",children:r.jsx(G,{className:"w-4 h-4"})}),r.jsx(c,{type:"button",variant:"ghost",size:"sm",onClick:()=>e.chain().focus().toggleOrderedList().run(),className:e.isActive("orderedList")?"bg-white/10":"",children:r.jsx(U,{className:"w-4 h-4"})}),r.jsx(c,{type:"button",variant:"ghost",size:"sm",onClick:()=>e.chain().focus().toggleBlockquote().run(),className:e.isActive("blockquote")?"bg-white/10":"",children:r.jsx(M,{className:"w-4 h-4"})}),r.jsx(c,{type:"button",variant:"ghost",size:"sm",onClick:()=>e.chain().focus().toggleCodeBlock().run(),className:e.isActive("codeBlock")?"bg-white/10":"",children:r.jsx(K,{className:"w-4 h-4"})}),r.jsx(c,{type:"button",variant:"ghost",size:"sm",onClick:()=>{const s=window.prompt("Enter URL:");s&&e.chain().focus().setLink({href:s}).run()},className:e.isActive("link")?"bg-white/10":"",children:r.jsx(W,{className:"w-4 h-4"})}),r.jsx(c,{type:"button",variant:"ghost",size:"sm",onClick:()=>{const s=window.prompt("Enter image URL:");s&&e.chain().focus().setImage({src:s}).run()},children:r.jsx(Y,{className:"w-4 h-4"})}),r.jsx(c,{type:"button",variant:"ghost",size:"sm",onClick:()=>e.chain().focus().setHorizontalRule().run(),children:r.jsx(J,{className:"w-4 h-4"})}),r.jsx("div",{className:"flex-1"}),r.jsx(c,{type:"button",variant:"ghost",size:"sm",onClick:()=>e.chain().focus().undo().run(),disabled:!e.can().undo(),children:r.jsx($,{className:"w-4 h-4"})}),r.jsx(c,{type:"button",variant:"ghost",size:"sm",onClick:()=>e.chain().focus().redo().run(),disabled:!e.can().redo(),children:r.jsx(V,{className:"w-4 h-4"})})]})},RichTextEditor=({content:e,onChange:s,placeholder:t="Write your content here..."})=>{const a=T({extensions:[z,P.configure({openOnClick:!1,HTMLAttributes:{class:"text-primary underline"}}),I.configure({HTMLAttributes:{class:"max-w-full h-auto rounded-lg"}}),A.configure({placeholder:t}),L],content:e,onUpdate:({editor:e})=>{s(e.getHTML())},editorProps:{attributes:{class:"prose prose-invert max-w-none min-h-[400px] p-4 focus:outline-none"}}});return r.jsxs("div",{className:"border border-white/10 rounded-lg bg-background/50",children:[r.jsx(MenuBar,{editor:a}),r.jsx(B,{editor:a}),a&&r.jsxs("div",{className:"border-t border-white/10 px-4 py-2 text-xs text-text-secondary flex justify-between",children:[r.jsxs("span",{children:[a.storage.characterCount.characters()," characters"]}),r.jsxs("span",{children:[a.storage.characterCount.words()," words"]})]})]})},SEOPreview=({title:e,metaDescription:s,slug:t,excerpt:a})=>{const l=e||"Your Blog Post Title",n=s||a||"Your blog post description will appear here...",i=`greenofig.com/blog/${t||"your-post-slug"}`,c=l.length>60?l.substring(0,57)+"...":l,o=n.length>160?n.substring(0,157)+"...":n;return r.jsxs(g,{className:"glass-effect",children:[r.jsx(p,{children:r.jsxs(j,{className:"flex items-center gap-2 text-lg",children:[r.jsx(Z,{className:"w-5 h-5"}),"SEO Preview"]})}),r.jsxs(f,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsxs("p",{className:"text-xs text-text-secondary mb-2 flex items-center gap-1",children:[r.jsx(Q,{className:"w-3 h-3"}),"Google Search Result"]}),r.jsxs("div",{className:"bg-background/50 p-4 rounded-lg border border-white/10",children:[r.jsx("div",{className:"text-sm text-blue-400 mb-1",children:i}),r.jsx("div",{className:"text-xl text-blue-500 hover:underline cursor-pointer mb-2",children:c}),r.jsx("div",{className:"text-sm text-text-secondary leading-relaxed",children:o})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-text-secondary",children:"Title: "}),r.jsxs("span",{className:l.length>60?"text-red-400":"text-green-400",children:[l.length,"/60"]})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-text-secondary",children:"Description: "}),r.jsxs("span",{className:n.length>160?"text-red-400":"text-green-400",children:[n.length,"/160"]})]})]}),r.jsxs("div",{className:"text-xs text-text-secondary space-y-1",children:[l.length>60&&r.jsx("p",{className:"text-yellow-400",children:"âš  Title is too long (max 60 characters)"}),n.length>160&&r.jsx("p",{className:"text-yellow-400",children:"âš  Description is too long (max 160 characters)"}),l.length<30&&e&&r.jsx("p",{className:"text-yellow-400",children:"âš  Title might be too short (recommended 30-60 characters)"}),n.length<120&&s&&r.jsx("p",{className:"text-yellow-400",children:"âš  Description might be too short (recommended 120-160 characters)"})]})]})]})},je=l.forwardRef((e,l)=>{var n=e,{className:i,orientation:c="horizontal"}=n,o=((e,r)=>{var l={};for(var n in e)t.call(e,n)&&r.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&s)for(var n of s(e))r.indexOf(n)<0&&a.call(e,n)&&(l[n]=e[n]);return l})(n,["className","orientation"]);return r.jsx("div",((e,r)=>{for(var l in r||(r={}))t.call(r,l)&&__defNormalProp(e,l,r[l]);if(s)for(var l of s(r))a.call(r,l)&&__defNormalProp(e,l,r[l]);return e})({ref:l,className:`shrink-0 bg-border ${"horizontal"===c?"h-[1px] w-full":"h-full w-[1px]"} ${i||""}`},o))});je.displayName="Separator";const AIBlogAssistant=({onContentGenerated:e,onSEOGenerated:s})=>{const[t,a]=l.useState([{role:"assistant",content:"Hi! I'm your AI blog writing assistant. Tell me what topic you'd like to write about, and I'll help you create amazing content for your health and wellness blog!"}]),[n,i]=l.useState(""),[h,m]=l.useState(!1),[x,v]=l.useState(""),[y,b]=l.useState(null),w=l.useRef(null);l.useEffect(()=>{var e;null==(e=w.current)||e.scrollIntoView({behavior:"smooth"})},[t]);const handleSendMessage=()=>__async(null,null,function*(){if(!n.trim()||h)return;const e=n.trim();i(""),a(s=>[...s,{role:"user",content:e}]);if(e.toLowerCase().includes("write")||e.toLowerCase().includes("create")||e.toLowerCase().includes("blog about")||1===t.length){m(!0),a(e=>[...e,{role:"assistant",content:"âœ¨ Generating your blog post... This may take a minute."}]);try{const s=yield(r=e,__async(null,null,function*(){try{const e=yield fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=AIzaSyBUH3HZjwbIzMqrk-RfxqqK5iU9TRiRrw0",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:`Write a comprehensive, engaging blog post about "${r}" for a health and wellness website called GreenoFig. The blog should be:\n\n- Professional yet conversational\n- 1500-2000 words\n- Well-structured with clear headings (use HTML tags: h2, h3)\n- Include actionable tips and advice\n- Use bullet points and lists where appropriate\n- Include a compelling introduction and conclusion\n- SEO-friendly\n- Written in HTML format\n\nWrite only the blog content, starting with an h2 heading. Do not include a title or meta information.`}]}],generationConfig:{temperature:.7,maxOutputTokens:4096}})}),s=yield e.json();if(s.candidates&&s.candidates[0])return s.candidates[0].content.parts[0].text;throw new Error("No content generated")}catch(e){throw console.error("Gemini API error:",e),e}}));v(s),a(e=>{const s=[...e];return s[s.length-1]={role:"assistant",content:"âœ… I've generated a comprehensive blog post for you! You can preview it below and copy it to the editor.\n\nWould you like me to generate SEO elements (title, meta description, keywords) as well?"},s})}catch(l){a(e=>{const s=[...e];return s[s.length-1]={role:"assistant",content:"âŒ Sorry, I encountered an error generating the blog. Please try again or rephrase your request."},s}),d({title:"Error",description:"Failed to generate blog content",variant:"destructive"})}finally{m(!1)}}else if(e.toLowerCase().includes("seo")||e.toLowerCase().includes("yes"))if(x){m(!0),a(e=>[...e,{role:"assistant",content:"ðŸ” Generating SEO elements..."}]);try{const e=yield(s=x,__async(null,null,function*(){try{const e=yield fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=AIzaSyBUH3HZjwbIzMqrk-RfxqqK5iU9TRiRrw0",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:`Based on this blog content, generate SEO elements in JSON format:\n\nBlog Content:\n${s.substring(0,1e3)}...\n\nGenerate a JSON object with these fields:\n{\n  "title": "Compelling blog title (50-60 characters)",\n  "metaTitle": "SEO-optimized meta title (50-60 characters)",\n  "metaDescription": "Engaging meta description (150-160 characters)",\n  "slug": "url-friendly-slug",\n  "excerpt": "Brief excerpt (150-200 characters)",\n  "focusKeyword": "main keyword phrase",\n  "keywords": ["keyword1", "keyword2", "keyword3", "keyword4", "keyword5"]\n}\n\nReturn ONLY the JSON object, no other text.`}]}],generationConfig:{temperature:.5,maxOutputTokens:500}})}),t=yield e.json();if(t.candidates&&t.candidates[0]){const e=t.candidates[0].content.parts[0].text,s=e.match(/```json\n([\s\S]*?)\n```/)||e.match(/\{[\s\S]*\}/);return s?JSON.parse(s[1]||s[0]):JSON.parse(e)}throw new Error("No SEO data generated")}catch(l){throw console.error("SEO generation error:",l),l}}));b(e),a(e=>{const s=[...e];return s[s.length-1]={role:"assistant",content:"âœ… SEO elements generated! Check the preview below to see how it will look on Google.\n\nYou can now copy everything to your blog editor!"},s})}catch(l){a(e=>{const s=[...e];return s[s.length-1]={role:"assistant",content:"âŒ Sorry, I had trouble generating SEO elements. You can create them manually in the editor."},s})}finally{m(!1)}}else a(e=>[...e,{role:"assistant",content:"Please generate a blog post first, then I can help with SEO!"}]);else a(e=>[...e,{role:"assistant",content:"I can help you write blog posts! Just tell me what topic you want to write about, or ask me to generate a blog about a specific subject."}]);var s,r});return r.jsxs("div",{className:"space-y-4",children:[r.jsxs(g,{children:[r.jsx(p,{children:r.jsxs(j,{className:"flex items-center gap-2",children:[r.jsx(X,{className:"w-5 h-5 text-primary"}),"AI Blog Writing Assistant"]})}),r.jsxs(f,{className:"space-y-4",children:[r.jsxs("div",{className:"h-96 overflow-y-auto space-y-3 p-4 bg-muted/20 rounded-lg",children:[t.map((e,s)=>r.jsxs("div",{className:"flex gap-3 "+("user"===e.role?"justify-end":"justify-start"),children:["assistant"===e.role&&r.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:r.jsx(X,{className:"w-4 h-4 text-primary"})}),r.jsx("div",{className:"max-w-[80%] rounded-lg p-3 "+("user"===e.role?"bg-primary text-primary-foreground":"bg-background border"),children:r.jsx("p",{className:"text-sm whitespace-pre-wrap",children:e.content})}),"user"===e.role&&r.jsx("div",{className:"w-8 h-8 rounded-full bg-primary flex items-center justify-center flex-shrink-0",children:r.jsx(ee,{className:"w-4 h-4 text-primary-foreground"})})]},s)),r.jsx("div",{ref:w})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(u,{value:n,onChange:e=>i(e.target.value),onKeyPress:e=>"Enter"===e.key&&!e.shiftKey&&handleSendMessage(),placeholder:"e.g., Write a blog about the benefits of morning meditation...",disabled:h}),r.jsx(c,{onClick:handleSendMessage,disabled:h||!n.trim(),size:"icon",children:h?r.jsx(se,{className:"w-4 h-4 animate-spin"}):r.jsx(te,{className:"w-4 h-4"})}),r.jsx(c,{onClick:()=>{a([{role:"assistant",content:"Hi! I'm your AI blog writing assistant. Tell me what topic you'd like to write about, and I'll help you create amazing content for your health and wellness blog!"}]),v(""),b(null)},variant:"outline",size:"icon",disabled:h,children:r.jsx(ae,{className:"w-4 h-4"})})]})]})]}),x&&r.jsxs(g,{children:[r.jsx(p,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs(j,{className:"flex items-center gap-2",children:[r.jsx(re,{className:"w-5 h-5 text-yellow-500"}),"Generated Blog Content"]}),r.jsxs(c,{onClick:()=>{x&&(e(x),d({title:"Content Copied!",description:"Blog content has been added to the editor"}))},size:"sm",children:[r.jsx(le,{className:"w-4 h-4 mr-2"}),"Copy to Editor"]})]})}),r.jsx(f,{children:r.jsx("div",{className:"max-h-96 overflow-y-auto p-4 bg-muted/20 rounded-lg",children:r.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:x}})})})]}),y&&r.jsxs(g,{children:[r.jsx(p,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs(j,{className:"flex items-center gap-2",children:[r.jsx(Z,{className:"w-5 h-5 text-blue-500"}),"Google Search Preview"]}),r.jsxs(c,{onClick:()=>{y&&(s(y),d({title:"SEO Data Applied!",description:"Title, meta description, and keywords have been added"}))},size:"sm",children:[r.jsx(ne,{className:"w-4 h-4 mr-2"}),"Apply SEO Data"]})]})}),r.jsxs(f,{className:"space-y-4",children:[r.jsx("div",{className:"p-4 bg-white border rounded-lg",children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[r.jsx("span",{children:"greenofig.com"}),r.jsx("span",{children:"â€º"}),r.jsx("span",{className:"text-gray-500",children:y.slug})]}),r.jsx("h3",{className:"text-xl text-blue-600 hover:underline cursor-pointer",children:y.metaTitle}),r.jsx("p",{className:"text-sm text-gray-600",children:y.metaDescription})]})}),r.jsx(je,{}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium mb-1",children:"Title"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:y.title})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium mb-1",children:"Excerpt"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:y.excerpt})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium mb-1",children:"Focus Keyword"}),r.jsx(o,{variant:"secondary",children:y.focusKeyword})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium mb-2",children:"Keywords"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:y.keywords.map((e,s)=>r.jsx(o,{variant:"outline",children:e},s))})]})]})]})]})]})},EnhancedBlogPostEditor=()=>{var e;const{postId:s}=n(),t=i(),{user:a,userProfile:T}=h(),[z,P]=l.useState(""),[I,A]=l.useState(""),[L,B]=l.useState(""),[R,q]=l.useState("draft"),[H,D]=l.useState(""),[F,G]=l.useState(""),[U,M]=l.useState(""),[K,W]=l.useState([]),[Y,J]=l.useState(""),[$,V]=l.useState(!1),[Z,Q]=l.useState(""),[X,ee]=l.useState(""),[te,ae]=l.useState([]),[le,ne]=l.useState([]),[je,fe]=l.useState([]),[ve,ye]=l.useState(0),[be,we]=l.useState(!1),[Ne,Se]=l.useState(!!s),[ke,Ce]=l.useState("editor"),[Ee,Oe]=l.useState(!0),_e=l.useCallback(()=>"nutritionist"===(null==T?void 0:T.role)?"/app/nutritionist?tab=blog":"/app/admin?tab=blog",[T]);l.useEffect(()=>{__async(null,null,function*(){const[e,s]=yield Promise.all([x.from("blog_categories").select("*").order("name"),x.from("blog_tags").select("*").order("name")]);e.data&&ne(e.data),s.data&&fe(s.data)})},[]),l.useEffect(()=>{if(s){(()=>__async(null,null,function*(){Se(!0);const{data:e,error:a}=yield x.from("blog_posts").select("*").eq("id",s).single();if(a)return console.error("Error fetching post:",a),d({title:"Error fetching post data",description:a.message,variant:"destructive"}),t(_e()),void Se(!1);const{data:r,error:l}=yield x.from("blog_post_tags").select("tag_id").eq("post_id",s);l&&console.error("Error fetching tags:",l),e&&(P(e.title),A(e.content||""),B(e.cover_image_url||""),q(e.status),D(e.slug||""),G(e.meta_description||""),M(e.excerpt||""),W(e.keywords||[]),V(e.featured||!1),Q(e.scheduled_publish_at||""),ee(e.category_id||""),ye(e.reading_time_minutes||0),Oe(!1),r&&r.length>0&&ae(r.map(e=>e.tag_id))),Se(!1)}))()}},[s]),l.useEffect(()=>{if(Ee&&z){const e=z.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim();D(e)}},[z,Ee]),l.useEffect(()=>{if(I){const e=I.replace(/<[^>]*>/g,"").split(/\s+/).filter(e=>e.length>0).length,s=Math.ceil(e/200);ye(s)}},[I]),l.useEffect(()=>{if(I&&!U){const e=I.replace(/<[^>]*>/g,"").substring(0,200).trim()+"...";M(e)}},[I,U]);const handleAddKeyword=()=>{Y.trim()&&!K.includes(Y.trim())&&(W([...K,Y.trim()]),J(""))};return Ne?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(se,{className:"w-12 h-12 animate-spin text-primary"})}):r.jsxs(ie.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-7xl mx-auto py-6 px-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(c,{variant:"ghost",size:"icon",onClick:()=>t(_e()),className:"mr-2",children:r.jsx(ce,{className:"w-5 h-5"})}),r.jsx("h1",{className:"text-3xl font-bold",children:s?"Edit Post":"Create New Post"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(c,{variant:"outline",onClick:()=>Ce("preview"),children:[r.jsx(oe,{className:"w-4 h-4 mr-2"}),"Preview"]}),r.jsxs(c,{onClick:()=>__async(null,null,function*(){if(!z||!I)return void d({title:"Title and content are required",variant:"destructive"});if(!H)return void d({title:"Slug is required",variant:"destructive"});we(!0);const e={title:z,content:I,cover_image_url:L||null,status:Z&&"published"===R?"scheduled":R,author_id:a.id,slug:H,meta_description:F||null,excerpt:U||null,keywords:K.length>0?K:null,featured:$,scheduled_publish_at:Z||null,category_id:X||null,reading_time_minutes:ve,published_at:"published"!==R||s?void 0:(new Date).toISOString()};let r,l=s;if(s){const{error:t}=yield x.from("blog_posts").update(e).eq("id",s);r=t}else{const{data:s,error:t}=yield x.from("blog_posts").insert(e).select().single();r=t,s&&(l=s.id)}if(r)return d({title:"Error saving post",description:r.message,variant:"destructive"}),void we(!1);if(l&&(yield x.from("blog_post_tags").delete().eq("post_id",l),te.length>0)){const e=te.map(e=>({post_id:l,tag_id:e}));yield x.from("blog_post_tags").insert(e)}d({title:"Post saved successfully!"}),t(_e()),we(!1)}),disabled:be,children:[be?r.jsx(se,{className:"w-4 h-4 mr-2 animate-spin"}):r.jsx(de,{className:"w-4 h-4 mr-2"}),s?"Update Post":"Save Post"]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsx("div",{className:"lg:col-span-2 space-y-6",children:r.jsxs(b,{value:ke,onValueChange:Ce,children:[r.jsxs(w,{className:"grid w-full grid-cols-4",children:[r.jsxs(N,{value:"ai-assistant",children:[r.jsx(re,{className:"w-4 h-4 mr-1"}),"AI Assistant"]}),r.jsx(N,{value:"editor",children:"Editor"}),r.jsx(N,{value:"seo",children:"SEO"}),r.jsx(N,{value:"preview",children:"Preview"})]}),r.jsx(S,{value:"ai-assistant",className:"space-y-4",children:r.jsx(AIBlogAssistant,{onContentGenerated:e=>{A(e),Ce("editor")},onSEOGenerated:e=>{P(e.title),D(e.slug),G(e.metaDescription),M(e.excerpt),W(e.keywords),Ce("seo")}})}),r.jsx(S,{value:"editor",className:"space-y-4",children:r.jsx(g,{className:"glass-effect",children:r.jsxs(f,{className:"p-6 space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(v,{htmlFor:"title",children:"Post Title *"}),r.jsx(u,{id:"title",placeholder:"Your amazing blog post title",value:z,onChange:e=>P(e.target.value),className:"text-2xl font-bold"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(v,{htmlFor:"content",children:"Content *"}),r.jsx(RichTextEditor,{content:I,onChange:A,placeholder:"Write your masterpiece here..."}),r.jsx("div",{className:"flex justify-between text-xs text-text-secondary",children:r.jsxs("span",{children:["Reading time: ~",ve," min"]})})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(v,{htmlFor:"excerpt",children:"Excerpt"}),r.jsx(m,{id:"excerpt",placeholder:"Brief summary of your post (auto-generated if empty)",value:U,onChange:e=>M(e.target.value),rows:3})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(v,{htmlFor:"cover-image",children:"Cover Image URL"}),r.jsx(u,{id:"cover-image",placeholder:"https://source.unsplash.com/random",value:L,onChange:e=>B(e.target.value)}),L&&r.jsx("img",{src:L,alt:"Cover preview",className:"w-full h-48 object-cover rounded-lg"})]})]})})}),r.jsxs(S,{value:"seo",className:"space-y-4",children:[r.jsxs(g,{className:"glass-effect",children:[r.jsx(p,{children:r.jsx(j,{children:"SEO Settings"})}),r.jsxs(f,{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(v,{htmlFor:"slug",children:"URL Slug *"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(v,{htmlFor:"auto-slug",className:"text-xs text-text-secondary",children:"Auto-generate"}),r.jsx(y,{id:"auto-slug",checked:Ee,onCheckedChange:Oe})]})]}),r.jsx(u,{id:"slug",placeholder:"your-post-slug",value:H,onChange:e=>{D(e.target.value),Oe(!1)},disabled:Ee}),r.jsxs("p",{className:"text-xs text-text-secondary",children:["URL: greenofig.com/blog/",H||"your-post-slug"]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(v,{htmlFor:"meta-description",children:"Meta Description"}),r.jsx(m,{id:"meta-description",placeholder:"Brief description for search engines (120-160 characters)",value:F,onChange:e=>G(e.target.value),rows:3,maxLength:160}),r.jsxs("p",{className:"text-xs text-text-secondary text-right",children:[F.length,"/160"]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(v,{htmlFor:"keywords",children:"Keywords"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(u,{id:"keywords",placeholder:"Add keyword and press Enter",value:Y,onChange:e=>J(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),handleAddKeyword())}}),r.jsx(c,{type:"button",onClick:handleAddKeyword,children:"Add"})]}),r.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:K.map((e,s)=>r.jsxs(o,{variant:"secondary",className:"flex items-center gap-1",children:[e,r.jsx(he,{className:"w-3 h-3 cursor-pointer",onClick:()=>(e=>{W(K.filter(s=>s!==e))})(e)})]},s))})]})]})]}),r.jsx(SEOPreview,{title:z,metaDescription:F,slug:H,excerpt:U})]}),r.jsx(S,{value:"preview",className:"space-y-4",children:r.jsx(g,{className:"glass-effect",children:r.jsxs(f,{className:"p-8",children:[L&&r.jsx("img",{src:L,alt:z,className:"w-full h-64 object-cover rounded-lg mb-6"}),r.jsx("h1",{className:"text-4xl font-bold mb-4",children:z||"Your Post Title"}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-text-secondary mb-6",children:[r.jsxs("span",{children:[ve," min read"]}),X&&r.jsx("span",{children:null==(e=le.find(e=>e.id===X))?void 0:e.name})]}),r.jsx("div",{className:"prose prose-invert max-w-none",dangerouslySetInnerHTML:{__html:I||"<p>Your content will appear here...</p>"}})]})})})]})}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs(g,{className:"glass-effect",children:[r.jsx(p,{children:r.jsx(j,{className:"text-lg",children:"Publishing"})}),r.jsxs(f,{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(v,{children:"Status"}),r.jsxs(k,{value:R,onValueChange:q,children:[r.jsx(C,{children:r.jsx(E,{})}),r.jsxs(O,{children:[r.jsx(_,{value:"draft",children:"Draft"}),r.jsx(_,{value:"published",children:"Published"}),r.jsx(_,{value:"archived",children:"Archived"})]})]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(me,{className:"w-4 h-4"}),r.jsx(v,{htmlFor:"featured",children:"Featured Post"})]}),r.jsx(y,{id:"featured",checked:$,onCheckedChange:V})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(v,{htmlFor:"scheduled",className:"flex items-center gap-2",children:[r.jsx(xe,{className:"w-4 h-4"}),"Schedule Publishing"]}),r.jsx(u,{id:"scheduled",type:"datetime-local",value:Z,onChange:e=>Q(e.target.value)})]})]})]}),r.jsxs(g,{className:"glass-effect",children:[r.jsx(p,{children:r.jsxs(j,{className:"text-lg flex items-center gap-2",children:[r.jsx(ue,{className:"w-4 h-4"}),"Category"]})}),r.jsx(f,{children:r.jsxs(k,{value:X,onValueChange:ee,children:[r.jsx(C,{children:r.jsx(E,{placeholder:"Select category"})}),r.jsx(O,{children:le.map(e=>r.jsx(_,{value:e.id,children:e.name},e.id))})]})})]}),r.jsxs(g,{className:"glass-effect",children:[r.jsx(p,{children:r.jsxs(j,{className:"text-lg flex items-center gap-2",children:[r.jsx(ge,{className:"w-4 h-4"}),"Tags"]})}),r.jsx(f,{children:r.jsx("div",{className:"flex flex-wrap gap-2",children:je.map(e=>r.jsx(o,{variant:te.includes(e.id)?"default":"outline",className:"cursor-pointer",onClick:()=>{return s=e.id,void(te.includes(s)?ae(te.filter(e=>e!==s)):ae([...te,s]));var s},children:e.name},e.id))})})]}),s&&r.jsxs(g,{className:"glass-effect",children:[r.jsx(p,{children:r.jsxs(j,{className:"text-lg flex items-center gap-2",children:[r.jsx(pe,{className:"w-4 h-4"}),"Statistics"]})}),r.jsx(f,{className:"space-y-2 text-sm",children:r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-text-secondary",children:"Reading Time:"}),r.jsxs("span",{children:[ve," min"]})]})})]})]})]})]})};export{EnhancedBlogPostEditor as default};
