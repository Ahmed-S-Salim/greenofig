const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomePage-DXfs54bP.js","assets/vendor-ui-gkPPHEPH.js","assets/vendor-react-Dds8VpLH.js","assets/vendor-utils-CisQTPNT.js","assets/vendor-editor-DGqHsWbs.js","assets/FeaturesPage-CstA9f0q.js","assets/SiteLayout-B0FdKiSe.js","assets/OnboardingSurvey-C6cZk74l.js","assets/dialog-D_VtZS95.js","assets/PricingPage-B7GpZcRS.js","assets/index-CRPgruNs.js","assets/BlogPage-gTI4H-xn.js","assets/card-Pj_OUEuM.js","assets/tabs-rmIyZk1l.js","assets/ReviewsPage-FqfNAAoO.js","assets/input-EoRmzMlo.js","assets/label-qLSsZ5R6.js","assets/ContactPage-DbL_Gllw.js","assets/FaqPage-D8UNJdOS.js","assets/AboutPage-Dgg0TyR0.js","assets/UserDashboard-DTeMs4lt.js","assets/QuickLogMeal-xtw0w_X_.js","assets/select-BoESt1cj.js","assets/NutritionistDashboardV2-DCcTfUOQ.js","assets/EnhancedBlogManager-CNYU-Gb2.js","assets/checkbox-D0W6Xbvk.js","assets/switch-oXOcT0uw.js","assets/AdminDashboard-DjYJfJUu.js","assets/RevenueAnalyticsPage-BUgdAx3w.js","assets/ProfilePage-D7SNydP-.js","assets/EnhancedBlogPostEditor-DpduSozf.js","assets/BlogTagsManager-BMgw6XCW.js","assets/AiCoachPage-CWH9GHO-.js","assets/SurveyPage-RFUrRzPd.js","assets/BillingPage-DymoTogA.js","assets/SupportPage-WQHVE3XS.js","assets/ResetPasswordPage-Bmn7CxFb.js","assets/NutritionPageFunctional-jtzxaRt0.js","assets/FitnessPage-BMFH0IUE.js","assets/ProgressPage-m1nS48Ht.js","assets/MessagingCenter-aP_HMpTR.js","assets/PrivacyPolicyPage-BT088FAq.js","assets/TermsOfServicePage-T62eLG_u.js","assets/AdminFAQPage-egWpKiNN.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,__defNormalProp=(t,r,s)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s,__spreadValues=(e,t)=>{for(var r in t||(t={}))n.call(t,r)&&__defNormalProp(e,r,t[r]);if(s)for(var r of s(t))i.call(t,r)&&__defNormalProp(e,r,t[r]);return e},__spreadProps=(e,s)=>t(e,r(s)),__objRest=(e,t)=>{var r={};for(var o in e)n.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&s)for(var o of s(e))t.indexOf(o)<0&&i.call(e,o)&&(r[o]=e[o]);return r},__async=(e,t,r)=>new Promise((s,n)=>{var fulfilled=e=>{try{step(r.next(e))}catch(t){n(t)}},rejected=e=>{try{step(r.throw(e))}catch(t){n(t)}},step=e=>e.done?s(e.value):Promise.resolve(e.value).then(fulfilled,rejected);step((r=r.apply(e,t)).next())});import{j as o,a9 as a,aa as l,ab as c,ac as u,ad as h,ae as d,af as f,ag as p,ah as m,ai as g,aj as y}from"./vendor-ui-gkPPHEPH.js";import{j as v,g as b,r as _,R as w,a as x,k as j,i as E,u as T,f as S,L as k,O as P,N as O,l as A,m as C,n as R,B as N}from"./vendor-react-Dds8VpLH.js";import{bB as I,bC as $,af as D,m as L,f as U,c as B,U as q,i as H,n as M,A as z,H as W,bD as V,bE as J,h as G,bF as K,bu as Y,by as X,q as Q,C as Z,D as ee,aj as te,j as re,I as se,g as ne,ai as ie,bb as oe,G as ae,bg as le,$ as ce,a6 as ue,aD as he,L as de}from"./vendor-utils-CisQTPNT.js";import"./vendor-editor-DGqHsWbs.js";function _mergeNamespaces(e,t){for(var r=0;r<t.length;r++){const s=t[r];if("string"!=typeof s&&!Array.isArray(s))for(const t in s)if("default"!==t&&!(t in e)){const r=Object.getOwnPropertyDescriptor(s,t);r&&Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:()=>s[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))processPreload(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&processPreload(e)}).observe(document,{childList:!0,subtree:!0})}function processPreload(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var fe,pe={};const me=b(function(){if(fe)return pe;fe=1;var e=v();return pe.createRoot=e.createRoot,pe.hydrateRoot=e.hydrateRoot,pe}()),ge={},__vitePreload=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let allSettled=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),r=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));s=allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in ge)return;ge[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,r&&n.setAttribute("nonce",r),document.head.appendChild(n),t?new Promise((t,r)=>{n.addEventListener("load",t),n.addEventListener("error",()=>r(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function handlePreloadError(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return s.then(t=>{for(const e of t||[])"rejected"===e.status&&handlePreloadError(e.reason);return e().catch(handlePreloadError)})};var ye,ve,be,_e,we,xe={exports:{}};function requireReactPropTypesSecret(){if(ve)return ye;ve=1;return ye="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}function requireFactoryWithThrowingShims(){if(_e)return be;_e=1;var e=requireReactPropTypesSecret();function emptyFunction(){}function emptyFunctionWithReset(){}return emptyFunctionWithReset.resetWarningCache=emptyFunction,be=function(){function shim(t,r,s,n,i,o){if(o!==e){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function getShim(){return shim}shim.isRequired=shim;var t={array:shim,bigint:shim,bool:shim,func:shim,number:shim,object:shim,string:shim,symbol:shim,any:shim,arrayOf:getShim,element:shim,elementType:shim,instanceOf:getShim,node:shim,objectOf:getShim,oneOf:getShim,oneOfType:getShim,shape:getShim,exact:getShim,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return t.PropTypes=t,t}}function requirePropTypes(){return we||(we=1,xe.exports=requireFactoryWithThrowingShims()()),xe.exports}const je=b(requirePropTypes());var Ee,Te;const Se=b(function(){if(Te)return Ee;Te=1;var e,t=_(),r=(e=t)&&"object"==typeof e&&"default"in e?e.default:e;function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=!("undefined"==typeof window||!window.document||!window.document.createElement);return Ee=function(e,n,i){if("function"!=typeof e)throw new Error("Expected reducePropsToState to be a function.");if("function"!=typeof n)throw new Error("Expected handleStateChangeOnClient to be a function.");if(void 0!==i&&"function"!=typeof i)throw new Error("Expected mapStateOnServer to either be undefined or a function.");return function(o){if("function"!=typeof o)throw new Error("Expected WrappedComponent to be a React component.");var a,l=[];function emitChange(){a=e(l.map(function(e){return e.props})),c.canUseDOM?n(a):i&&(a=i(a))}var c=function(e){var t,s;function SideEffect2(){return e.apply(this,arguments)||this}s=e,(t=SideEffect2).prototype=Object.create(s.prototype),t.prototype.constructor=t,t.__proto__=s,SideEffect2.peek=function(){return a},SideEffect2.rewind=function(){if(SideEffect2.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var e=a;return a=void 0,l=[],e};var n=SideEffect2.prototype;return n.UNSAFE_componentWillMount=function(){l.push(this),emitChange()},n.componentDidUpdate=function(){emitChange()},n.componentWillUnmount=function(){var e=l.indexOf(this);l.splice(e,1),emitChange()},n.render=function(){return r.createElement(o,this.props)},SideEffect2}(t.PureComponent);return _defineProperty(c,"displayName","SideEffect("+function(e){return e.displayName||e.name||"Component"}(o)+")"),_defineProperty(c,"canUseDOM",s),c}}}());var ke,Pe;const Oe=b(function(){if(Pe)return ke;Pe=1;var e="undefined"!=typeof Element,t="function"==typeof Map,r="function"==typeof Set,s="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function equal(n,i){if(n===i)return!0;if(n&&i&&"object"==typeof n&&"object"==typeof i){if(n.constructor!==i.constructor)return!1;var o,a,l,c;if(Array.isArray(n)){if((o=n.length)!=i.length)return!1;for(a=o;0!==a--;)if(!equal(n[a],i[a]))return!1;return!0}if(t&&n instanceof Map&&i instanceof Map){if(n.size!==i.size)return!1;for(c=n.entries();!(a=c.next()).done;)if(!i.has(a.value[0]))return!1;for(c=n.entries();!(a=c.next()).done;)if(!equal(a.value[1],i.get(a.value[0])))return!1;return!0}if(r&&n instanceof Set&&i instanceof Set){if(n.size!==i.size)return!1;for(c=n.entries();!(a=c.next()).done;)if(!i.has(a.value[0]))return!1;return!0}if(s&&ArrayBuffer.isView(n)&&ArrayBuffer.isView(i)){if((o=n.length)!=i.length)return!1;for(a=o;0!==a--;)if(n[a]!==i[a])return!1;return!0}if(n.constructor===RegExp)return n.source===i.source&&n.flags===i.flags;if(n.valueOf!==Object.prototype.valueOf&&"function"==typeof n.valueOf&&"function"==typeof i.valueOf)return n.valueOf()===i.valueOf();if(n.toString!==Object.prototype.toString&&"function"==typeof n.toString&&"function"==typeof i.toString)return n.toString()===i.toString();if((o=(l=Object.keys(n)).length)!==Object.keys(i).length)return!1;for(a=o;0!==a--;)if(!Object.prototype.hasOwnProperty.call(i,l[a]))return!1;if(e&&n instanceof Element)return!1;for(a=o;0!==a--;)if(("_owner"!==l[a]&&"__v"!==l[a]&&"__o"!==l[a]||!n.$$typeof)&&!equal(n[l[a]],i[l[a]]))return!1;return!0}return n!=n&&i!=i}return ke=function(e,t){try{return equal(e,t)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}}}());
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Ae,Ce;const Re=b(function(){if(Ce)return Ae;Ce=1;var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;return Ae=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var s={};return"abcdefghijklmnopqrst".split("").forEach(function(e){s[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},s)).join("")}catch(n){return!1}}()?Object.assign:function(s,n){for(var i,o,a=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(s),l=1;l<arguments.length;l++){for(var c in i=Object(arguments[l]))t.call(i,c)&&(a[c]=i[c]);if(e){o=e(i);for(var u=0;u<o.length;u++)r.call(i,o[u])&&(a[o[u]]=i[o[u]])}}return a}}());var Ne="bodyAttributes",Ie="htmlAttributes",$e="titleAttributes",De={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"};Object.keys(De).map(function(e){return De[e]});var Le,Ue,Be,Fe,qe="charset",He="cssText",Me="href",ze="http-equiv",We="innerHTML",Ve="itemprop",Je="name",Ge="property",Ke="rel",Ye="src",Xe="target",Qe={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},Ze="defaultTitle",et="defer",tt="encodeSpecialCharacters",rt="onChangeClientState",st="titleTemplate",nt=Object.keys(Qe).reduce(function(e,t){return e[Qe[t]]=t,e},{}),it=[De.NOSCRIPT,De.SCRIPT,De.STYLE],ot="data-react-helmet",at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lt=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),ct=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},objectWithoutProperties=function(e,t){var r={};for(var s in e)t.indexOf(s)>=0||Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=e[s]);return r},encodeSpecialCharacters=function(e){return!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},getTitleFromPropsList=function(e){var t=getInnermostProperty(e,De.TITLE),r=getInnermostProperty(e,st);if(r&&t)return r.replace(/%s/g,function(){return Array.isArray(t)?t.join(""):t});var s=getInnermostProperty(e,Ze);return t||s||void 0},getOnChangeClientState=function(e){return getInnermostProperty(e,rt)||function(){}},getAttributesFromPropsList=function(e,t){return t.filter(function(t){return void 0!==t[e]}).map(function(t){return t[e]}).reduce(function(e,t){return ct({},e,t)},{})},getBaseTagFromPropsList=function(e,t){return t.filter(function(e){return void 0!==e[De.BASE]}).map(function(e){return e[De.BASE]}).reverse().reduce(function(t,r){if(!t.length)for(var s=Object.keys(r),n=0;n<s.length;n++){var i=s[n].toLowerCase();if(-1!==e.indexOf(i)&&r[i])return t.concat(r)}return t},[])},getTagsFromPropsList=function(e,t,r){var s={};return r.filter(function(t){return!!Array.isArray(t[e])||(void 0!==t[e]&&warn("Helmet: "+e+' should be of type "Array". Instead found type "'+at(t[e])+'"'),!1)}).map(function(t){return t[e]}).reverse().reduce(function(e,r){var n={};r.filter(function(e){for(var r=void 0,i=Object.keys(e),o=0;o<i.length;o++){var a=i[o],l=a.toLowerCase();-1===t.indexOf(l)||r===Ke&&"canonical"===e[r].toLowerCase()||l===Ke&&"stylesheet"===e[l].toLowerCase()||(r=l),-1===t.indexOf(a)||a!==We&&a!==He&&a!==Ve||(r=a)}if(!r||!e[r])return!1;var c=e[r].toLowerCase();return s[r]||(s[r]={}),n[r]||(n[r]={}),!s[r][c]&&(n[r][c]=!0,!0)}).reverse().forEach(function(t){return e.push(t)});for(var i=Object.keys(n),o=0;o<i.length;o++){var a=i[o],l=Re({},s[a],n[a]);s[a]=l}return e},[]).reverse()},getInnermostProperty=function(e,t){for(var r=e.length-1;r>=0;r--){var s=e[r];if(s.hasOwnProperty(t))return s[t]}return null},ut=(Le=Date.now(),function(e){var t=Date.now();t-Le>16?(Le=t,e(t)):setTimeout(function(){ut(e)},0)}),cafPolyfill=function(e){return clearTimeout(e)},ht="undefined"!=typeof window?window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||ut:global.requestAnimationFrame||ut,dt="undefined"!=typeof window?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||cafPolyfill:global.cancelAnimationFrame||cafPolyfill,warn=function(e){return console&&"function"==typeof console.warn&&console.warn(e)},ft=null,commitTagChanges=function(e,t){var r=e.baseTag,s=e.bodyAttributes,n=e.htmlAttributes,i=e.linkTags,o=e.metaTags,a=e.noscriptTags,l=e.onChangeClientState,c=e.scriptTags,u=e.styleTags,h=e.title,d=e.titleAttributes;updateAttributes(De.BODY,s),updateAttributes(De.HTML,n),updateTitle(h,d);var f={baseTag:updateTags(De.BASE,r),linkTags:updateTags(De.LINK,i),metaTags:updateTags(De.META,o),noscriptTags:updateTags(De.NOSCRIPT,a),scriptTags:updateTags(De.SCRIPT,c),styleTags:updateTags(De.STYLE,u)},p={},m={};Object.keys(f).forEach(function(e){var t=f[e],r=t.newTags,s=t.oldTags;r.length&&(p[e]=r),s.length&&(m[e]=f[e].oldTags)}),t&&t(),l(e,p,m)},flattenArray=function(e){return Array.isArray(e)?e.join(""):e},updateTitle=function(e,t){void 0!==e&&document.title!==e&&(document.title=flattenArray(e)),updateAttributes(De.TITLE,t)},updateAttributes=function(e,t){var r=document.getElementsByTagName(e)[0];if(r){for(var s=r.getAttribute(ot),n=s?s.split(","):[],i=[].concat(n),o=Object.keys(t),a=0;a<o.length;a++){var l=o[a],c=t[l]||"";r.getAttribute(l)!==c&&r.setAttribute(l,c),-1===n.indexOf(l)&&n.push(l);var u=i.indexOf(l);-1!==u&&i.splice(u,1)}for(var h=i.length-1;h>=0;h--)r.removeAttribute(i[h]);n.length===i.length?r.removeAttribute(ot):r.getAttribute(ot)!==o.join(",")&&r.setAttribute(ot,o.join(","))}},updateTags=function(e,t){var r=document.head||document.querySelector(De.HEAD),s=r.querySelectorAll(e+"["+ot+"]"),n=Array.prototype.slice.call(s),i=[],o=void 0;return t&&t.length&&t.forEach(function(t){var r=document.createElement(e);for(var s in t)if(t.hasOwnProperty(s))if(s===We)r.innerHTML=t.innerHTML;else if(s===He)r.styleSheet?r.styleSheet.cssText=t.cssText:r.appendChild(document.createTextNode(t.cssText));else{var a=void 0===t[s]?"":t[s];r.setAttribute(s,a)}r.setAttribute(ot,"true"),n.some(function(e,t){return o=t,r.isEqualNode(e)})?n.splice(o,1):i.push(r)}),n.forEach(function(e){return e.parentNode.removeChild(e)}),i.forEach(function(e){return r.appendChild(e)}),{oldTags:n,newTags:i}},generateElementAttributesAsString=function(e){return Object.keys(e).reduce(function(t,r){var s=void 0!==e[r]?r+'="'+e[r]+'"':""+r;return t?t+" "+s:s},"")},convertElementAttributestoReactProps=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).reduce(function(t,r){return t[Qe[r]||r]=e[r],t},t)},getMethodsForTag=function(e,t,r){switch(e){case De.TITLE:return{toComponent:function(){return e=t.title,r=t.titleAttributes,(s={key:e})[ot]=!0,n=convertElementAttributestoReactProps(r,s),[w.createElement(De.TITLE,n,e)];var e,r,s,n},toString:function(){return function(e,t,r,s){var n=generateElementAttributesAsString(r),i=flattenArray(t);return n?"<"+e+" "+ot+'="true" '+n+">"+encodeSpecialCharacters(i,s)+"</"+e+">":"<"+e+" "+ot+'="true">'+encodeSpecialCharacters(i,s)+"</"+e+">"}(e,t.title,t.titleAttributes,r)}};case Ne:case Ie:return{toComponent:function(){return convertElementAttributestoReactProps(t)},toString:function(){return generateElementAttributesAsString(t)}};default:return{toComponent:function(){return function(e,t){return t.map(function(t,r){var s,n=((s={key:r})[ot]=!0,s);return Object.keys(t).forEach(function(e){var r=Qe[e]||e;if(r===We||r===He){var s=t.innerHTML||t.cssText;n.dangerouslySetInnerHTML={__html:s}}else n[r]=t[e]}),w.createElement(e,n)})}(e,t)},toString:function(){return function(e,t,r){return t.reduce(function(t,s){var n=Object.keys(s).filter(function(e){return!(e===We||e===He)}).reduce(function(e,t){var n=void 0===s[t]?t:t+'="'+encodeSpecialCharacters(s[t],r)+'"';return e?e+" "+n:n},""),i=s.innerHTML||s.cssText||"",o=-1===it.indexOf(e);return t+"<"+e+" "+ot+'="true" '+n+(o?"/>":">"+i+"</"+e+">")},"")}(e,t,r)}}}},mapStateOnServer=function(e){var t=e.baseTag,r=e.bodyAttributes,s=e.encode,n=e.htmlAttributes,i=e.linkTags,o=e.metaTags,a=e.noscriptTags,l=e.scriptTags,c=e.styleTags,u=e.title,h=void 0===u?"":u,d=e.titleAttributes;return{base:getMethodsForTag(De.BASE,t,s),bodyAttributes:getMethodsForTag(Ne,r,s),htmlAttributes:getMethodsForTag(Ie,n,s),link:getMethodsForTag(De.LINK,i,s),meta:getMethodsForTag(De.META,o,s),noscript:getMethodsForTag(De.NOSCRIPT,a,s),script:getMethodsForTag(De.SCRIPT,l,s),style:getMethodsForTag(De.STYLE,c,s),title:getMethodsForTag(De.TITLE,{title:h,titleAttributes:d},s)}},pt=Se(function(e){return{baseTag:getBaseTagFromPropsList([Me,Xe],e),bodyAttributes:getAttributesFromPropsList(Ne,e),defer:getInnermostProperty(e,et),encode:getInnermostProperty(e,tt),htmlAttributes:getAttributesFromPropsList(Ie,e),linkTags:getTagsFromPropsList(De.LINK,[Ke,Me],e),metaTags:getTagsFromPropsList(De.META,[Je,qe,ze,Ge,Ve],e),noscriptTags:getTagsFromPropsList(De.NOSCRIPT,[We],e),onChangeClientState:getOnChangeClientState(e),scriptTags:getTagsFromPropsList(De.SCRIPT,[Ye,We],e),styleTags:getTagsFromPropsList(De.STYLE,[He],e),title:getTitleFromPropsList(e),titleAttributes:getAttributesFromPropsList($e,e)}},function(e){ft&&dt(ft),e.defer?ft=ht(function(){commitTagChanges(e,function(){ft=null})}):(commitTagChanges(e),ft=null)},mapStateOnServer)(function(){return null}),mt=(Ue=pt,Fe=Be=function(e){function HelmetWrapper(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HelmetWrapper),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(HelmetWrapper,e),HelmetWrapper.prototype.shouldComponentUpdate=function(e){return!Oe(this.props,e)},HelmetWrapper.prototype.mapNestedChildrenToProps=function(e,t){if(!t)return null;switch(e.type){case De.SCRIPT:case De.NOSCRIPT:return{innerHTML:t};case De.STYLE:return{cssText:t}}throw new Error("<"+e.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},HelmetWrapper.prototype.flattenArrayTypeChildren=function(e){var t,r=e.child,s=e.arrayTypeChildren,n=e.newChildProps,i=e.nestedChildren;return ct({},s,((t={})[r.type]=[].concat(s[r.type]||[],[ct({},n,this.mapNestedChildrenToProps(r,i))]),t))},HelmetWrapper.prototype.mapObjectTypeChildren=function(e){var t,r,s=e.child,n=e.newProps,i=e.newChildProps,o=e.nestedChildren;switch(s.type){case De.TITLE:return ct({},n,((t={})[s.type]=o,t.titleAttributes=ct({},i),t));case De.BODY:return ct({},n,{bodyAttributes:ct({},i)});case De.HTML:return ct({},n,{htmlAttributes:ct({},i)})}return ct({},n,((r={})[s.type]=ct({},i),r))},HelmetWrapper.prototype.mapArrayTypeChildrenToProps=function(e,t){var r=ct({},t);return Object.keys(e).forEach(function(t){var s;r=ct({},r,((s={})[t]=e[t],s))}),r},HelmetWrapper.prototype.warnOnInvalidChildren=function(e,t){return!0},HelmetWrapper.prototype.mapChildrenToProps=function(e,t){var r=this,s={};return w.Children.forEach(e,function(e){if(e&&e.props){var n=e.props,i=n.children,o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).reduce(function(t,r){return t[nt[r]||r]=e[r],t},t)}(objectWithoutProperties(n,["children"]));switch(r.warnOnInvalidChildren(e,i),e.type){case De.LINK:case De.META:case De.NOSCRIPT:case De.SCRIPT:case De.STYLE:s=r.flattenArrayTypeChildren({child:e,arrayTypeChildren:s,newChildProps:o,nestedChildren:i});break;default:t=r.mapObjectTypeChildren({child:e,newProps:t,newChildProps:o,nestedChildren:i})}}}),t=this.mapArrayTypeChildrenToProps(s,t)},HelmetWrapper.prototype.render=function(){var e=this.props,t=e.children,r=objectWithoutProperties(e,["children"]),s=ct({},r);return t&&(s=this.mapChildrenToProps(t,s)),w.createElement(Ue,s)},lt(HelmetWrapper,null,[{key:"canUseDOM",set:function(e){Ue.canUseDOM=e}}]),HelmetWrapper}(w.Component),Be.propTypes={base:je.object,bodyAttributes:je.object,children:je.oneOfType([je.arrayOf(je.node),je.node]),defaultTitle:je.string,defer:je.bool,encodeSpecialCharacters:je.bool,htmlAttributes:je.object,link:je.arrayOf(je.object),meta:je.arrayOf(je.object),noscript:je.arrayOf(je.object),onChangeClientState:je.func,script:je.arrayOf(je.object),style:je.arrayOf(je.object),title:je.string,titleAttributes:je.object,titleTemplate:je.string},Be.defaultProps={defer:!0,encodeSpecialCharacters:!0},Be.peek=Ue.peek,Be.rewind=function(){var e=Ue.rewind();return e||(e=mapStateOnServer({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),e},Fe);function cn(...e){return I($(e))}mt.renderStatic=mt.rewind;const falsyToString=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,gt=$,cva=(e,t)=>r=>{var s;if(null==(null==t?void 0:t.variants))return gt(e,null==r?void 0:r.class,null==r?void 0:r.className);const{variants:n,defaultVariants:i}=t,o=Object.keys(n).map(e=>{const t=null==r?void 0:r[e],s=null==i?void 0:i[e];if(null===t)return null;const o=falsyToString(t)||falsyToString(s);return n[e][o]}),a=r&&Object.entries(r).reduce((e,t)=>{let[r,s]=t;return void 0===s||(e[r]=s),e},{}),l=null==t||null===(s=t.compoundVariants)||void 0===s?void 0:s.reduce((e,t)=>{let r=t,{class:s,className:n}=r,o=__objRest(r,["class","className"]);return Object.entries(o).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes(__spreadValues(__spreadValues({},i),a)[t]):__spreadValues(__spreadValues({},i),a)[t]===r})?[...e,s,n]:e},[]);return gt(e,o,l,null==r?void 0:r.class,null==r?void 0:r.className)},yt=f,vt=w.forwardRef((e,t)=>{var r=e,{className:s}=r,n=__objRest(r,["className"]);return o.jsx(a,__spreadValues({ref:t,className:cn("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s)},n))});vt.displayName=a.displayName;const bt=cva("data-[swipe=move]:transition-none group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-background border",destructive:"group destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),_t=w.forwardRef((e,t)=>{var r=e,{className:s,variant:n}=r,i=__objRest(r,["className","variant"]);return o.jsx(l,__spreadValues({ref:t,className:cn(bt({variant:n}),s)},i))});_t.displayName=l.displayName;w.forwardRef((e,t)=>{var r=e,{className:s}=r,n=__objRest(r,["className"]);return o.jsx(c,__spreadValues({ref:t,className:cn("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s)},n))}).displayName=c.displayName;const wt=w.forwardRef((e,t)=>{var r=e,{className:s}=r,n=__objRest(r,["className"]);return o.jsx(u,__spreadProps(__spreadValues({ref:t,className:cn("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":""},n),{children:o.jsx(D,{className:"h-4 w-4"})}))});wt.displayName=u.displayName;const xt=w.forwardRef((e,t)=>{var r=e,{className:s}=r,n=__objRest(r,["className"]);return o.jsx(h,__spreadValues({ref:t,className:cn("text-sm font-semibold",s)},n))});xt.displayName=h.displayName;const jt=w.forwardRef((e,t)=>{var r=e,{className:s}=r,n=__objRest(r,["className"]);return o.jsx(d,__spreadValues({ref:t,className:cn("text-sm opacity-90",s)},n))});jt.displayName=d.displayName;let Et=0;const Tt={state:{toasts:[]},listeners:[],getState:()=>Tt.state,setState:e=>{Tt.state="function"==typeof e?e(Tt.state):__spreadValues(__spreadValues({},Tt.state),e),Tt.listeners.forEach(e=>e(Tt.state))},subscribe:e=>(Tt.listeners.push(e),()=>{Tt.listeners=Tt.listeners.filter(t=>t!==e)})},toast=e=>{var t=__objRest(e,[]);const r=(Et=(Et+1)%Number.MAX_VALUE,Et.toString()),dismiss=()=>Tt.setState(e=>__spreadProps(__spreadValues({},e),{toasts:e.toasts.filter(e=>e.id!==r)}));return Tt.setState(e=>__spreadProps(__spreadValues({},e),{toasts:[__spreadProps(__spreadValues({},t),{id:r,dismiss:dismiss}),...e.toasts].slice(0,1)})),{id:r,dismiss:dismiss,update:e=>Tt.setState(t=>__spreadProps(__spreadValues({},t),{toasts:t.toasts.map(t=>t.id===r?__spreadValues(__spreadValues({},t),e):t)}))}};function useToast(){const[e,t]=x.useState(Tt.getState());return x.useEffect(()=>Tt.subscribe(e=>{t(e)}),[]),x.useEffect(()=>{const t=[];return e.toasts.forEach(e=>{if(e.duration===1/0)return;const r=setTimeout(()=>{e.dismiss()},e.duration||5e3);t.push(r)}),()=>{t.forEach(e=>clearTimeout(e))}},[e.toasts]),{toast:toast,toasts:e.toasts}}function Toaster(){const{toasts:e}=useToast();return o.jsxs(yt,{children:[e.map(e=>{var t=e,{id:r,title:s,description:n,action:i}=t,a=__objRest(t,["id","title","description","action"]);return o.jsxs(_t,__spreadProps(__spreadValues({},a),{children:[o.jsxs("div",{className:"grid gap-1",children:[s&&o.jsx(xt,{children:s}),n&&o.jsx(jt,{children:n})]}),i,o.jsx(wt,{})]}),r)}),o.jsx(vt,{})]})}class St extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class kt extends St{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Pt extends St{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ot extends St{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var At,Ct;(Ct=At||(At={})).Any="any",Ct.ApNortheast1="ap-northeast-1",Ct.ApNortheast2="ap-northeast-2",Ct.ApSouth1="ap-south-1",Ct.ApSoutheast1="ap-southeast-1",Ct.ApSoutheast2="ap-southeast-2",Ct.CaCentral1="ca-central-1",Ct.EuCentral1="eu-central-1",Ct.EuWest1="eu-west-1",Ct.EuWest2="eu-west-2",Ct.EuWest3="eu-west-3",Ct.SaEast1="sa-east-1",Ct.UsEast1="us-east-1",Ct.UsWest1="us-west-1",Ct.UsWest2="us-west-2";var __awaiter$8=function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function fulfilled(e){try{step(s.next(e))}catch(t){i(t)}}function rejected(e){try{step(s.throw(e))}catch(t){i(t)}}function step(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())})};class Rt{constructor(e,{headers:t={},customFetch:r,region:s=At.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>__vitePreload(()=>__async(null,null,function*(){const{default:e}=yield Promise.resolve().then(()=>Wt);return{default:e}}),void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)})(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return __awaiter$8(this,arguments,void 0,function*(e,t={}){var r;try{const{headers:s,method:n,body:i,signal:o}=t;let a={},{region:l}=t;l||(l=this.region);const c=new URL(`${this.url}/${e}`);let u;l&&"any"!==l&&(a["x-region"]=l,c.searchParams.set("forceFunctionRegion",l)),i&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&("undefined"!=typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=i):"string"==typeof i?(a["Content-Type"]="text/plain",u=i):"undefined"!=typeof FormData&&i instanceof FormData?u=i:(a["Content-Type"]="application/json",u=JSON.stringify(i)));const h=yield this.fetch(c.toString(),{method:n||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:u,signal:o}).catch(e=>{if("AbortError"===e.name)throw e;throw new kt(e)}),d=h.headers.get("x-relay-error");if(d&&"true"===d)throw new Pt(h);if(!h.ok)throw new Ot(h);let f,p=(null!==(r=h.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return f="application/json"===p?yield h.json():"application/octet-stream"===p?yield h.blob():"text/event-stream"===p?h:"multipart/form-data"===p?yield h.formData():yield h.text(),{data:f,error:null,response:h}}catch(s){return s instanceof Error&&"AbortError"===s.name?{data:null,error:new kt(s)}:{data:null,error:s,response:s instanceof Ot||s instanceof Pt?s.context:void 0}}})}}var Nt={},It={},$t={},Dt={},Lt={},Ut={},Bt=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const Ft=Bt.fetch,qt=Bt.fetch.bind(Bt),Ht=Bt.Headers,Mt=Bt.Request,zt=Bt.Response,Wt=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ht,Request:Mt,Response:zt,default:qt,fetch:Ft},Symbol.toStringTag,{value:"Module"})),Vt=j(Wt);var Jt,Gt,Kt,Yt,Xt,Qt,Zt,er={};function requirePostgrestError(){if(Jt)return er;Jt=1,Object.defineProperty(er,"__esModule",{value:!0});class e extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}return er.default=e,er}function requirePostgrestBuilder(){if(Gt)return Ut;Gt=1;var e=Ut&&Ut.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ut,"__esModule",{value:!0});const t=e(Vt),r=e(requirePostgrestError());return Ut.default=class{constructor(e){var r,s;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(r=e.shouldThrowOnError)&&void 0!==r&&r,this.signal=e.signal,this.isMaybeSingle=null!==(s=e.isMaybeSingle)&&void 0!==s&&s,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(e=>__async(this,null,function*(){var t,s,n,i;let o=null,a=null,l=null,c=e.status,u=e.statusText;if(e.ok){if("HEAD"!==this.method){const r=yield e.text();""===r||(a="text/csv"===this.headers.get("Accept")||this.headers.get("Accept")&&(null===(t=this.headers.get("Accept"))||void 0===t?void 0:t.includes("application/vnd.pgrst.plan+text"))?r:JSON.parse(r))}const r=null===(s=this.headers.get("Prefer"))||void 0===s?void 0:s.match(/count=(exact|planned|estimated)/),i=null===(n=e.headers.get("content-range"))||void 0===n?void 0:n.split("/");r&&i&&i.length>1&&(l=parseInt(i[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(a)&&(a.length>1?(o={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,l=null,c=406,u="Not Acceptable"):a=1===a.length?a[0]:null)}else{const t=yield e.text();try{o=JSON.parse(t),Array.isArray(o)&&404===e.status&&(a=[],o=null,c=200,u="OK")}catch(h){404===e.status&&""===t?(c=204,u="No Content"):o={message:t}}if(o&&this.isMaybeSingle&&(null===(i=null==o?void 0:o.details)||void 0===i?void 0:i.includes("0 rows"))&&(o=null,c=200,u="OK"),o&&this.shouldThrowOnError)throw new r.default(o)}return{error:o,data:a,count:l,status:c,statusText:u}}));return this.shouldThrowOnError||(s=s.catch(e=>{var t,r,s;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(r=null==e?void 0:e.stack)&&void 0!==r?r:""}`,hint:"",code:`${null!==(s=null==e?void 0:e.code)&&void 0!==s?s:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}},Ut}function requirePostgrestTransformBuilder(){if(Kt)return Lt;Kt=1;var e=Lt&&Lt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Lt,"__esModule",{value:!0});const t=e(requirePostgrestBuilder());class r extends t.default{select(e){let t=!1;const r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:n=s}={}){const i=n?`${n}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const n=void 0===s?"offset":`${s}.offset`,i=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(i,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:n=!1,format:i="text"}={}){var o;const a=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,n?"wal":null].filter(Boolean).join("|"),l=null!==(o=this.headers.get("Accept"))&&void 0!==o?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${a};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}}return Lt.default=r,Lt}function requirePostgrestFilterBuilder(){if(Yt)return Dt;Yt=1;var e=Dt&&Dt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Dt,"__esModule",{value:!0});const t=e(requirePostgrestTransformBuilder());class r extends t.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let n="";"plain"===s?n="pl":"phrase"===s?n="ph":"websearch"===s&&(n="w");const i=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${n}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}return Dt.default=r,Dt}function requirePostgrestQueryBuilder(){if(Xt)return $t;Xt=1;var e=$t&&$t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($t,"__esModule",{value:!0});const t=e(requirePostgrestFilterBuilder());return $t.default=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=s}select(e,{head:r=!1,count:s}={}){const n=r?"HEAD":"GET";let i=!1;const o=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!i?"":('"'===e&&(i=!i),e)).join("");return this.url.searchParams.set("select",o),s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:r,defaultToNull:s=!0}={}){var n;if(r&&this.headers.append("Prefer",`count=${r}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new t.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch})}upsert(e,{onConflict:r,ignoreDuplicates:s=!1,count:n,defaultToNull:i=!0}={}){var o;if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),void 0!==r&&this.url.searchParams.set("on_conflict",r),n&&this.headers.append("Prefer",`count=${n}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new t.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(o=this.fetch)&&void 0!==o?o:fetch})}update(e,{count:r}={}){var s;return r&&this.headers.append("Prefer",`count=${r}`),new t.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch})}delete({count:e}={}){var r;return e&&this.headers.append("Prefer",`count=${e}`),new t.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})}},$t}const tr=b(function(){if(Zt)return Nt;Zt=1;var e=Nt&&Nt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.PostgrestError=Nt.PostgrestBuilder=Nt.PostgrestTransformBuilder=Nt.PostgrestFilterBuilder=Nt.PostgrestQueryBuilder=Nt.PostgrestClient=void 0;const t=e(function(){if(Qt)return It;Qt=1;var e=It&&It.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(It,"__esModule",{value:!0});const t=e(requirePostgrestQueryBuilder()),r=e(requirePostgrestFilterBuilder());class s{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=s}from(e){const r=new URL(`${this.url}/${e}`);return new t.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new s(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:n=!1,count:i}={}){var o;let a;const l=new URL(`${this.url}/rpc/${e}`);let c;s||n?(a=s?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{l.searchParams.append(e,t)})):(a="POST",c=t);const u=new Headers(this.headers);return i&&u.set("Prefer",`count=${i}`),new r.default({method:a,url:l,headers:u,schema:this.schemaName,body:c,fetch:null!==(o=this.fetch)&&void 0!==o?o:fetch})}}return It.default=s,It}());Nt.PostgrestClient=t.default;const r=e(requirePostgrestQueryBuilder());Nt.PostgrestQueryBuilder=r.default;const s=e(requirePostgrestFilterBuilder());Nt.PostgrestFilterBuilder=s.default;const n=e(requirePostgrestTransformBuilder());Nt.PostgrestTransformBuilder=n.default;const i=e(requirePostgrestBuilder());Nt.PostgrestBuilder=i.default;const o=e(requirePostgrestError());return Nt.PostgrestError=o.default,Nt.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:i.default,PostgrestError:o.default},Nt}()),{PostgrestClient:rr,PostgrestQueryBuilder:sr,PostgrestFilterBuilder:nr,PostgrestTransformBuilder:ir,PostgrestBuilder:or,PostgrestError:ar}=tr;class lr{static detectEnvironment(){var e;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!=typeof global&&void 0!==global.WebSocket)return{type:"native",constructor:global.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!=typeof process){const e=process.versions;if(e&&e.node){const t=e.node,r=parseInt(t.replace(/^v/,"").split(".")[0]);return r>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`\n\nSuggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}}const cr=1e4;var ur,hr,dr,fr,pr,mr,gr,yr,vr,br,_r;(hr=ur||(ur={}))[hr.connecting=0]="connecting",hr[hr.open=1]="open",hr[hr.closing=2]="closing",hr[hr.closed=3]="closed",(fr=dr||(dr={})).closed="closed",fr.errored="errored",fr.joined="joined",fr.joining="joining",fr.leaving="leaving",(mr=pr||(pr={})).close="phx_close",mr.error="phx_error",mr.join="phx_join",mr.reply="phx_reply",mr.leave="phx_leave",mr.access_token="access_token",(gr||(gr={})).websocket="websocket",(vr=yr||(yr={})).Connecting="connecting",vr.Open="open",vr.Closing="closing",vr.Closed="closed";class wr{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),n=t.getUint8(2);let i=this.HEADER_LENGTH+2;const o=r.decode(e.slice(i,i+s));i+=s;const a=r.decode(e.slice(i,i+n));i+=n;return{ref:null,topic:o,event:a,payload:JSON.parse(r.decode(e.slice(i,e.byteLength)))}}}class xr{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(_r=br||(br={})).abstime="abstime",_r.bool="bool",_r.date="date",_r.daterange="daterange",_r.float4="float4",_r.float8="float8",_r.int2="int2",_r.int4="int4",_r.int4range="int4range",_r.int8="int8",_r.int8range="int8range",_r.json="json",_r.jsonb="jsonb",_r.money="money",_r.numeric="numeric",_r.oid="oid",_r.reltime="reltime",_r.text="text",_r.time="time",_r.timestamp="timestamp",_r.timestamptz="timestamptz",_r.timetz="timetz",_r.tsrange="tsrange",_r.tstzrange="tstzrange";const convertChangeData=(e,t,r={})=>{var s;const n=null!==(s=r.skipTypes)&&void 0!==s?s:[];return t?Object.keys(t).reduce((r,s)=>(r[s]=convertColumn(s,e,t,n),r),{}):{}},convertColumn=(e,t,r,s)=>{const n=t.find(t=>t.name===e),i=null==n?void 0:n.type,o=r[e];return i&&!s.includes(i)?convertCell(i,o):noop$1(o)},convertCell=(e,t)=>{if("_"===e.charAt(0)){const r=e.slice(1,e.length);return toArray(t,r)}switch(e){case br.bool:return toBoolean(t);case br.float4:case br.float8:case br.int2:case br.int4:case br.int8:case br.numeric:case br.oid:return toNumber(t);case br.json:case br.jsonb:return toJson(t);case br.timestamp:return toTimestampString(t);case br.abstime:case br.date:case br.daterange:case br.int4range:case br.int8range:case br.money:case br.reltime:case br.text:case br.time:case br.timestamptz:case br.timetz:case br.tsrange:case br.tstzrange:default:return noop$1(t)}},noop$1=e=>e,toBoolean=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},toNumber=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},toJson=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e}return e},toArray=(e,t)=>{if("string"!=typeof e)return e;const r=e.length-1,s=e[r];if("{"===e[0]&&"}"===s){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch(n){s=i?i.split(","):[]}return s.map(e=>convertCell(t,e))}return e},toTimestampString=e=>"string"==typeof e?e.replace(" ","T"):e,httpEndpointURL=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class jr{constructor(e,t,r={},s=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Er,Tr,Sr,kr,Pr,Or,Ar,Cr;(Tr=Er||(Er={})).SYNC="sync",Tr.JOIN="join",Tr.LEAVE="leave";class Rr{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{const{onJoin:t,onLeave:r,onSync:s}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Rr.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=Rr.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],s()}),this.channel._on(r.diff,{},e=>{const{onJoin:t,onLeave:r,onSync:s}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Rr.syncDiff(this.state,e,t,r),s())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const n=this.cloneDeep(e),i=this.transformState(t),o={},a={};return this.map(n,(e,t)=>{i[e]||(a[e]=t)}),this.map(i,(e,t)=>{const r=n[e];if(r){const s=t.map(e=>e.presence_ref),n=r.map(e=>e.presence_ref),i=t.filter(e=>n.indexOf(e.presence_ref)<0),l=r.filter(e=>s.indexOf(e.presence_ref)<0);i.length>0&&(o[e]=i),l.length>0&&(a[e]=l)}else o[e]=t}),this.syncDiff(n,{joins:o,leaves:a},r,s)}static syncDiff(e,t,r,s){const{joins:n,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(n,(t,s)=>{var n;const i=null!==(n=e[t])&&void 0!==n?n:[];if(e[t]=this.cloneDeep(s),i.length>0){const r=e[t].map(e=>e.presence_ref),s=i.filter(e=>r.indexOf(e.presence_ref)<0);e[t].unshift(...s)}r(t,i,s)}),this.map(i,(t,r)=>{let n=e[t];if(!n)return;const i=r.map(e=>e.presence_ref);n=n.filter(e=>i.indexOf(e.presence_ref)<0),e[t]=n,s(t,n,r),0===n.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return t[r]="metas"in s?s.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(kr=Sr||(Sr={})).ALL="*",kr.INSERT="INSERT",kr.UPDATE="UPDATE",kr.DELETE="DELETE",(Or=Pr||(Pr={})).BROADCAST="broadcast",Or.PRESENCE="presence",Or.POSTGRES_CHANGES="postgres_changes",Or.SYSTEM="system",(Cr=Ar||(Ar={})).SUBSCRIBED="SUBSCRIBED",Cr.TIMED_OUT="TIMED_OUT",Cr.CLOSED="CLOSED",Cr.CHANNEL_ERROR="CHANNEL_ERROR";class Nr{constructor(e,t={config:{}},r){var s,n;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=dr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new jr(this,pr.join,this.params,this.timeout),this.rejoinTimer=new xr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=dr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=dr.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=dr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=dr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=dr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(pr.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new Rr(this),this.broadcastEndpointURL=httpEndpointURL(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(n=null===(s=this.params.config)||void 0===s?void 0:s.broadcast)||void 0===n?void 0:n.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,s,n;if(this.socket.isConnected()||this.socket.connect(),this.state==dr.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params,l=null!==(s=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==s?s:[],c=!!this.bindings[Pr.PRESENCE]&&this.bindings[Pr.PRESENCE].length>0||!0===(null===(n=this.params.config.presence)||void 0===n?void 0:n.enabled),u={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:c}),postgres_changes:l,private:a};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(Ar.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(Ar.CLOSED)),this.updateJoinPayload(Object.assign({config:h},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",t=>__async(this,[t],function*({postgres_changes:t}){var r;if(this.socket.setAuth(),void 0!==t){const s=this.bindings.postgres_changes,n=null!==(r=null==s?void 0:s.length)&&void 0!==r?r:0,i=[];for(let r=0;r<n;r++){const n=s[r],{filter:{event:o,schema:a,table:l,filter:c}}=n,u=t&&t[r];if(!u||u.event!==o||u.schema!==a||u.table!==l||u.filter!==c)return this.unsubscribe(),this.state=dr.errored,void(null==e||e(Ar.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));i.push(Object.assign(Object.assign({},n),{id:u.id}))}return this.bindings.postgres_changes=i,void(e&&e(Ar.SUBSCRIBED))}null==e||e(Ar.SUBSCRIBED)})).receive("error",t=>{this.state=dr.errored,null==e||e(Ar.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(Ar.TIMED_OUT)})}return this}presenceState(){return this.presence.state}track(e){return __async(this,arguments,function*(e,t={}){return yield this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)})}untrack(){return __async(this,arguments,function*(e={}){return yield this.send({type:"presence",event:"untrack"},e)})}on(e,t,r){return this.state===dr.joined&&e===Pr.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}send(e){return __async(this,arguments,function*(e,t={}){var r,s;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var s,n,i;const o=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(i=null===(n=null===(s=this.params)||void 0===s?void 0:s.config)||void 0===n?void 0:n.broadcast)||void 0===i?void 0:i.ack)||r("ok"),o.receive("ok",()=>r("ok")),o.receive("error",()=>r("error")),o.receive("timeout",()=>r("timed out"))});{const{event:i,payload:o}=e,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const e=yield this._fetchWithTimeout(this.broadcastEndpointURL,a,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return yield null===(s=e.body)||void 0===s?void 0:s.cancel(),e.ok?"ok":"error"}catch(n){return"AbortError"===n.name?"timed out":"error"}}})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=dr.leaving;const onClose=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(pr.close,"leave",this._joinRef())};this.joinPush.destroy();let t=null;return new Promise(r=>{t=new jr(this,pr.leave,{},e),t.receive("ok",()=>{onClose(),r("ok")}).receive("timeout",()=>{onClose(),r("timed out")}).receive("error",()=>{r("error")}),t.send(),this._canPush()||t.trigger("ok",{})}).finally(()=>{null==t||t.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=dr.closed,this.bindings={}}_fetchWithTimeout(e,t,r){return __async(this,null,function*(){const s=new AbortController,n=setTimeout(()=>s.abort(),r),i=yield this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(n),i})}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new jr(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,n;const i=e.toLocaleLowerCase(),{close:o,error:a,leave:l,join:c}=pr;if(r&&[o,a,l,c].indexOf(i)>=0&&r!==this._joinRef())return;let u=this._onMessage(i,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null===(s=this.bindings.postgres_changes)||void 0===s||s.filter(e=>{var t,r,s;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(s=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===s?void 0:s.toLocaleLowerCase())===i}).map(e=>e.callback(u,r)):null===(n=this.bindings[i])||void 0===n||n.filter(e=>{var r,s,n,o,a,l;if(["broadcast","presence","postgres_changes"].includes(i)){if("id"in e){const i=e.id,o=null===(r=e.filter)||void 0===r?void 0:r.event;return i&&(null===(s=t.ids)||void 0===s?void 0:s.includes(i))&&("*"===o||(null==o?void 0:o.toLocaleLowerCase())===(null===(n=t.data)||void 0===n?void 0:n.type.toLocaleLowerCase()))}{const r=null===(a=null===(o=null==e?void 0:e.filter)||void 0===o?void 0:o.event)||void 0===a?void 0:a.toLocaleLowerCase();return"*"===r||r===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===i}).map(e=>{if("object"==typeof u&&"ids"in u){const e=u.data,{schema:t,table:r,commit_timestamp:s,type:n,errors:i}=e,o={schema:t,table:r,commit_timestamp:s,eventType:n,new:{},old:{},errors:i};u=Object.assign(Object.assign({},o),this._getPayloadRecords(e))}e.callback(u,r)})}_isClosed(){return this.state===dr.closed}_isJoined(){return this.state===dr.joined}_isJoining(){return this.state===dr.joining}_isLeaving(){return this.state===dr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),n={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(n):this.bindings[s]=[n],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var s;return!((null===(s=e.type)||void 0===s?void 0:s.toLocaleLowerCase())===r&&Nr.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(pr.close,{},e)}_onError(e){this._on(pr.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=dr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=convertChangeData(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=convertChangeData(e.columns,e.old_record)),t}}const noop=()=>{},Ir=25e3,$r=10,Dr=100,Lr=[1e3,2e3,5e3,1e4];class Ur{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=cr,this.transport=null,this.heartbeatIntervalMs=Ir,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=noop,this.ref=0,this.reconnectTimer=null,this.logger=noop,this.conn=null,this.sendBuffer=[],this.serializer=new wr,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>__vitePreload(()=>__async(this,null,function*(){const{default:e}=yield Promise.resolve().then(()=>Wt);return{default:e}}),void 0).then(({default:t})=>t(...e)).catch(e=>{throw new Error(`Failed to load @supabase/node-fetch: ${e.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):fetch),(...e)=>t(...e)},!(null===(r=null==t?void 0:t.params)||void 0===r?void 0:r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${gr.websocket}`,this.httpEndpoint=httpEndpointURL(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=lr.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error(`${t}\n\nTo use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })`);throw new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}removeChannel(e){return __async(this,null,function*(){const t=yield e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t})}removeAllChannels(){return __async(this,null,function*(){const e=yield Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e})}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case ur.connecting:return yr.Connecting;case ur.open:return yr.Open;case ur.closing:return yr.Closing;default:return yr.Closed}}isConnected(){return this.connectionState()===yr.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(e=>e.topic===r);if(s)return s;{const r=new Nr(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){const{topic:t,event:r,payload:s,ref:n}=e,callback=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${r} (${n})`,s),this.isConnected()?callback():this.sendBuffer.push(callback)}setAuth(e=null){return __async(this,null,function*(){this._authPromise=this._performAuth(e);try{yield this._authPromise}finally{this._authPromise=null}})}sendHeartbeat(){return __async(this,null,function*(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},Dr)}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}})}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event)try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error")}catch(a){this.log("error","error in heartbeat callback",a)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:t,event:r,payload:s,ref:n}=e,i=n?`(${n})`:"",o=s.status||"";this.log("receive",`${o} ${t} ${r} ${i}`.trim(),s),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,s,n)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(pr.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const r=e.match(/\?/)?"&":"?";return`${e}${r}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}_performAuth(e=null){return __async(this,null,function*(){let t;t=e||(this.accessToken?yield this.accessToken():this.accessTokenValue),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{const r={access_token:t,version:"realtime-js/2.75.0"};t&&e.updateJoinPayload(r),e.joinedOnce&&e._isJoined()&&e._push(pr.access_token,{access_token:t})}))})}_waitForAuthIfNeeded(){return __async(this,null,function*(){this._authPromise&&(yield this._authPromise)})}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new xr(()=>__async(this,null,function*(){setTimeout(()=>__async(this,null,function*(){yield this._waitForAuthIfNeeded(),this.isConnected()||this.connect()}),$r)}),this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,n,i,o,a,l,c;if(this.transport=null!==(t=null==e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(r=null==e?void 0:e.timeout)&&void 0!==r?r:cr,this.heartbeatIntervalMs=null!==(s=null==e?void 0:e.heartbeatIntervalMs)&&void 0!==s?s:Ir,this.worker=null!==(n=null==e?void 0:e.worker)&&void 0!==n&&n,this.accessToken=null!==(i=null==e?void 0:e.accessToken)&&void 0!==i?i:null,this.heartbeatCallback=null!==(o=null==e?void 0:e.heartbeatCallback)&&void 0!==o?o:noop,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(a=null==e?void 0:e.reconnectAfterMs)&&void 0!==a?a:e=>Lr[e-1]||1e4,this.encode=null!==(l=null==e?void 0:e.encode)&&void 0!==l?l:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(c=null==e?void 0:e.decode)&&void 0!==c?c:this.serializer.decode.bind(this.serializer),this.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}class Br extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function isStorageError(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class Fr extends Br{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class qr extends Br{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var __awaiter$7=function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function fulfilled(e){try{step(s.next(e))}catch(t){i(t)}}function rejected(e){try{step(s.throw(e))}catch(t){i(t)}}function step(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())})};const resolveFetch$2=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>__vitePreload(()=>__async(null,null,function*(){const{default:e}=yield Promise.resolve().then(()=>Wt);return{default:e}}),void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},recursiveToCamel=e=>{if(Array.isArray(e))return e.map(e=>recursiveToCamel(e));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([e,r])=>{const s=e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[s]=recursiveToCamel(r)}),t};var __awaiter$6=function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function fulfilled(e){try{step(s.next(e))}catch(t){i(t)}}function rejected(e){try{step(s.throw(e))}catch(t){i(t)}}function step(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())})};const _getErrorMessage$1=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),handleError$1=(e,t,r)=>__awaiter$6(void 0,void 0,void 0,function*(){const s=yield __awaiter$7(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield __vitePreload(()=>Promise.resolve().then(()=>Wt),void 0)).Response:Response});e instanceof s&&!(null==r?void 0:r.noResolveJson)?e.json().then(r=>{const s=e.status||500,n=(null==r?void 0:r.statusCode)||s+"";t(new Fr(_getErrorMessage$1(r),s,n))}).catch(e=>{t(new qr(_getErrorMessage$1(e),e))}):t(new qr(_getErrorMessage$1(e),e))}),_getRequestParams$1=(e,t,r,s)=>{const n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&s?((e=>{if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)})(s)?(n.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),n.body=JSON.stringify(s)):n.body=s,(null==t?void 0:t.duplex)&&(n.duplex=t.duplex),Object.assign(Object.assign({},n),r)):n};function _handleRequest$1(e,t,r,s,n,i){return __awaiter$6(this,void 0,void 0,function*(){return new Promise((o,a)=>{e(r,_getRequestParams$1(t,s,n,i)).then(e=>{if(!e.ok)throw e;return(null==s?void 0:s.noResolveJson)?e:e.json()}).then(e=>o(e)).catch(e=>handleError$1(e,a,s))})})}function get(e,t,r,s){return __awaiter$6(this,void 0,void 0,function*(){return _handleRequest$1(e,"GET",t,r,s)})}function post(e,t,r,s,n){return __awaiter$6(this,void 0,void 0,function*(){return _handleRequest$1(e,"POST",t,s,n,r)})}function put(e,t,r,s,n){return __awaiter$6(this,void 0,void 0,function*(){return _handleRequest$1(e,"PUT",t,s,n,r)})}function remove(e,t,r,s,n){return __awaiter$6(this,void 0,void 0,function*(){return _handleRequest$1(e,"DELETE",t,s,n,r)})}var __awaiter$5=function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function fulfilled(e){try{step(s.next(e))}catch(t){i(t)}}function rejected(e){try{step(s.throw(e))}catch(t){i(t)}}function step(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())})};class Hr{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return __awaiter$5(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}})}}var __awaiter$4=function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function fulfilled(e){try{step(s.next(e))}catch(t){i(t)}}function rejected(e){try{step(s.throw(e))}catch(t){i(t)}}function step(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())})};class Mr{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}asStream(){return new Hr(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.execute().then(e,t)}execute(){return __awaiter$4(this,void 0,void 0,function*(){try{const e=yield this.downloadFn();return{data:yield e.blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}})}}var __awaiter$3=function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function fulfilled(e){try{step(s.next(e))}catch(t){i(t)}}function rejected(e){try{step(s.throw(e))}catch(t){i(t)}}function step(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())})};const zr={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Wr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Vr{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=resolveFetch$2(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,s){return __awaiter$3(this,void 0,void 0,function*(){try{let n;const i=Object.assign(Object.assign({},Wr),s);let o=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(i.upsert)});const a=i.metadata;"undefined"!=typeof Blob&&r instanceof Blob?(n=new FormData,n.append("cacheControl",i.cacheControl),a&&n.append("metadata",this.encodeMetadata(a)),n.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(n=r,n.append("cacheControl",i.cacheControl),a&&n.append("metadata",this.encodeMetadata(a))):(n=r,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,a&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),(null==s?void 0:s.headers)&&(o=Object.assign(Object.assign({},o),s.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),u=yield("PUT"==e?put:post)(this.fetch,`${this.url}/object/${c}`,n,Object.assign({headers:o},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{}));return{data:{path:l,id:u.Id,fullPath:u.Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(isStorageError(n))return{data:null,error:n};throw n}})}upload(e,t,r){return __awaiter$3(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return __awaiter$3(this,void 0,void 0,function*(){const n=this._removeEmptyFolders(e),i=this._getFinalPath(n),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:Wr.upsert},s),i=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r,e.append("cacheControl",t.cacheControl)):(e=r,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType);return{data:{path:n,fullPath:(yield put(this.fetch,o.toString(),e,{headers:i})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(isStorageError(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(e,t){return __awaiter$3(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(s["x-upsert"]="true");const n=yield post(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),i=new URL(this.url+n.url),o=i.searchParams.get("token");if(!o)throw new Br("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(isStorageError(r))return{data:null,error:r};throw r}})}update(e,t,r){return __awaiter$3(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(isStorageError(s))return{data:null,error:s};throw s}})}copy(e,t,r){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:{path:(yield post(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(isStorageError(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return __awaiter$3(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),n=yield post(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers});const i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return n={signedUrl:encodeURI(`${this.url}${n.signedURL}${i}`)},{data:n,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(isStorageError(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return __awaiter$3(this,void 0,void 0,function*(){try{const s=yield post(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),n=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:s.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${n}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(isStorageError(s))return{data:null,error:s};throw s}})}download(e,t){const r=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),n=s?`?${s}`:"",i=this._getFinalPath(e);return new Mr(()=>get(this.fetch,`${this.url}/${r}/${i}${n}`,{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}info(e){return __awaiter$3(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const e=yield get(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:recursiveToCamel(e),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(isStorageError(r))return{data:null,error:r};throw r}})}exists(e){return __awaiter$3(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield function(e,t,r,s){return __awaiter$6(this,void 0,void 0,function*(){return _handleRequest$1(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(isStorageError(r)&&r instanceof qr){const e=r.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],n=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==n&&s.push(n);const i=void 0!==(null==t?void 0:t.transform)?"render/image":"object",o=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==o&&s.push(o);let a=s.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${a}`)}}}remove(e){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield remove(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(isStorageError(t))return{data:null,error:t};throw t}})}list(e,t,r){return __awaiter$3(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},zr),t),{prefix:e||""});return{data:yield post(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(isStorageError(s))return{data:null,error:s};throw s}})}listV2(e,t){return __awaiter$3(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield post(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(isStorageError(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Jr={"X-Client-Info":"storage-js/2.75.0"};var __awaiter$2=function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function fulfilled(e){try{step(s.next(e))}catch(t){i(t)}}function rejected(e){try{step(s.throw(e))}catch(t){i(t)}}function step(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())})};class Gr{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const n=new URL(e);if(null==s?void 0:s.useNewHostname){/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase."))}this.url=n.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Jr),t),this.fetch=resolveFetch$2(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return __awaiter$2(this,void 0,void 0,function*(){try{return{data:yield get(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}})}getBucket(e){return __awaiter$2(this,void 0,void 0,function*(){try{return{data:yield get(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(isStorageError(t))return{data:null,error:t};throw t}})}createBucket(e){return __awaiter$2(this,arguments,void 0,function*(e,t={public:!1}){try{return{data:yield post(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(isStorageError(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return __awaiter$2(this,void 0,void 0,function*(){try{return{data:yield put(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(isStorageError(r))return{data:null,error:r};throw r}})}emptyBucket(e){return __awaiter$2(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(isStorageError(t))return{data:null,error:t};throw t}})}deleteBucket(e){return __awaiter$2(this,void 0,void 0,function*(){try{return{data:yield remove(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(isStorageError(t))return{data:null,error:t};throw t}})}}class Kr extends Gr{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new Vr(this.url,this.headers,e,this.fetch)}}const Yr={"X-Client-Info":"supabase-js/2.30.0"};var Xr,Qr={exports:{}};var Zr=(Xr||(Xr=1,function(e,t){var r,s="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==E&&E,n=function(){function F(){this.fetch=!1,this.DOMException=s.DOMException}return F.prototype=s,new F}();r=n,function(e){var t=void 0!==r&&r||"undefined"!=typeof self&&self||void 0!==E&&E||{},s="URLSearchParams"in t,n="Symbol"in t&&"iterator"in Symbol,i="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in t,a="ArrayBuffer"in t;if(a)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&l.indexOf(Object.prototype.toString.call(e))>-1};function normalizeName(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function normalizeValue(e){return"string"!=typeof e&&(e=String(e)),e}function iteratorFor(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function Headers2(e){this.map={},e instanceof Headers2?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function consumed(e){if(!e._noBody)return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function fileReaderReady(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function readBlobAsArrayBuffer(e){var t=new FileReader,r=fileReaderReady(t);return t.readAsArrayBuffer(e),r}function bufferClone(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function Body(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:s&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a&&i&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=bufferClone(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=bufferClone(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):s&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=consumed(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=consumed(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}if(i)return this.blob().then(readBlobAsArrayBuffer);throw new Error("could not read as ArrayBuffer")},this.text=function(){var e,t,r,s,n,i=consumed(this);if(i)return i;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=fileReaderReady(t),s=/charset=([A-Za-z0-9_-]+)/.exec(e.type),n=s?s[1]:"utf-8",t.readAsText(e,n),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),s=0;s<t.length;s++)r[s]=String.fromCharCode(t[s]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(decode)}),this.json=function(){return this.text().then(JSON.parse)},this}Headers2.prototype.append=function(e,t){e=normalizeName(e),t=normalizeValue(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},Headers2.prototype.delete=function(e){delete this.map[normalizeName(e)]},Headers2.prototype.get=function(e){return e=normalizeName(e),this.has(e)?this.map[e]:null},Headers2.prototype.has=function(e){return this.map.hasOwnProperty(normalizeName(e))},Headers2.prototype.set=function(e,t){this.map[normalizeName(e)]=normalizeValue(t)},Headers2.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},Headers2.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),iteratorFor(e)},Headers2.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),iteratorFor(e)},Headers2.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),iteratorFor(e)},n&&(Headers2.prototype[Symbol.iterator]=Headers2.prototype.entries);var u=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function Request2(e,r){if(!(this instanceof Request2))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var s,n,i=(r=r||{}).body;if(e instanceof Request2){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,r.headers||(this.headers=new Headers2(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=r.credentials||this.credentials||"same-origin",!r.headers&&this.headers||(this.headers=new Headers2(r.headers)),this.method=(s=r.method||this.method||"GET",n=s.toUpperCase(),u.indexOf(n)>-1?n:s),this.mode=r.mode||this.mode||null,this.signal=r.signal||this.signal||function(){if("AbortController"in t)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(i),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==r.cache&&"no-cache"!==r.cache)){var o=/([?&])_=[^&]*/;o.test(this.url)?this.url=this.url.replace(o,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function decode(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),s=r.shift().replace(/\+/g," "),n=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(s),decodeURIComponent(n))}}),t}function Response2(e,t){if(!(this instanceof Response2))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new Headers2(t.headers),this.url=t.url||"",this._initBody(e)}Request2.prototype.clone=function(){return new Request2(this,{body:this._bodyInit})},Body.call(Request2.prototype),Body.call(Response2.prototype),Response2.prototype.clone=function(){return new Response2(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers2(this.headers),url:this.url})},Response2.error=function(){var e=new Response2(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var h=[301,302,303,307,308];Response2.redirect=function(e,t){if(-1===h.indexOf(t))throw new RangeError("Invalid status code");return new Response2(null,{status:t,headers:{location:e}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(d){e.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function fetch2(r,s){return new Promise(function(n,o){var l=new Request2(r,s);if(l.signal&&l.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var c=new XMLHttpRequest;function abortXhr(){c.abort()}if(c.onload=function(){var e,t,r={statusText:c.statusText,headers:(e=c.getAllResponseHeaders()||"",t=new Headers2,e.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e}).forEach(function(e){var r=e.split(":"),s=r.shift().trim();if(s){var n=r.join(":").trim();try{t.append(s,n)}catch(i){console.warn("Response "+i.message)}}}),t)};0===l.url.indexOf("file://")&&(c.status<200||c.status>599)?r.status=200:r.status=c.status,r.url="responseURL"in c?c.responseURL:r.headers.get("X-Request-URL");var s="response"in c?c.response:c.responseText;setTimeout(function(){n(new Response2(s,r))},0)},c.onerror=function(){setTimeout(function(){o(new TypeError("Network request failed"))},0)},c.ontimeout=function(){setTimeout(function(){o(new TypeError("Network request timed out"))},0)},c.onabort=function(){setTimeout(function(){o(new e.DOMException("Aborted","AbortError"))},0)},c.open(l.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch(r){return e}}(l.url),!0),"include"===l.credentials?c.withCredentials=!0:"omit"===l.credentials&&(c.withCredentials=!1),"responseType"in c&&(i?c.responseType="blob":a&&(c.responseType="arraybuffer")),s&&"object"==typeof s.headers&&!(s.headers instanceof Headers2||t.Headers&&s.headers instanceof t.Headers)){var u=[];Object.getOwnPropertyNames(s.headers).forEach(function(e){u.push(normalizeName(e)),c.setRequestHeader(e,normalizeValue(s.headers[e]))}),l.headers.forEach(function(e,t){-1===u.indexOf(t)&&c.setRequestHeader(t,e)})}else l.headers.forEach(function(e,t){c.setRequestHeader(t,e)});l.signal&&(l.signal.addEventListener("abort",abortXhr),c.onreadystatechange=function(){4===c.readyState&&l.signal.removeEventListener("abort",abortXhr)}),c.send(void 0===l._bodyInit?null:l._bodyInit)})}fetch2.polyfill=!0,t.fetch||(t.fetch=fetch2,t.Headers=Headers2,t.Request=Request2,t.Response=Response2),e.Headers=Headers2,e.Request=Request2,e.Response=Response2,e.fetch=fetch2,Object.defineProperty(e,"__esModule",{value:!0})}({}),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=s.fetch?s:n;(t=i.fetch).default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t}(Qr,Qr.exports)),Qr.exports);const es=b(Zr),ts=_mergeNamespaces({__proto__:null,default:es},[Zr]);var __awaiter$1=function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function fulfilled(e){try{step(s.next(e))}catch(t){i(t)}}function rejected(e){try{step(s.throw(e))}catch(t){i(t)}}function step(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())})};const fetchWithAuth=(e,t,r)=>{const s=(e=>{let t;return t=e||("undefined"==typeof fetch?es:fetch),(...e)=>t(...e)})(r),n="undefined"==typeof Headers?Zr.Headers:Headers;return(r,i)=>__awaiter$1(void 0,void 0,void 0,function*(){var o;const a=null!==(o=yield t())&&void 0!==o?o:e;let l=new n(null==i?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${a}`),s(r,Object.assign(Object.assign({},i),{headers:l}))})};const isBrowser=()=>"undefined"!=typeof document,rs={tested:!1,writable:!1},supportsLocalStorage=()=>{if(!isBrowser())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(t){return!1}if(rs.tested)return rs.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),rs.tested=!0,rs.writable=!0}catch(t){rs.tested=!0,rs.writable=!1}return rs.writable};function getParameterByName(e,t){var r;t||(t=(null===(r=null===window||void 0===window?void 0:window.location)||void 0===r?void 0:r.href)||""),e=e.replace(/[\[\]]/g,"\\$&");const s=new RegExp("[?&#]"+e+"(=([^&#]*)|&|#|$)").exec(t);return s?s[2]?decodeURIComponent(s[2].replace(/\+/g," ")):"":null}const resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>__async(null,null,function*(){return yield(yield __vitePreload(()=>__async(null,null,function*(){const{fetch:e}=yield Promise.resolve().then(()=>ts);return{fetch:e}}),void 0)).fetch(...e)}):fetch),(...e)=>t(...e)},setItemAsync=(e,t,r)=>__async(null,null,function*(){yield e.setItem(t,JSON.stringify(r))}),getItemAsync=(e,t)=>__async(null,null,function*(){const r=yield e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(s){return r}}),removeItemAsync=(e,t)=>__async(null,null,function*(){yield e.removeItem(t)});class ss{constructor(){this.promise=new ss.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function decodeJWTPayload(e){const t=e.split(".");if(3!==t.length)throw new Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=t[1];return JSON.parse(function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let r,s,n,i,o,a,l,c="",u=0;for(e=e.replace("-","+").replace("_","/");u<e.length;)i=t.indexOf(e.charAt(u++)),o=t.indexOf(e.charAt(u++)),a=t.indexOf(e.charAt(u++)),l=t.indexOf(e.charAt(u++)),r=i<<2|o>>4,s=(15&o)<<4|a>>2,n=(3&a)<<6|l,c+=String.fromCharCode(r),64!=a&&0!=s&&(c+=String.fromCharCode(s)),64!=l&&0!=n&&(c+=String.fromCharCode(n));return c}(r))}function dec2hex(e){return("0"+e.toString(16)).substr(-2)}function generatePKCEVerifier(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let r="";for(let s=0;s<56;s++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,dec2hex).join("")}function generatePKCEChallenge(e){return __async(this,null,function*(){if("undefined"==typeof crypto)return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=yield function(e){return __async(this,null,function*(){const t=(new TextEncoder).encode(e),r=yield crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(e=>String.fromCharCode(e)).join("")})}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")})}ss.promiseConstructor=Promise;const ns=/__stack_guard__([a-zA-Z0-9_-]+)__/;let is,os=!1;function isInStackGuard(e){var t,r;let s;is();try{throw new Error}catch(i){s=i}const n=null!==(r=null===(t=s.stack)||void 0===t?void 0:t.split("\n"))&&void 0!==r?r:[];for(let o=0;o<n.length;o+=1){const t=n[o].match(ns);if(t&&t[1]===e)return!0}return!1}function stackGuard(e,t){return __async(this,null,function*(){yield is();const r=`__stack_guard__${e}__`,s={[r]:()=>__async(null,null,function*(){return yield t()})};return yield s[r]()})}is=()=>__async(null,null,function*(){os||(os=!0,yield stackGuard("ENV_CHECK",()=>__async(null,null,function*(){const e=isInStackGuard("ENV_CHECK");return e||console.warn("@supabase/gotrue-js: Stack guards not supported in this environment. Generally not an issue but may point to a very conservative transpilation environment (use ES2017 or above) that implements async/await with generators, or this is a JavaScript engine that does not support async/await stack traces."),e})))});class as extends Error{constructor(e,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t}}function isAuthError(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class ls extends as{constructor(e,t){super(e,t),this.name="AuthApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class cs extends as{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class us extends as{constructor(e,t,r){super(e),this.name=t,this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class hs extends us{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class ds extends us{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class fs extends us{constructor(e){super(e,"AuthInvalidCredentialsError",400)}}class ps extends us{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ms extends us{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class gs extends us{constructor(e,t){super(e,"AuthRetryableFetchError",t)}}function isAuthRetryableFetchError(e){return isAuthError(e)&&"AuthRetryableFetchError"===e.name}const _getErrorMessage=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ys=[502,503,504];function handleError(e){return __async(this,null,function*(){if(!("object"==typeof(t=e)&&null!==t&&"status"in t&&"ok"in t&&"json"in t&&"function"==typeof t.json))throw new gs(_getErrorMessage(e),0);var t;if(ys.includes(e.status))throw new gs(_getErrorMessage(e),e.status);let r;try{r=yield e.json()}catch(s){throw new cs(_getErrorMessage(s),s)}throw new ls(_getErrorMessage(r),e.status||500)})}function _request(e,t,r,s){return __async(this,null,function*(){var n;const i=Object.assign({},null==s?void 0:s.headers);(null==s?void 0:s.jwt)&&(i.Authorization=`Bearer ${s.jwt}`);const o=null!==(n=null==s?void 0:s.query)&&void 0!==n?n:{};(null==s?void 0:s.redirectTo)&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=yield function(e,t,r,s,n,i){return __async(this,null,function*(){const o=((e,t,r,s)=>{const n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))})(t,s,n,i);let a;try{a=yield e(r,o)}catch(l){throw console.error(l),new gs(_getErrorMessage(l),0)}if(a.ok||(yield handleError(a)),null==s?void 0:s.noResolveJson)return a;try{return yield a.json()}catch(l){yield handleError(l)}})}(e,t,r+a,{headers:i,noResolveJson:null==s?void 0:s.noResolveJson},{},null==s?void 0:s.body);return(null==s?void 0:s.xform)?null==s?void 0:s.xform(l):{data:Object.assign({},l),error:null}})}function _sessionResponse(e){var t;let r=null;var s;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(r=Object.assign({},e),r.expires_at=(s=e.expires_in,Math.round(Date.now()/1e3)+s));return{data:{session:r,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function _userResponse(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function _ssoResponse(e){return{data:e,error:null}}function _generateLinkResponse(e){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i}=e,o=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]])}return r}(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i},user:Object.assign({},o)},error:null}}function _noResolveJsonResponse(e){return e}class vs{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=resolveFetch(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(e,t="global"){return __async(this,null,function*(){try{return yield _request(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(isAuthError(r))return{data:null,error:r};throw r}})}inviteUserByEmail(e){return __async(this,arguments,function*(e,t={}){try{return yield _request(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:_userResponse})}catch(r){if(isAuthError(r))return{data:{user:null},error:r};throw r}})}generateLink(e){return __async(this,null,function*(){try{const{options:t}=e,r=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]])}return r}(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=null==r?void 0:r.newEmail,delete s.newEmail),yield _request(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:_generateLinkResponse,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if(isAuthError(t))return{data:{properties:null,user:null},error:t};throw t}})}createUser(e){return __async(this,null,function*(){try{return yield _request(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:_userResponse})}catch(t){if(isAuthError(t))return{data:{user:null},error:t};throw t}})}listUsers(e){return __async(this,null,function*(){var t,r,s,n,i,o,a;try{const l={nextPage:null,lastPage:0,total:0},c=yield _request(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(n=null===(s=null==e?void 0:e.perPage)||void 0===s?void 0:s.toString())&&void 0!==n?n:""},xform:_noResolveJsonResponse});if(c.error)throw c.error;const u=yield c.json(),h=null!==(i=c.headers.get("x-total-count"))&&void 0!==i?i:0,d=null!==(a=null===(o=c.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==a?a:[];return d.length>0&&(d.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(h)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(isAuthError(l))return{data:{users:[]},error:l};throw l}})}getUserById(e){return __async(this,null,function*(){try{return yield _request(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:_userResponse})}catch(t){if(isAuthError(t))return{data:{user:null},error:t};throw t}})}updateUserById(e,t){return __async(this,null,function*(){try{return yield _request(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:_userResponse})}catch(r){if(isAuthError(r))return{data:{user:null},error:r};throw r}})}deleteUser(e,t=!1){return __async(this,null,function*(){try{return yield _request(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:_userResponse})}catch(r){if(isAuthError(r))return{data:{user:null},error:r};throw r}})}_listFactors(e){return __async(this,null,function*(){try{const{data:t,error:r}=yield _request(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}})}_deleteFactor(e){return __async(this,null,function*(){try{return{data:yield _request(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}})}}const bs={"X-Client-Info":"gotrue-js/2.43.1"},_s={getItem:e=>supportsLocalStorage()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{supportsLocalStorage()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{supportsLocalStorage()&&globalThis.localStorage.removeItem(e)}};!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const ws={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:bs,flowType:"implicit",debug:!1},xs=3e4;class js{constructor(e){var t;this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.broadcastChannel=null,this.instanceID=js.nextInstanceID,js.nextInstanceID+=1,this.instanceID>0&&isBrowser()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},ws),e);if(this.logDebugMessages=r.debug,this.inMemorySession=null,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.persistSession=r.persistSession,this.storage=r.storage||_s,this.admin=new vs({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=resolveFetch(r.fetch),this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession&&this.storage===_s&&!supportsLocalStorage()&&console.warn("No storage option exists to persist the session, which may result in unexpected behavior when using auth.\n        If you want to set persistSession to true, please provide a storage option or you may set persistSession to false to disable this warning."),isBrowser()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}null===(t=this.broadcastChannel)||void 0===t||t.addEventListener("message",e=>__async(this,null,function*(){this._debug("received broadcast notification from other tab or client",e),yield this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&(this.instanceID,(new Date).toISOString()),this}initialize(){return this.initializePromise?this.initializePromise:this._initialize()}_initialize(){return __async(this,null,function*(){if(this.initializePromise)throw new Error("Double call of #_initialize()");return this.initializePromise=stackGuard("_initialize",()=>__async(this,null,function*(){try{const e=!!isBrowser()&&(yield this._isPKCEFlow());if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:t,error:r}=yield this._getSessionFromUrl(e);if(r)return this._debug("#_initialize()","error detecting session from URL",r),yield this._removeSession(),{error:r};const{session:s,redirectType:n}=t;return this._debug("#_initialize()","detected session in URL",s,"redirect type",n),yield this._saveSession(s),setTimeout(()=>__async(this,null,function*(){"recovery"===n?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",s):yield this._notifyAllSubscribers("SIGNED_IN",s)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(e){return isAuthError(e)?{error:e}:{error:new cs("Unexpected error during initialization",e)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})),yield this.initializePromise})}signUp(e){return __async(this,null,function*(){var t,r,s;try{let n;if(yield this._removeSession(),"email"in e){const{email:r,password:s,options:i}=e;let o=null,a=null;if("pkce"===this.flowType){const e=generatePKCEVerifier();yield setItemAsync(this.storage,`${this.storageKey}-code-verifier`,e),o=yield generatePKCEChallenge(e),a=e===o?"plain":"s256"}n=yield _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==i?void 0:i.emailRedirectTo,body:{email:r,password:s,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:o,code_challenge_method:a},xform:_sessionResponse})}else{if(!("phone"in e))throw new fs("You must provide either an email or phone number and a password");{const{phone:t,password:i,options:o}=e;n=yield _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:i,data:null!==(r=null==o?void 0:o.data)&&void 0!==r?r:{},channel:null!==(s=null==o?void 0:o.channel)&&void 0!==s?s:"sms",gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},xform:_sessionResponse})}}const{data:i,error:o}=n;if(o||!i)return{data:{user:null,session:null},error:o};const a=i.session,l=i.user;return i.session&&(yield this._saveSession(i.session),yield this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(n){if(isAuthError(n))return{data:{user:null,session:null},error:n};throw n}})}signInWithPassword(e){return __async(this,null,function*(){try{let t;if(yield this._removeSession(),"email"in e){const{email:r,password:s,options:n}=e;t=yield _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:_sessionResponse})}else{if(!("phone"in e))throw new fs("You must provide either an email or phone number and a password");{const{phone:r,password:s,options:n}=e;t=yield _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:_sessionResponse})}}const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:r&&r.session&&r.user?(r.session&&(yield this._saveSession(r.session),yield this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:{user:r.user,session:r.session},error:s}):{data:{user:null,session:null},error:new ds}}catch(t){if(isAuthError(t))return{data:{user:null,session:null},error:t};throw t}})}signInWithOAuth(e){return __async(this,null,function*(){var t,r,s,n;return yield this._removeSession(),yield this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(s=e.options)||void 0===s?void 0:s.queryParams,skipBrowserRedirect:null===(n=e.options)||void 0===n?void 0:n.skipBrowserRedirect})})}exchangeCodeForSession(e){return __async(this,null,function*(){const t=yield getItemAsync(this.storage,`${this.storageKey}-code-verifier`),{data:r,error:s}=yield _request(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:t},xform:_sessionResponse});return yield removeItemAsync(this.storage,`${this.storageKey}-code-verifier`),s?{data:{user:null,session:null},error:s}:r&&r.session&&r.user?(r.session&&(yield this._saveSession(r.session),yield this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:r,error:s}):{data:{user:null,session:null},error:new ds}})}signInWithIdToken(e){return __async(this,null,function*(){yield this._removeSession();try{const{options:t,provider:r,token:s,access_token:n,nonce:i}=e,o=yield _request(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:n,nonce:i,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:_sessionResponse}),{data:a,error:l}=o;return l?{data:{user:null,session:null},error:l}:a&&a.session&&a.user?(a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:l}):{data:{user:null,session:null},error:new ds}}catch(t){if(isAuthError(t))return{data:{user:null,session:null},error:t};throw t}})}signInWithOtp(e){return __async(this,null,function*(){var t,r,s,n,i;try{if(yield this._removeSession(),"email"in e){const{email:s,options:n}=e;let i=null,o=null;if("pkce"===this.flowType){const e=generatePKCEVerifier();yield setItemAsync(this.storage,`${this.storageKey}-code-verifier`,e),i=yield generatePKCEChallenge(e),o=e===i?"plain":"s256"}const{error:a}=yield _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:s,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},create_user:null===(r=null==n?void 0:n.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:i,code_challenge_method:o},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){const{phone:t,options:r}=e,{data:o,error:a}=yield _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(s=null==r?void 0:r.data)&&void 0!==s?s:{},create_user:null===(n=null==r?void 0:r.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(i=null==r?void 0:r.channel)&&void 0!==i?i:"sms"}});return{data:{user:null,session:null,messageId:null==o?void 0:o.message_id},error:a}}throw new fs("You must provide either an email or phone number.")}catch(o){if(isAuthError(o))return{data:{user:null,session:null},error:o};throw o}})}verifyOtp(e){return __async(this,null,function*(){var t,r;try{"email_change"!==e.type&&"phone_change"!==e.type&&(yield this._removeSession());const{data:s,error:n}=yield _request(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:null===(t=e.options)||void 0===t?void 0:t.captchaToken}}),redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,xform:_sessionResponse});if(n)throw n;if(!s)throw new Error("An error occurred on token verification.");const i=s.session,o=s.user;return(null==i?void 0:i.access_token)&&(yield this._saveSession(i),yield this._notifyAllSubscribers("SIGNED_IN",i)),{data:{user:o,session:i},error:null}}catch(s){if(isAuthError(s))return{data:{user:null,session:null},error:s};throw s}})}signInWithSSO(e){return __async(this,null,function*(){var t,r,s;try{return yield this._removeSession(),yield _request(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(s=null==e?void 0:e.options)||void 0===s?void 0:s.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0}),headers:this.headers,xform:_ssoResponse})}catch(n){if(isAuthError(n))return{data:null,error:n};throw n}})}reauthenticate(){return __async(this,null,function*(){try{return yield this._useSession(e=>__async(this,null,function*(){const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new hs;const{error:s}=yield _request(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}}))}catch(e){if(isAuthError(e))return{data:{user:null,session:null},error:e};throw e}})}resend(e){return __async(this,null,function*(){try{"email_change"!=e.type&&"phone_change"!=e.type&&(yield this._removeSession());const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:n}=e,{error:i}=yield _request(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){const{phone:r,type:s,options:n}=e,{data:i,error:o}=yield _request(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:o}}throw new fs("You must provide either an email or phone number and a type")}catch(t){if(isAuthError(t))return{data:{user:null,session:null},error:t};throw t}})}getSession(){return __async(this,null,function*(){return this._useSession(e=>__async(this,null,function*(){return e}))})}_useSession(e){return __async(this,null,function*(){return yield stackGuard("_useSession",()=>__async(this,null,function*(){const t=yield this.__loadSession();return yield e(t)}))})}__loadSession(){return __async(this,null,function*(){if(this._debug("#__loadSession()","begin"),this.logDebugMessages&&!isInStackGuard("_useSession"))throw new Error("Please use #_useSession()");isInStackGuard("_initialize")||(yield this.initializePromise);try{let e=null;if(this.persistSession){const t=yield getItemAsync(this.storage,this.storageKey);this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession()))}else e=this.inMemorySession,this._debug("#getSession()","session from memory",e);if(!e)return{data:{session:null},error:null};const t=!!e.expires_at&&e.expires_at<=Date.now()/1e3;if(this._debug("#__loadSession()",`session has${t?"":" not"} expired`,"expires_at",e.expires_at),!t)return{data:{session:e},error:null};const{session:r,error:s}=yield this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}})}getUser(e){return __async(this,null,function*(){try{return yield this._useSession(t=>__async(this,null,function*(){var r,s;if(!e){const{data:n,error:i}=t;if(i)throw i;e=null!==(s=null===(r=n.session)||void 0===r?void 0:r.access_token)&&void 0!==s?s:void 0}return yield _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:_userResponse})}))}catch(t){if(isAuthError(t))return{data:{user:null},error:t};throw t}})}updateUser(e){return __async(this,arguments,function*(e,t={}){try{return yield this._useSession(r=>__async(this,null,function*(){const{data:s,error:n}=r;if(n)throw n;if(!s.session)throw new hs;const i=s.session,{data:o,error:a}=yield _request(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:e,jwt:i.access_token,xform:_userResponse});if(a)throw a;return i.user=o.user,yield this._saveSession(i),yield this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}}))}catch(r){if(isAuthError(r))return{data:{user:null},error:r};throw r}})}_decodeJWT(e){return decodeJWTPayload(e)}setSession(e){return __async(this,null,function*(){try{if(!e.access_token||!e.refresh_token)throw new hs;const t=Date.now()/1e3;let r=t,s=!0,n=null;const i=decodeJWTPayload(e.access_token);if(i.exp&&(r=i.exp,s=r<=t),s){const{session:t,error:r}=yield this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};n=t}else{const{data:s,error:i}=yield this.getUser(e.access_token);if(i)throw i;n={access_token:e.access_token,refresh_token:e.refresh_token,user:s.user,token_type:"bearer",expires_in:r-t,expires_at:r},yield this._saveSession(n),yield this._notifyAllSubscribers("SIGNED_IN",n)}return{data:{user:n.user,session:n},error:null}}catch(t){if(isAuthError(t))return{data:{session:null,user:null},error:t};throw t}})}refreshSession(e){return __async(this,null,function*(){try{return yield this._useSession(t=>__async(this,null,function*(){var r;if(!e){const{data:s,error:n}=t;if(n)throw n;e=null!==(r=s.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new hs;const{session:s,error:n}=yield this._callRefreshToken(e.refresh_token);return n?{data:{user:null,session:null},error:n}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(isAuthError(t))return{data:{user:null,session:null},error:t};throw t}})}_getSessionFromUrl(e){return __async(this,null,function*(){try{if(!isBrowser())throw new ps("No browser detected.");if("implicit"===this.flowType&&!this._isImplicitGrantFlow())throw new ps("Not a valid implicit grant flow url.");if("pkce"==this.flowType&&!e)throw new ms("Not a valid PKCE flow url.");if(e){const e=getParameterByName("code");if(!e)throw new ms("No code detected.");const{data:t,error:r}=yield this.exchangeCodeForSession(e);if(r)throw r;if(!t.session)throw new ms("No session detected.");let s=new URL(window.location.href);return s.searchParams.delete("code"),window.history.replaceState(window.history.state,"",s.toString()),{data:{session:t.session,redirectType:null},error:null}}const t=getParameterByName("error_description");if(t){const e=getParameterByName("error_code");if(!e)throw new ps("No error_code detected.");const r=getParameterByName("error");if(!r)throw new ps("No error detected.");throw new ps(t,{error:r,code:e})}const r=getParameterByName("provider_token"),s=getParameterByName("provider_refresh_token"),n=getParameterByName("access_token");if(!n)throw new ps("No access_token detected.");const i=getParameterByName("expires_in");if(!i)throw new ps("No expires_in detected.");const o=getParameterByName("refresh_token");if(!o)throw new ps("No refresh_token detected.");const a=getParameterByName("token_type");if(!a)throw new ps("No token_type detected.");const l=Math.round(Date.now()/1e3)+parseInt(i),{data:c,error:u}=yield this.getUser(n);if(u)throw u;const h=c.user,d={provider_token:r,provider_refresh_token:s,access_token:n,expires_in:parseInt(i),expires_at:l,refresh_token:o,token_type:a,user:h},f=getParameterByName("type");return window.location.hash="",this._debug("#_getSessionFromUrl()","clearing window.location.hash"),{data:{session:d,redirectType:f},error:null}}catch(t){if(isAuthError(t))return{data:{session:null,redirectType:null},error:t};throw t}})}_isImplicitGrantFlow(){return isBrowser()&&(Boolean(getParameterByName("access_token"))||Boolean(getParameterByName("error_description")))}_isPKCEFlow(){return __async(this,null,function*(){const e=yield getItemAsync(this.storage,`${this.storageKey}-code-verifier`);return Boolean(getParameterByName("code"))&&Boolean(e)})}signOut(){return __async(this,arguments,function*({scope:e}={scope:"global"}){return yield this._useSession(t=>__async(this,null,function*(){var r;const{data:s,error:n}=t;if(n)return{error:n};const i=null===(r=s.session)||void 0===r?void 0:r.access_token;if(i){const{error:t}=yield this.admin.signOut(i,e);if(t&&(!function(e){return isAuthError(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status))return{error:t}}return"others"!==e&&(yield this._removeSession(),yield removeItemAsync(this.storage,`${this.storageKey}-code-verifier`),yield this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}}))})}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),this._emitInitialSession(t),{data:{subscription:r}}}_emitInitialSession(e){return __async(this,null,function*(){return yield this._useSession(t=>__async(this,null,function*(){var r,s;try{const{data:{session:s},error:n}=t;if(n)throw n;yield null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",s),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(n){yield null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",e,"error",n),console.error(n)}}))})}resetPasswordForEmail(e){return __async(this,arguments,function*(e,t={}){let r=null,s=null;if("pkce"===this.flowType){const e=generatePKCEVerifier();yield setItemAsync(this.storage,`${this.storageKey}-code-verifier`,e),r=yield generatePKCEChallenge(e),s=e===r?"plain":"s256"}try{return yield _request(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(n){if(isAuthError(n))return{data:null,error:n};throw n}})}_refreshAccessToken(e){return __async(this,null,function*(){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return yield(r=r=>__async(this,null,function*(){var s;return yield(s=200*r,new Promise(e=>{setTimeout(()=>e(null),s)})),this._debug(t,"refreshing attempt",r),yield _request(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:_sessionResponse})}),s=(e,t,r)=>r&&r.error&&isAuthRetryableFetchError(r.error)&&Date.now()+200*(e+1)-n<xs,new Promise((e,t)=>{__async(null,null,function*(){for(let i=0;i<1/0;i++)try{const t=yield r(i);if(!s(i,null,t))return void e(t)}catch(n){if(!s(i,n))return void t(n)}})}))}catch(n){if(this._debug(t,"error",n),isAuthError(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}var r,s})}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}_handleProviderSignIn(e,t){return __async(this,null,function*(){const r=yield this._getUrlForProvider(e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),isBrowser()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}})}_recoverAndRefresh(){return __async(this,null,function*(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=yield getItemAsync(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r))return this._debug(t,"session is not valid"),void(null!==r&&(yield this._removeSession()));const s=Math.round(Date.now()/1e3),n=(null!==(e=r.expires_at)&&void 0!==e?e:1/0)<s+10;if(this._debug(t,`session has${n?"":" not"} expired with margin of 10s`),n){if(this.autoRefreshToken&&r.refresh_token){const{error:e}=yield this._callRefreshToken(r.refresh_token);e&&(console.error(e),isAuthRetryableFetchError(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),yield this._removeSession()))}}else yield this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){return this._debug(t,"error",r),void console.error(r)}finally{this._debug(t,"end")}})}_callRefreshToken(e){return __async(this,null,function*(){var t,r;if(!e)throw new hs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new ss;const{data:t,error:r}=yield this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new hs;yield this._saveSession(t.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const s={session:t.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(n){if(this._debug(s,"error",n),isAuthError(n)){const e={session:null,error:n};return null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(n),n}finally{this.refreshingDeferred=null,this._debug(s,"end")}})}_notifyAllSubscribers(e,t,r=!0){return __async(this,null,function*(){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const s=[],n=Array.from(this.stateChangeEmitters.values()).map(r=>__async(this,null,function*(){try{yield r.callback(e,t)}catch(n){s.push(n)}}));if(yield Promise.all(n),s.length>0){for(let e=0;e<s.length;e+=1)console.error(s[e]);throw s[0]}}finally{this._debug(s,"end")}})}_saveSession(e){return __async(this,null,function*(){this._debug("#_saveSession()",e),this.persistSession||(this.inMemorySession=e),this.persistSession&&e.expires_at&&(yield this._persistSession(e))})}_persistSession(e){return this._debug("#_persistSession()",e),setItemAsync(this.storage,this.storageKey,e)}_removeSession(){return __async(this,null,function*(){this._debug("#_removeSession()"),this.persistSession?yield removeItemAsync(this.storage,this.storageKey):this.inMemorySession=null})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&isBrowser()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}_startAutoRefresh(){return __async(this,null,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),xs);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),yield this._autoRefreshTokenTick()})}_stopAutoRefresh(){return __async(this,null,function*(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)})}startAutoRefresh(){return __async(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return __async(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return __async(this,null,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{const t=Date.now();try{return yield this._useSession(e=>__async(this,null,function*(){const{data:{session:r}}=e;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const s=Math.floor((1e3*r.expires_at-t)/xs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),s<=3&&(yield this._callRefreshToken(r.refresh_token))}))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}_handleVisibilityChange(){return __async(this,null,function*(){if(this._debug("#_handleVisibilityChange()"),!isBrowser()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>__async(this,null,function*(){return yield this._onVisibilityChanged(!1)}),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}})}_onVisibilityChanged(e){return __async(this,null,function*(){this._debug(`#_onVisibilityChanged(${e})`,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(e||(yield this.initializePromise,yield this._recoverAndRefresh(),this._debug("#_onVisibilityChanged()","finished waiting for initialize, _recoverAndRefresh")),this.autoRefreshToken&&this._startAutoRefresh()):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(e,t){return __async(this,null,function*(){const r=[`provider=${encodeURIComponent(e)}`];if((null==t?void 0:t.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),(null==t?void 0:t.scopes)&&r.push(`scopes=${encodeURIComponent(t.scopes)}`),"pkce"===this.flowType){const e=generatePKCEVerifier();yield setItemAsync(this.storage,`${this.storageKey}-code-verifier`,e);const t=yield generatePKCEChallenge(e),s=e===t?"plain":"s256";this._debug("PKCE","code verifier",`${e.substring(0,5)}...`,"code challenge",t,"method",s);const n=new URLSearchParams({code_challenge:`${encodeURIComponent(t)}`,code_challenge_method:`${encodeURIComponent(s)}`});r.push(n.toString())}if(null==t?void 0:t.queryParams){const e=new URLSearchParams(t.queryParams);r.push(e.toString())}return`${this.url}/authorize?${r.join("&")}`})}_unenroll(e){return __async(this,null,function*(){try{return yield this._useSession(t=>__async(this,null,function*(){var r;const{data:s,error:n}=t;return n?{data:null,error:n}:yield _request(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token})}))}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}})}_enroll(e){return __async(this,null,function*(){try{return yield this._useSession(t=>__async(this,null,function*(){var r,s;const{data:n,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:a}=yield _request(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token});return a?{data:null,error:a}:((null===(s=null==o?void 0:o.totp)||void 0===s?void 0:s.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})}))}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}})}_verify(e){return __async(this,null,function*(){try{return yield this._useSession(t=>__async(this,null,function*(){var r;const{data:s,error:n}=t;if(n)return{data:null,error:n};const{data:i,error:o}=yield _request(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token});return o?{data:null,error:o}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})}))}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}})}_challenge(e){return __async(this,null,function*(){try{return yield this._useSession(t=>__async(this,null,function*(){var r;const{data:s,error:n}=t;return n?{data:null,error:n}:yield _request(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token})}))}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}})}_challengeAndVerify(e){return __async(this,null,function*(){const{data:t,error:r}=yield this._challenge({factorId:e.factorId});return r?{data:null,error:r}:yield this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})})}_listFactors(){return __async(this,null,function*(){const{data:{user:e},error:t}=yield this.getUser();if(t)return{data:null,error:t};const r=(null==e?void 0:e.factors)||[],s=r.filter(e=>"totp"===e.factor_type&&"verified"===e.status);return{data:{all:r,totp:s},error:null}})}_getAuthenticatorAssuranceLevel(){return __async(this,null,function*(){return yield this._useSession(e=>__async(this,null,function*(){var t,r;const{data:{session:s},error:n}=e;if(n)return{data:null,error:n};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const i=this._decodeJWT(s.access_token);let o=null;i.aal&&(o=i.aal);let a=o;(null!==(r=null===(t=s.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(a="aal2");return{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:i.amr||[]},error:null}}))})}}js.nextInstanceID=0;class Es extends js{constructor(e){super(e)}}var __awaiter=function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function fulfilled(e){try{step(s.next(e))}catch(t){i(t)}}function rejected(e){try{step(s.throw(e))}catch(t){i(t)}}function step(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())})};const Ts={headers:Yr},Ss={schema:"public"},ks={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ps={};class Os{constructor(e,t,r){var s,n,i,o,a,l,c,u;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const h=e.replace(/\/$/,"");this.realtimeUrl=`${h}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${h}/auth/v1`,this.storageUrl=`${h}/storage/v1`,this.functionsUrl=`${h}/functions/v1`;const d=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,f=function(e,t){const{db:r,auth:s,realtime:n,global:i}=e,{db:o,auth:a,realtime:l,global:c}=t;return{db:Object.assign(Object.assign({},o),r),auth:Object.assign(Object.assign({},a),s),realtime:Object.assign(Object.assign({},l),n),global:Object.assign(Object.assign({},c),i)}}(null!=r?r:{},{db:Ss,realtime:Ps,auth:Object.assign(Object.assign({},ks),{storageKey:d}),global:Ts});this.storageKey=null!==(n=null===(s=f.auth)||void 0===s?void 0:s.storageKey)&&void 0!==n?n:"",this.headers=null!==(o=null===(i=f.global)||void 0===i?void 0:i.headers)&&void 0!==o?o:{},this.auth=this._initSupabaseAuthClient(null!==(a=f.auth)&&void 0!==a?a:{},this.headers,null===(l=f.global)||void 0===l?void 0:l.fetch),this.fetch=fetchWithAuth(t,this._getAccessToken.bind(this),null===(c=f.global)||void 0===c?void 0:c.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},f.realtime)),this.rest=new rr(`${h}/rest/v1`,{headers:this.headers,schema:null===(u=f.db)||void 0===u?void 0:u.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new Rt(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Kr(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}rpc(e,t={},r){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return __awaiter(this,void 0,void 0,function*(){const{data:r}=yield this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:n,flowType:i,debug:o},a,l){const c={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Es({url:this.authUrl,headers:Object.assign(Object.assign({},c),a),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:i,debug:o,fetch:l})}_initRealtimeClient(e){return new Ur(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===r?"SIGNED_OUT"===e&&(this.realtime.setAuth(this.supabaseKey),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.realtime.setAuth(null!=r?r:null),this.changedAccessToken=r)}}const As=(Cs="https://xdzoikocriuvgkoenjqk.supabase.co",Rs="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhkem9pa29jcml1dmdrb2VuanFrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzMzg2NzUsImV4cCI6MjA3NTkxNDY3NX0.hh2GkNEdFHI9wlPfM6-oDraPz-s-zS1HlJpSTElQxHc",Ns={auth:{storage:window.localStorage,storageKey:"greenofig-auth",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},realtime:{params:{eventsPerSecond:10}},global:{headers:{"X-Client-Info":"greenofig-web"}}},new Os(Cs,Rs,Ns));var Cs,Rs,Ns;const Is=x.createContext(null),AuthProvider=({children:e})=>{const[t,r]=x.useState(null),[s,n]=x.useState(null),[i,a]=x.useState(!0),{toast:l}=useToast(),c=x.useCallback((e,t=0)=>__async(null,null,function*(){var r,s,i,o,a,u,h,d;if(!e)return n(null),null;const retryDelay=e=>Math.min(1e3*Math.pow(2,e),5e3);try{e.id,0===t&&/Mobile|Android|iPhone|iPad/i.test(navigator.userAgent)&&(yield new Promise(e=>setTimeout(e,300)));let{data:l,error:c}=yield As.from("user_profiles").select("*").eq("id",e.id).single();if(c&&"PGRST116"===c.code){const t=(null==(r=e.user_metadata)?void 0:r.full_name)||(null==(s=e.user_metadata)?void 0:s.name)||(null==(i=e.email)?void 0:i.split("@")[0])||"User",n=(null==(o=e.user_metadata)?void 0:o.avatar_url)||(null==(a=e.user_metadata)?void 0:a.picture),{data:c,error:u}=yield As.from("user_profiles").insert({id:e.id,full_name:t,email:e.email,role:"user",profile_picture_url:n}).select().single();if(u)throw console.error("Error creating profile:",u),u;l=c}else if(c)throw c;return n(l),l}catch(f){return console.error(`Error fetching user profile (attempt ${t+1}):`,f),t<3&&((null==(u=f.message)?void 0:u.includes("fetch"))||(null==(h=f.message)?void 0:h.includes("network"))||(null==(d=f.message)?void 0:d.includes("timeout"))||"PGRST301"===f.code)?(retryDelay(t),yield new Promise(e=>setTimeout(e,retryDelay(t))),c(e,t+1)):(t>=3&&l({variant:"destructive",title:"Connection Error",description:"Could not fetch user profile. Please check your connection and try again."}),null)}}),[l]),u=x.useCallback(()=>t?c(t):Promise.resolve(null),[t,c]);x.useEffect(()=>{__async(null,null,function*(){var e;a(!0);const{data:{session:t}}=yield As.auth.getSession();r(null!=(e=null==t?void 0:t.user)?e:null),(null==t?void 0:t.user)&&(yield c(t.user)),a(!1)});const{data:e}=As.auth.onAuthStateChange((e,t)=>__async(null,null,function*(){var e,s;null==(e=null==t?void 0:t.user)||e.email,a(!0);const i=null!=(s=null==t?void 0:t.user)?s:null;r(i),i?yield c(i):n(null),a(!1)}));return()=>{var t;null==(t=null==e?void 0:e.subscription)||t.unsubscribe()}},[c]);const h=x.useCallback(e=>__async(null,null,function*(){a(!0);const{data:t,error:s}=yield As.auth.signInWithPassword(e);if(s)return a(!1),l({variant:"destructive",title:"Login Failed",description:s.message}),{error:s};t.user;const i=yield c(t.user);return r(t.user),n(i),a(!1),l({title:"Login Successful",description:`Welcome back${(null==i?void 0:i.full_name)?", "+i.full_name:""}!`}),{error:null,profile:i}}),[c,l]),d=x.useCallback(()=>__async(null,null,function*(){a(!0);const{error:e}=yield As.auth.signInWithOAuth({provider:"google",options:{redirectTo:"https://greenofig.com"}});e&&(a(!1),l({variant:"destructive",title:"Google Sign-In Failed",description:e.message}))}),[l]),f=x.useCallback(e=>__async(null,null,function*(){a(!0);const{email:t,password:s,full_name:i}=e;let o="user";t.endsWith("@greenofig.com")&&(t.startsWith("nutritionist@")?o="nutritionist":t.startsWith("admin@")?o="admin":t.startsWith("superadmin@")&&(o="super_admin"));const{data:u,error:h}=yield As.auth.signUp({email:t,password:s,options:{data:{full_name:i,role:o}}});if(h)return a(!1),l({variant:"destructive",title:"Sign Up Failed",description:h.message}),{user:null,error:h};const{data:d,error:f}=yield As.auth.signInWithPassword({email:t,password:s});if(f)return a(!1),l({variant:"destructive",title:"Sign-in after sign-up failed.",description:f.message}),{user:null,error:f};yield new Promise(e=>setTimeout(e,1500)),"user"!==o&&(yield As.from("user_profiles").update({role:o}).eq("id",d.user.id));const p=yield c(d.user);return r(d.user),n(p),a(!1),{user:d.user,error:null,profile:p}}),[c,l]),p=x.useCallback(()=>__async(null,null,function*(){a(!0);try{yield As.auth.signOut(),r(null),n(null),localStorage.clear(),sessionStorage.clear(),l({title:"Signed Out",description:"You have been successfully signed out."})}catch(e){console.error("SignOut error:",e)}window.location.replace("/home")}),[l]),m=x.useMemo(()=>({user:t,userProfile:s,loading:i,signIn:h,signInWithGoogle:d,signUp:f,signOut:p,refreshUserProfile:u}),[t,s,i,h,d,f,p,u]);return o.jsx(Is.Provider,{value:m,children:e})},useAuth=()=>{const e=x.useContext(Is);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},$s="/assets/Remove%20background%20project-DdcfZIGG.png",Ds=cva("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-95",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 hover:shadow-lg hover:shadow-primary/20",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 hover:shadow-lg hover:shadow-destructive/20",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground hover:border-primary/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 hover:shadow-md",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline focus-visible:ring-offset-0"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Ls=x.forwardRef((e,t)=>{var r=e,{className:s,variant:n,size:i,asChild:a=!1}=r,l=__objRest(r,["className","variant","size","asChild"]);const c=a?p:"button";return o.jsx(c,__spreadValues({className:cn(Ds({variant:n,size:i,className:s})),ref:t,type:"button"!==c||l.type?l.type:"button"},l))});Ls.displayName="Button";const GoogleIcon=e=>o.jsxs("svg",__spreadProps(__spreadValues({viewBox:"0 0 48 48"},e),{children:[o.jsx("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),o.jsx("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),o.jsx("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.222,0-9.651-3.356-11.303-8H6.306C9.656,39.663,16.318,44,24,44z"}),o.jsx("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571l6.19,5.238C44.572,34.046,48,27.461,48,20C48,17.222,47.113,14.69,45.54,12.591L39.9,18.335C42.128,20.45,43.611,20.083,43.611,20.083z"})]})),AuthPage=({logoUrl:e,initialIsLogin:t=!0})=>{const{signIn:r,signUp:s,signInWithGoogle:n,user:i,userProfile:a}=useAuth(),l=T(),c=S(),[u,h]=x.useState(t),[d,f]=x.useState(""),[p,m]=x.useState(""),[g,y]=x.useState(""),[v,b]=x.useState(!1),[_,w]=x.useState(!1),[j,E]=x.useState(null);x.useEffect(()=>{var e;(null==(e=c.state)?void 0:e.selectedPlan)&&E(c.state.selectedPlan)},[c.state]),x.useEffect(()=>{h("/login"===c.pathname)},[c.pathname]);return o.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-background touch-auto",children:o.jsx(L.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"w-full max-w-md",children:o.jsxs("div",{className:"glass-effect rounded-2xl p-4 sm:p-8 shadow-2xl",children:[o.jsxs("button",{onClick:()=>l(-1),className:"flex items-center gap-2 text-text-secondary hover:text-primary transition-colors mb-4 group",children:[o.jsx(U,{className:"w-5 h-5 group-hover:-translate-x-1 transition-transform"}),o.jsx("span",{className:"text-sm font-medium",children:"Back"})]}),o.jsxs("div",{className:"text-center mb-8",children:[o.jsx(k,{to:"/home",className:"inline-block mb-4",children:o.jsx(L.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:o.jsx("img",{src:e,alt:"GreenoFig Logo",className:"w-20 h-20"})})}),o.jsx("h1",{className:"text-4xl font-bold gradient-text mb-2",children:"GreenoFig"}),o.jsx("p",{className:"text-text-secondary",children:"Your Personal Wellness Companion"}),j&&!u&&o.jsxs("div",{className:"mt-4 bg-primary/10 text-primary font-semibold p-2 rounded-lg",children:["Signing up for the ",o.jsx("span",{className:"font-bold",children:j})," plan"]})]}),o.jsxs(Ls,{variant:"outline",className:"w-full py-3 min-h-[44px] rounded-lg shadow-lg flex items-center justify-center gap-2 touch-manipulation active:scale-95 transition-transform",onClick:()=>__async(null,null,function*(){v||_||(w(!0),yield n(),setTimeout(()=>w(!1),5e3))}),disabled:_||v,type:"button",children:[_?o.jsx(B,{className:"h-5 w-5 animate-spin"}):o.jsx(GoogleIcon,{className:"w-5 h-5"}),o.jsxs("span",{children:["Sign ",u?"in":"up"," with Google"]})]}),o.jsxs("div",{className:"my-4 flex items-center",children:[o.jsx("div",{className:"flex-grow border-t border-border"}),o.jsx("span",{className:"flex-shrink mx-4 text-xs text-text-secondary uppercase",children:"Or continue with"}),o.jsx("div",{className:"flex-grow border-t border-border"})]}),o.jsxs("form",{onSubmit:e=>__async(null,null,function*(){if(e.preventDefault(),!v&&!_)if(d&&p&&(u||g)){if(b(!0),u){const{error:e,profile:t}=yield r({email:d,password:p});if(!e&&t){const e=t.role;let r="/app/user";"admin"===e||"super_admin"===e?r="/app/admin":"nutritionist"===e&&(r="/app/nutritionist"),l(r,{replace:!0})}}else{const{user:e,error:t,profile:r}=yield s({email:d,password:p,full_name:g});if(!t&&e&&r){toast({title:"Account created! ",description:"Welcome! Let's get you set up."});const e=r.role;let t="/app/user";"admin"===e||"super_admin"===e?t="/app/admin":"nutritionist"===e&&(t="/app/nutritionist"),l(t,{replace:!0})}}b(!1)}else toast({title:"Missing fields",description:"Please fill in all required fields",variant:"destructive"})}),className:"space-y-4",children:[!u&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Full Name"}),o.jsxs("div",{className:"relative",children:[o.jsx(q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-primary"}),o.jsx("input",{type:"text",value:g,onChange:e=>y(e.target.value),className:"w-full pl-10 pr-4 py-3 min-h-[44px] bg-background border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring touch-manipulation",placeholder:"John Doe",disabled:v||_,required:!0,autoComplete:"name"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Email"}),o.jsxs("div",{className:"relative",children:[o.jsx(H,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-primary"}),o.jsx("input",{type:"email",value:d,onChange:e=>f(e.target.value),className:"w-full pl-10 pr-4 py-3 min-h-[44px] bg-background border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring touch-manipulation",placeholder:"you@example.com",disabled:v||_,required:!0,autoComplete:"email",inputMode:"email"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Password"}),o.jsxs("div",{className:"relative",children:[o.jsx(M,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-primary"}),o.jsx("input",{type:"password",value:p,onChange:e=>m(e.target.value),className:"w-full pl-10 pr-4 py-3 min-h-[44px] bg-background border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring touch-manipulation",placeholder:"",disabled:v||_,required:!0,autoComplete:u?"current-password":"new-password"})]})]}),o.jsxs(Ls,{type:"submit",className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground font-semibold py-3 min-h-[44px] rounded-lg shadow-lg touch-manipulation active:scale-95 transition-transform",disabled:v||_,children:[v&&o.jsx(B,{className:"mr-2 h-4 w-4 animate-spin"}),v?"Processing...":u?"Login":"Sign Up"]})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsx("button",{onClick:()=>{v||_||l(u?"/signup":"/login")},type:"button",className:"text-text-secondary hover:text-primary transition-colors disabled:opacity-50 min-h-[44px] py-2 px-4 touch-manipulation",disabled:v||_,children:u?"Don't have an account? Sign up":"Already have an account? Login"})})]})})})},Us=x.forwardRef((e,t)=>{var r=e,{className:s}=r,n=__objRest(r,["className"]);return o.jsx(m,__spreadValues({ref:t,className:cn("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s)},n))});Us.displayName=m.displayName;const Bs=x.forwardRef((e,t)=>{var r=e,{className:s}=r,n=__objRest(r,["className"]);return o.jsx(g,__spreadValues({ref:t,className:cn("aspect-square h-full w-full",s)},n))});Bs.displayName=g.displayName;const Fs=x.forwardRef((e,t)=>{var r=e,{className:s}=r,n=__objRest(r,["className"]);return o.jsx(y,__spreadValues({ref:t,className:cn("flex h-full w-full items-center justify-center rounded-full bg-muted",s)},n))});Fs.displayName=y.displayName;const qs=cva("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"text-foreground hover:bg-accent"}},defaultVariants:{variant:"default"}});function Badge(e){var t=e,{className:r,variant:s}=t,n=__objRest(t,["className","variant"]);return o.jsx("div",__spreadValues({className:cn(qs({variant:s}),r)},n))}const Hs=x.forwardRef((e,t)=>{var r=e,{className:s}=r,n=__objRest(r,["className"]);return o.jsx("textarea",__spreadValues({className:cn("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-200 hover:border-primary/50 focus:border-primary resize-y",s),ref:t,"aria-invalid":n["aria-invalid"]},n))});Hs.displayName="Textarea";const FloatingAiChat=()=>{const{userProfile:e,user:t}=useAuth(),{toast:r}=useToast(),[s,n]=x.useState(!1),[i,a]=x.useState(!1),[l,c]=x.useState([]),[u,h]=x.useState(""),[d,f]=x.useState(!1),[p,m]=x.useState(!1),g=x.useRef(null),y=x.useRef(null),v=(()=>{const t=null==e?void 0:e.role;return"admin"===t||"super_admin"===t?["Show me platform analytics overview","What are the best practices for user engagement?","Help me analyze subscription trends"]:"nutritionist"===t?["Suggest evidence-based nutrition strategies","Help me create a client meal plan template","What are current nutrition research trends?"]:["Give me a healthy breakfast idea","Suggest a quick 15-minute workout","How can I improve my sleep quality?"]})();x.useEffect(()=>{const e=setTimeout(()=>m(!0),3e3),t=setTimeout(()=>m(!1),8e3);return()=>{clearTimeout(e),clearTimeout(t)}},[]),x.useEffect(()=>{const handleClickOutside=e=>{y.current&&!y.current.contains(e.target)&&s&&n(!1)};return document.addEventListener("mousedown",handleClickOutside),()=>{document.removeEventListener("mousedown",handleClickOutside)}},[s]);x.useEffect(()=>{var e;null==(e=g.current)||e.scrollIntoView({behavior:"smooth"})},[l]),x.useEffect(()=>{var t,r,n;if(s&&0===l.length&&e){const s=null==e?void 0:e.role;let i="";i="admin"===s||"super_admin"===s?`Hi ${(null==(t=null==e?void 0:e.full_name)?void 0:t.split(" ")[0])||"Admin"}!  I'm your AI Business Assistant. I can help with analytics, strategies, and platform insights.`:"nutritionist"===s?`Hi ${(null==(r=null==e?void 0:e.full_name)?void 0:r.split(" ")[0])||"there"}!  I'm your AI Nutrition Assistant. I can help with evidence-based strategies, client plans, and research.`:`Hi ${(null==(n=null==e?void 0:e.full_name)?void 0:n.split(" ")[0])||"there"}!  I'm your AI Health Coach. How can I help you today?`;const o={id:Date.now(),text:i,sender:"ai"};c([o])}},[s,e]);const handleSendMessage=(s,n)=>__async(null,null,function*(){s&&s.preventDefault();const i=n||u;if(!i.trim()||d)return;if(!t)return void r({title:"Please log in",description:"You need to be logged in to use the AI Coach",variant:"destructive"});const o={text:i,sender:"user",user_id:t.id},a=__spreadProps(__spreadValues({},o),{id:Date.now(),created_at:(new Date).toISOString()}),p=[...l,a];c(p),h(""),f(!0);try{const{data:r,error:s}=yield As.functions.invoke("ai-coach-memory",{body:JSON.stringify({messages:p.slice(-10),userProfile:__spreadProps(__spreadValues({},e),{isAdmin:"admin"===(null==e?void 0:e.role)||"super_admin"===(null==e?void 0:e.role),isNutritionist:"nutritionist"===(null==e?void 0:e.role)})})});if(s)throw s;const n={text:r.reply,sender:"ai",user_id:t.id,id:Date.now()+1,created_at:(new Date).toISOString()};c(e=>[...e,n])}catch(m){console.error("AI Coach error:",m);const e={text:"I'm having trouble connecting right now. Please try again! ",sender:"ai",id:Date.now()+1};c(t=>[...t,e]),r({title:"Error",description:"Failed to get AI response. Please try again.",variant:"destructive"})}finally{f(!1)}}),toggleOpen=()=>{n(!s),a(!1)};return o.jsxs("div",{ref:y,children:[o.jsx(z,{children:!s&&o.jsxs(L.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:300,damping:25},className:"fixed bottom-6 right-6 z-50",children:[o.jsx(z,{children:p&&o.jsxs(L.div,{initial:{opacity:0,x:20,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.8},className:"absolute bottom-20 right-0 bg-card rounded-lg shadow-xl p-3 w-56 border border-primary/20",children:[o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(W,{className:"h-5 w-5 text-primary shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold text-card-foreground",children:"Need health advice?"}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Chat with our AI Health Coach for personalized wellness tips!"})]})]}),o.jsx("div",{className:"absolute -bottom-2 right-6 w-4 h-4 bg-card border-r border-b border-primary/20 transform rotate-45"})]})}),o.jsxs(L.div,{onClick:toggleOpen,whileHover:{scale:1.05},whileTap:{scale:.95},className:"h-16 w-16 rounded-full shadow-2xl cursor-pointer relative bg-gradient-to-br from-primary to-green-400",children:[o.jsx(L.div,{animate:{boxShadow:["0 0 10px hsl(var(--primary) / 0.3)","0 0 20px hsl(var(--primary) / 0.4)","0 0 10px hsl(var(--primary) / 0.3)"]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"absolute inset-0 rounded-full"}),o.jsx(L.div,{animate:{scale:[1,1.1,1],rotate:[0,5,-5,0],y:[0,-2,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},className:"absolute inset-0 flex items-center justify-center p-2",children:o.jsx("img",{src:$s,alt:"GreenoFig AI Coach",className:"h-12 w-12 object-contain drop-shadow-lg",style:{filter:"brightness(0.75) contrast(1.15)"}})})]})]})}),o.jsx(z,{children:s&&o.jsxs(L.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1,height:i?"60px":"480px"},exit:{opacity:0,y:50,scale:.9},transition:{type:"spring",stiffness:300,damping:30},className:"fixed bottom-6 right-6 w-[340px] bg-card rounded-2xl shadow-2xl z-50 border border-border overflow-hidden flex flex-col",children:[o.jsxs("div",{className:"bg-gradient-to-r from-primary to-green-400 p-3 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(L.div,{animate:{boxShadow:["0 0 10px rgba(255, 255, 255, 0.3)","0 0 20px rgba(255, 255, 255, 0.5)","0 0 10px rgba(255, 255, 255, 0.3)"]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"h-10 w-10 rounded-full bg-white/20 flex items-center justify-center overflow-hidden",children:o.jsx("img",{src:$s,alt:"GreenoFig",className:"h-8 w-8 rounded-full object-cover"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-white",children:"AI Health Coach"}),o.jsx("p",{className:"text-xs text-white/80",children:d?"Thinking...":"Online"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ls,{variant:"ghost",size:"sm",onClick:()=>{a(!i)},className:"h-8 w-8 p-0 text-white hover:bg-white/20",children:i?o.jsx(V,{className:"h-4 w-4"}):o.jsx(J,{className:"h-4 w-4"})}),o.jsx(Ls,{variant:"ghost",size:"sm",onClick:toggleOpen,className:"h-8 w-8 p-0 text-white hover:bg-white/20",children:o.jsx(D,{className:"h-4 w-4"})})]})]}),!i&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-3 bg-muted/30",children:[o.jsx(z,{children:l.map((e,t)=>o.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex "+("user"===e.sender?"justify-end":"justify-start"),children:o.jsx("div",{className:"max-w-[85%] rounded-xl px-3 py-2.5 shadow-sm "+("user"===e.sender?"bg-gradient-to-br from-primary to-green-400 text-primary-foreground":"bg-card border border-border text-card-foreground"),children:o.jsx("p",{className:"text-[13px] leading-relaxed whitespace-pre-wrap break-words",children:e.text})})},e.id||t))}),d&&o.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-start",children:o.jsx("div",{className:"bg-muted rounded-xl px-4 py-3 shadow-sm",children:o.jsxs("div",{className:"flex gap-1.5",children:[o.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),o.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),o.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})}),o.jsx("div",{ref:g})]}),l.length<=1&&!d&&o.jsx("div",{className:"px-3 pb-2 pt-1",children:o.jsx("div",{className:"space-y-2",children:v.map((e,t)=>o.jsx(L.button,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{delay:.1*t},onClick:t=>handleSendMessage(t,e),className:"w-full p-2 bg-muted hover:bg-accent rounded-lg text-left text-xs transition-colors",children:e},t))})}),o.jsxs("div",{className:"p-3 bg-card border-t border-border",children:[o.jsxs("form",{onSubmit:handleSendMessage,className:"flex gap-2 items-end",children:[o.jsx(Hs,{value:u,onChange:e=>h(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),handleSendMessage())},placeholder:"Ask me anything...",className:"flex-1 min-h-[40px] max-h-[90px] resize-none text-sm bg-background border-input focus:border-ring rounded-lg",rows:1}),o.jsx(Ls,{type:"submit",disabled:!u.trim()||d,size:"icon",className:"h-10 w-10 bg-gradient-to-br from-primary to-green-400 hover:from-primary/90 hover:to-green-400/90 shrink-0 shadow-sm",children:o.jsx(G,{className:"h-4 w-4"})})]}),o.jsx("p",{className:"text-[11px] text-muted-foreground mt-1.5 text-center",children:"Press Enter to send"})]})]})]})})]})},AppLayout=({logoUrl:e})=>{const{userProfile:t,signOut:r}=useAuth();T();const[s,n]=x.useState(!1),[i,a]=x.useState(0);x.useEffect(()=>{if(null==t?void 0:t.id){fetchUnreadCount();try{const e=As.channel("conversations-changes").on("postgres_changes",{event:"*",schema:"public",table:"conversations",filter:"user"===t.role?`user_id=eq.${t.id}`:`nutritionist_id=eq.${t.id}`},()=>{fetchUnreadCount()}).subscribe(e=>{"CHANNEL_ERROR"===e&&console.warn("Realtime subscription error - will use polling instead")});return()=>{try{As.removeChannel(e)}catch(t){}}}catch(e){console.warn("Realtime not available, using polling only:",e.message);const t=setInterval(fetchUnreadCount,3e4);return()=>clearInterval(t)}}},[null==t?void 0:t.id]);const fetchUnreadCount=()=>__async(null,null,function*(){if(null==t?void 0:t.id)try{if("user"===t.role){const{data:e,error:r}=yield As.rpc("get_unread_message_count",{p_user_id:t.id});r||a(e||0)}else if(["nutritionist","admin","super_admin"].includes(t.role)){const{data:e,error:r}=yield As.rpc("get_nutritionist_unread_count",{p_nutritionist_id:t.id});r||a(e||0)}}catch(e){console.error("Error fetching unread count:",e)}}),handleSignOut=()=>__async(null,null,function*(){yield r()}),l=[{icon:X,label:"Dashboard",path:"/app/user"},{icon:Q,label:"AI Coach",path:"/app/ai-coach"},{icon:Z,label:"Nutrition",path:"/app/nutrition"},{icon:ee,label:"Fitness",path:"/app/fitness"},{icon:te,label:"Progress",path:"/app/progress"},{icon:H,label:"Messages",path:"/app/messages"},{icon:re,label:"Support",path:"/app/support"}],c=[{icon:X,label:"Dashboard",path:"/app/nutritionist"},{icon:se,label:"Clients",path:"/app/nutritionist?tab=clients"},{icon:Z,label:"Meal Plans",path:"/app/nutritionist?tab=meals"},{icon:ne,label:"Schedule",path:"/app/nutritionist?tab=schedule"},{icon:re,label:"Messages",path:"/app/nutritionist?tab=messages"},{icon:te,label:"Analytics",path:"/app/nutritionist?tab=analytics"},{icon:ie,label:"Resources",path:"/app/nutritionist?tab=resources"},{icon:ie,label:"Blog",path:"/app/nutritionist?tab=blog"},{icon:oe,label:"Settings",path:"/app/nutritionist?tab=settings"}],u=[{icon:X,label:"Dashboard",path:"/app/admin"},{icon:ae,label:"Analytics",path:"/app/admin?tab=analytics"},{icon:le,label:"DB Studio",path:"/app/admin?tab=studio"},{icon:se,label:"Customers",path:"/app/admin?tab=customers"},{icon:ce,label:"Subscriptions",path:"/app/admin?tab=subscriptions"},{icon:ce,label:"Payments",path:"/app/admin?tab=payments"},{icon:ue,label:"Issues",path:"/app/admin?tab=issues"},{icon:ie,label:"Blog",path:"/app/admin?tab=blog"},{icon:he,label:"Website",path:"/app/admin?tab=website"},{icon:Q,label:"AI Coach",path:"/app/admin?tab=ai-coach"}],h=(()=>{switch(null==t?void 0:t.role){case"admin":case"super_admin":return u;case"nutritionist":return c;default:return l}})(),NavButton=({link:e,isActive:t})=>{const[r,a]=x.useState(!1),l="/app/messages"===e.path&&i>0;return o.jsxs(O,{to:e.path,end:!0,onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),className:`flex items-center gap-3 px-3 py-2 rounded-lg transition-all duration-200 text-sm font-medium border ${t||r?"bg-gradient-to-r from-primary to-green-400 text-primary-foreground border-primary/30":"bg-transparent text-muted-foreground border-transparent hover:border-primary/30"} ${r?"translate-x-1":"translate-x-0"}`,onClick:()=>s&&n(!1),children:[o.jsx(e.icon,{className:"w-4 h-4"}),o.jsx("span",{className:"flex-1",children:e.label}),l&&o.jsx(Badge,{className:"bg-red-500 text-white text-xs px-1.5 py-0.5 min-w-[20px] h-5 flex items-center justify-center",children:i>99?"99+":i})]})},SidebarContent=()=>{return o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsx("div",{className:"p-4 border-b border-border flex items-center gap-3",children:o.jsxs(k,{to:"/home",className:"flex items-center gap-2",children:[o.jsx("img",{src:e,alt:"GreenoFig Logo",className:"w-8 h-8"}),o.jsx("span",{className:"text-lg font-bold gradient-text",children:"GreenoFig"})]})}),o.jsx("nav",{className:"flex-1 p-3 space-y-1",children:h.map(e=>{let t=!1;return t=e.path.includes("?")?window.location.pathname+window.location.search===e.path:"/app/admin"===e.path?"/app/admin"===window.location.pathname&&!window.location.search:window.location.pathname===e.path,o.jsx(NavButton,{link:e,isActive:t},e.path)})}),o.jsxs("div",{className:"p-3 border-t border-border",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[o.jsxs(Us,{className:"w-8 h-8",children:[o.jsx(Bs,{src:null==t?void 0:t.profile_picture_url}),o.jsx(Fs,{className:"text-xs",children:(r=null==t?void 0:t.full_name,r?r.split(" ").map(e=>e[0]).join("").toUpperCase():"?")})]}),o.jsxs("div",{className:"flex-1 overflow-hidden",children:[o.jsx("p",{className:"text-xs font-semibold truncate",children:null==t?void 0:t.full_name}),o.jsx("p",{className:"text-xs text-text-secondary truncate",children:null==t?void 0:t.email})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs(O,{to:"/app/profile",className:({isActive:e})=>"flex items-center gap-3 px-3 py-2 rounded-lg transition-colors text-sm font-medium "+(e?"bg-muted text-foreground":"text-text-secondary hover:bg-muted hover:text-foreground"),onClick:()=>s&&n(!1),children:[o.jsx(q,{className:"w-4 h-4"}),"Profile"]}),o.jsxs("button",{onClick:handleSignOut,className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-colors text-sm font-medium text-text-secondary hover:bg-muted hover:text-foreground",children:[o.jsx(de,{className:"w-4 h-4"}),"Sign Out"]})]})]})]});var r};return o.jsxs("div",{className:"flex h-screen bg-background text-foreground",children:[o.jsx("aside",{className:"hidden lg:block w-64 bg-card border-r border-border",children:o.jsx(SidebarContent,{})}),o.jsx(z,{children:s&&o.jsxs(o.Fragment,{children:[o.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>n(!1)}),o.jsx(L.aside,{variants:{open:{x:0,transition:{type:"spring",stiffness:300,damping:30}},closed:{x:"-100%",transition:{type:"spring",stiffness:300,damping:30}}},initial:"closed",animate:"open",exit:"closed",className:"fixed top-0 left-0 h-full w-64 bg-card z-50 lg:hidden",children:o.jsx(SidebarContent,{})})]})}),o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[o.jsxs("header",{className:"flex items-center justify-between lg:justify-end h-16 px-4 border-b border-border bg-card",children:[o.jsx(Ls,{variant:"ghost",size:"icon",className:"lg:hidden",onClick:()=>n(!0),children:o.jsx(K,{className:"w-6 h-6"})}),o.jsx("div",{className:"flex items-center gap-4",children:"admin"===(null==t?void 0:t.role)||"super_admin"===(null==t?void 0:t.role)?o.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-primary",children:[o.jsx(Y,{className:"w-5 h-5"}),"Admin Mode"]}):null})]}),o.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 lg:p-8",children:o.jsx(P,{})})]}),o.jsx(FloatingAiChat,{})]})},Ms=x.lazy(()=>__vitePreload(()=>import("./HomePage-DXfs54bP.js"),__vite__mapDeps([0,1,2,3,4]))),zs=x.lazy(()=>__vitePreload(()=>import("./FeaturesPage-CstA9f0q.js"),__vite__mapDeps([5,1,2,3,4,6,7,8]))),Ws=x.lazy(()=>__vitePreload(()=>import("./PricingPage-B7GpZcRS.js"),__vite__mapDeps([9,1,2,6,7,8,3,4,10]))),Vs=x.lazy(()=>__vitePreload(()=>import("./BlogPage-gTI4H-xn.js"),__vite__mapDeps([11,1,2,12,13,6,7,8,3,4]))),Js=x.lazy(()=>__vitePreload(()=>import("./ReviewsPage-FqfNAAoO.js"),__vite__mapDeps([14,1,2,6,7,8,3,4,12,15,16]))),Gs=x.lazy(()=>__vitePreload(()=>import("./ContactPage-DbL_Gllw.js"),__vite__mapDeps([17,1,2,6,7,8,3,4]))),Ks=x.lazy(()=>__vitePreload(()=>import("./FaqPage-D8UNJdOS.js"),__vite__mapDeps([18,1,2,6,7,8,3,4]))),Ys=x.lazy(()=>__vitePreload(()=>import("./AboutPage-Dgg0TyR0.js"),__vite__mapDeps([19,1,2,6,7,8,3,4]))),Xs=x.lazy(()=>__vitePreload(()=>import("./UserDashboard-DTeMs4lt.js"),__vite__mapDeps([20,1,2,12,8,3,4,15,16,21,22,13]))),Qs=x.lazy(()=>__vitePreload(()=>import("./NutritionistDashboardV2-DCcTfUOQ.js"),__vite__mapDeps([23,1,2,24,12,3,4,15,13,25,8,26]))),Zs=x.lazy(()=>__vitePreload(()=>import("./AdminDashboard-DjYJfJUu.js"),__vite__mapDeps([27,1,2,24,12,3,4,15,13,25,8,16,22,26,28]))),en=x.lazy(()=>__vitePreload(()=>import("./OnboardingSurvey-C6cZk74l.js"),__vite__mapDeps([7,1,2,8,3,4]))),tn=x.lazy(()=>__vitePreload(()=>import("./ProfilePage-D7SNydP-.js"),__vite__mapDeps([29,1,2,12,15,25,3,4,16]))),rn=x.lazy(()=>__vitePreload(()=>import("./EnhancedBlogPostEditor-DpduSozf.js"),__vite__mapDeps([30,1,2,15,12,16,26,13,22,3,4]))),sn=x.lazy(()=>__vitePreload(()=>import("./BlogTagsManager-BMgw6XCW.js"),__vite__mapDeps([31,1,2,12,15,16,13,8,3,4]))),nn=x.lazy(()=>__vitePreload(()=>import("./AiCoachPage-CWH9GHO-.js"),__vite__mapDeps([32,1,2,3,4]))),on=x.lazy(()=>__vitePreload(()=>import("./SurveyPage-RFUrRzPd.js"),__vite__mapDeps([33,1,2,3,4]))),an=x.lazy(()=>__vitePreload(()=>import("./RevenueAnalyticsPage-BUgdAx3w.js"),__vite__mapDeps([28,1,2,12,13,3,4]))),ln=x.lazy(()=>__vitePreload(()=>import("./BillingPage-DymoTogA.js").then(e=>e.B),__vite__mapDeps([34,1,2,12,13,3,4,10,8,16]))),un=x.lazy(()=>__vitePreload(()=>import("./SupportPage-WQHVE3XS.js"),__vite__mapDeps([35,1,2,12,15,22,3,4,13]))),hn=x.lazy(()=>__vitePreload(()=>import("./ResetPasswordPage-Bmn7CxFb.js"),__vite__mapDeps([36,1,2,15,3,4]))),dn=x.lazy(()=>__vitePreload(()=>import("./NutritionPageFunctional-jtzxaRt0.js"),__vite__mapDeps([37,1,2,21,8,3,4,15,16,22]))),fn=x.lazy(()=>__vitePreload(()=>import("./FitnessPage-BMFH0IUE.js"),__vite__mapDeps([38,1,2,3,4]))),pn=x.lazy(()=>__vitePreload(()=>import("./ProgressPage-m1nS48Ht.js"),__vite__mapDeps([39,1,2,3,4]))),mn=x.lazy(()=>__vitePreload(()=>import("./MessagingCenter-aP_HMpTR.js"),__vite__mapDeps([40,1,2,12,15,22,3,4,8]))),gn=x.lazy(()=>__vitePreload(()=>import("./PrivacyPolicyPage-BT088FAq.js"),__vite__mapDeps([41,1,2,6,7,8,3,4]))),yn=x.lazy(()=>__vitePreload(()=>import("./TermsOfServicePage-T62eLG_u.js"),__vite__mapDeps([42,1,2,6,7,8,3,4]))),vn=x.lazy(()=>__vitePreload(()=>import("./AdminFAQPage-egWpKiNN.js"),__vite__mapDeps([43,1,2,15,12,3,4]))),PageLoader=()=>o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:o.jsx("img",{src:$s,alt:"GreenoFig Logo",className:"w-24 h-24 animate-pulse"})}),ProtectedRoute=({children:e})=>{const{user:t,loading:r}=useAuth(),s=S();return r?o.jsx(PageLoader,{}):t?e:o.jsx(R,{to:"/login",state:{from:s},replace:!0})},AdminRoute=({children:e})=>{const{userProfile:t,loading:r}=useAuth();return r?o.jsx(PageLoader,{}):"admin"!==(null==t?void 0:t.role)&&"super_admin"!==(null==t?void 0:t.role)?o.jsx(R,{to:"/app",replace:!0}):e},BlogEditorRoute=({children:e})=>{const{userProfile:t,loading:r}=useAuth();return r?o.jsx(PageLoader,{}):["admin","super_admin","nutritionist"].includes(null==t?void 0:t.role)?(t.role,e):(null==t||t.role,o.jsx(R,{to:"/app",replace:!0}))},RoleBasedRedirect=()=>{const{userProfile:e,loading:t}=useAuth();if(t)return o.jsx(PageLoader,{});if(!e)return o.jsx(R,{to:"/login",replace:!0});const r=e.role;let s="/app/user";return"admin"===r||"super_admin"===r?s="/app/admin":"nutritionist"===r&&(s="/app/nutritionist"),o.jsx(R,{to:s,replace:!0})};function App(){const e=S();return o.jsxs(o.Fragment,{children:[o.jsxs(mt,{children:[o.jsx("title",{children:"GreenoFig - AI-Powered Health & Wellness"}),o.jsx("meta",{name:"description",content:"Your AI-Powered Health Companion. Achieve your wellness goals with personalized nutrition, fitness, and lifestyle coaching."})]}),o.jsx(x.Suspense,{fallback:o.jsx(PageLoader,{}),children:o.jsx(z,{mode:"wait",children:o.jsxs(A,{location:e,children:[o.jsx(C,{path:"/login",element:o.jsx(AuthPage,{logoUrl:$s})}),o.jsx(C,{path:"/signup",element:o.jsx(AuthPage,{logoUrl:$s,initialIsLogin:!1})}),o.jsx(C,{path:"/reset-password",element:o.jsx(hn,{})}),o.jsxs(C,{path:"/app",element:o.jsx(ProtectedRoute,{children:o.jsx(AppLayout,{logoUrl:$s})}),children:[o.jsx(C,{index:!0,element:o.jsx(RoleBasedRedirect,{})}),o.jsx(C,{path:"user",element:o.jsx(Xs,{logoUrl:$s})}),o.jsx(C,{path:"nutritionist",element:o.jsx(Qs,{logoUrl:$s})}),o.jsx(C,{path:"admin",element:o.jsx(Zs,{logoUrl:$s})}),o.jsx(C,{path:"profile",element:o.jsx(tn,{logoUrl:$s})}),o.jsx(C,{path:"billing",element:o.jsx(ln,{})}),o.jsx(C,{path:"support",element:o.jsx(un,{})}),o.jsx(C,{path:"ai-coach",element:o.jsx(nn,{})}),o.jsx(C,{path:"nutrition",element:o.jsx(dn,{})}),o.jsx(C,{path:"fitness",element:o.jsx(fn,{})}),o.jsx(C,{path:"progress",element:o.jsx(pn,{})}),o.jsx(C,{path:"messages",element:o.jsx(mn,{})}),o.jsx(C,{path:"admin/blog/new",element:o.jsx(BlogEditorRoute,{children:o.jsx(rn,{logoUrl:$s})})}),o.jsx(C,{path:"admin/blog/edit/:postId",element:o.jsx(BlogEditorRoute,{children:o.jsx(rn,{logoUrl:$s})})}),o.jsx(C,{path:"admin/blog/tags",element:o.jsx(AdminRoute,{children:o.jsx(sn,{logoUrl:$s})})}),o.jsx(C,{path:"nutritionist/blog/new",element:o.jsx(BlogEditorRoute,{children:o.jsx(rn,{logoUrl:$s})})}),o.jsx(C,{path:"nutritionist/blog/edit/:postId",element:o.jsx(BlogEditorRoute,{children:o.jsx(rn,{logoUrl:$s})})}),o.jsx(C,{path:"admin/faq",element:o.jsx(AdminRoute,{children:o.jsx(vn,{})})}),o.jsx(C,{path:"admin/revenue",element:o.jsx(AdminRoute,{children:o.jsx(an,{})})})]}),o.jsx(C,{path:"/onboarding",element:o.jsx(ProtectedRoute,{children:o.jsx(en,{logoUrl:$s})})}),o.jsx(C,{path:"/survey",element:o.jsx(on,{logoUrl:$s})}),o.jsx(C,{path:"/home",element:o.jsx(Ms,{logoUrl:$s})}),o.jsx(C,{path:"/features",element:o.jsx(zs,{logoUrl:$s})}),o.jsx(C,{path:"/pricing",element:o.jsx(Ws,{logoUrl:$s})}),o.jsx(C,{path:"/blog",element:o.jsx(Vs,{logoUrl:$s})}),o.jsx(C,{path:"/blog/:postId",element:o.jsx(Vs,{logoUrl:$s})}),o.jsx(C,{path:"/reviews",element:o.jsx(Js,{logoUrl:$s})}),o.jsx(C,{path:"/contact",element:o.jsx(Gs,{logoUrl:$s})}),o.jsx(C,{path:"/faq",element:o.jsx(Ks,{logoUrl:$s})}),o.jsx(C,{path:"/about",element:o.jsx(Ys,{logoUrl:$s})}),o.jsx(C,{path:"/privacy-policy",element:o.jsx(gn,{logoUrl:$s})}),o.jsx(C,{path:"/terms-of-service",element:o.jsx(yn,{logoUrl:$s})}),o.jsx(C,{path:"/",element:o.jsx(R,{to:"/home",replace:!0})}),o.jsx(C,{path:"/*",element:o.jsx(R,{to:"/home",replace:!0})})]},e.pathname)})}),o.jsx(Toaster,{})]})}const bn=new class{constructor(){this.isInitialized=!1}init(){this.isInitialized||(window.onerror=(e,t,r,s,n)=>(this.logError({message:e.toString(),stack:null==n?void 0:n.stack,type:"runtime_error",url:window.location.href,source:t,line:r,column:s}),!1),window.addEventListener("unhandledrejection",e=>{var t;this.logError({message:`Unhandled Promise Rejection: ${e.reason}`,stack:null==(t=e.reason)?void 0:t.stack,type:"promise_rejection",url:window.location.href})}),this.isInitialized=!0)}logError(e){return __async(this,arguments,function*({message:e,stack:t="",type:r="unknown",componentName:s="unknown",severity:n="medium",url:i=window.location.href,source:o="",line:a=null,column:l=null,userId:c=null}){try{if(!c){const{data:{user:e}}=yield As.auth.getUser();c=(null==e?void 0:e.id)||null}const u={error_message:e,error_stack:t,error_type:r,component_name:s,user_id:c,user_agent:navigator.userAgent,url:i,severity:n,status:"open",source_file:o,line_number:a,column_number:l,browser_info:{language:navigator.language,platform:navigator.platform,screen:{width:window.screen.width,height:window.screen.height}}},{error:h}=yield As.from("error_logs").insert([u]);h&&console.error("Failed to log error to Supabase:",h)}catch(u){console.error("Error in errorLogger:",u)}})}log(e,t="unknown",r="medium"){this.logError({message:e.message||e.toString(),stack:e.stack,type:"manual_log",componentName:t,severity:r})}};var _n;"undefined"!=typeof window&&bn.init(),bn.init(),me.createRoot(document.getElementById("root")).render(o.jsx(w.StrictMode,{children:o.jsx(AuthProvider,{children:o.jsx(N,{children:o.jsx(App,{})})})})),(_n=e=>{const{name:t,value:r,id:s}=e})&&_n instanceof Function&&__vitePreload(()=>__async(null,null,function*(){const{getCLS:e,getFID:t,getFCP:r,getLCP:s,getTTFB:n}=yield Promise.resolve().then(()=>wn);return{getCLS:e,getFID:t,getFCP:r,getLCP:s,getTTFB:n}}),void 0).then(({getCLS:e,getFID:t,getFCP:r,getLCP:s,getTTFB:n})=>{e(_n),t(_n),r(_n),s(_n),n(_n)}).catch(()=>{});const wn=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{Us as A,Ls as B,FloatingAiChat as F,mt as H,Hs as T,__vitePreload as _,Bs as a,Fs as b,cn as c,useToast as d,Badge as e,cva as f,Ds as g,$s as l,As as s,toast as t,useAuth as u};
