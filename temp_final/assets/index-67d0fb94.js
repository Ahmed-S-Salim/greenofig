import{j as e,V as t,R as r,A as s,C as n,T as i,D as o,P as a,S as l,a as c,I as u,F as d,b as h}from"./vendor-ui-c5075e48.js";import{a as f,g as p,r as m,R as g,d as y,e as v,u as b,f as w,L as _,O as x,N as j,h as T,i as k,j as S,B as E}from"./vendor-react-c35372bd.js";import{t as O,c as N,X as P,m as C,A,L as R,U as I,M as $,a as L,b as D,H as U,B,d as M,e as F,f as z,S as H,g as q,h as V,i as W,j as J,C as G,k as K,I as Y,l as Q,n as X,o as Z,p as ee,q as te,r as re,s as se,D as ne,u as ie,v as oe,w as ae,F as le,x as ce,y as ue,z as de,E as he,W as fe,T as pe,G as me,J as ge,K as ye,N as ve}from"./vendor-utils-7072100e.js";import"./vendor-editor-d6577754.js";function be(e,t){for(var r=0;r<t.length;r++){const s=t[r];if("string"!=typeof s&&!Array.isArray(s))for(const t in s)if("default"!==t&&!(t in e)){const r=Object.getOwnPropertyDescriptor(s,t);r&&Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:()=>s[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var we={},_e=f;we.createRoot=_e.createRoot,we.hydrateRoot=_e.hydrateRoot;const xe={},je=function(e,t,r){if(!t||0===t.length)return e();const s=document.getElementsByTagName("link");return Promise.all(t.map(e=>{if((e=function(e){return"/"+e}(e))in xe)return;xe[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(!!r)for(let r=s.length-1;r>=0;r--){const n=s[r];if(n.href===e&&(!t||"stylesheet"===n.rel))return}else if(document.querySelector(`link[href="${e}"]${n}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script",i.crossOrigin=""),i.href=e,document.head.appendChild(i),t?new Promise((t,r)=>{i.addEventListener("load",t),i.addEventListener("error",()=>r(new Error(`Unable to preload CSS for ${e}`)))}):void 0})).then(()=>e()).catch(e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e})};var Te={exports:{}};function ke(){}function Se(){}Se.resetWarningCache=ke;Te.exports=function(){function e(e,t,r,s,n,i){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==i){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Se,resetWarningCache:ke};return r.PropTypes=r,r}();const Ee=p(Te.exports);var Oe,Ne=m,Pe=(Oe=Ne)&&"object"==typeof Oe&&"default"in Oe?Oe.default:Oe;function Ce(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ae=!("undefined"==typeof window||!window.document||!window.document.createElement);const Re=p(function(e,t,r){if("function"!=typeof e)throw new Error("Expected reducePropsToState to be a function.");if("function"!=typeof t)throw new Error("Expected handleStateChangeOnClient to be a function.");if(void 0!==r&&"function"!=typeof r)throw new Error("Expected mapStateOnServer to either be undefined or a function.");return function(s){if("function"!=typeof s)throw new Error("Expected WrappedComponent to be a React component.");var n,i=[];function o(){n=e(i.map(function(e){return e.props})),a.canUseDOM?t(n):r&&(n=r(n))}var a=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.peek=function(){return n},a.rewind=function(){if(a.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var e=n;return n=void 0,i=[],e};var l=a.prototype;return l.UNSAFE_componentWillMount=function(){i.push(this),o()},l.componentDidUpdate=function(){o()},l.componentWillUnmount=function(){var e=i.indexOf(this);i.splice(e,1),o()},l.render=function(){return Pe.createElement(s,this.props)},a}(Ne.PureComponent);return Ce(a,"displayName","SideEffect("+function(e){return e.displayName||e.name||"Component"}(s)+")"),Ce(a,"canUseDOM",Ae),a}});var Ie="undefined"!=typeof Element,$e="function"==typeof Map,Le="function"==typeof Set,De="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function Ue(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var r,s,n,i;if(Array.isArray(e)){if((r=e.length)!=t.length)return!1;for(s=r;0!==s--;)if(!Ue(e[s],t[s]))return!1;return!0}if($e&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i=e.entries();!(s=i.next()).done;)if(!t.has(s.value[0]))return!1;for(i=e.entries();!(s=i.next()).done;)if(!Ue(s.value[1],t.get(s.value[0])))return!1;return!0}if(Le&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i=e.entries();!(s=i.next()).done;)if(!t.has(s.value[0]))return!1;return!0}if(De&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if((r=e.length)!=t.length)return!1;for(s=r;0!==s--;)if(e[s]!==t[s])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&"function"==typeof e.valueOf&&"function"==typeof t.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&"function"==typeof e.toString&&"function"==typeof t.toString)return e.toString()===t.toString();if((r=(n=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(s=r;0!==s--;)if(!Object.prototype.hasOwnProperty.call(t,n[s]))return!1;if(Ie&&e instanceof Element)return!1;for(s=r;0!==s--;)if(("_owner"!==n[s]&&"__v"!==n[s]&&"__o"!==n[s]||!e.$$typeof)&&!Ue(e[n[s]],t[n[s]]))return!1;return!0}return e!=e&&t!=t}const Be=p(function(e,t){try{return Ue(e,t)}catch(r){if((r.message||"").match(/stack|recursion/i))return!1;throw r}});
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Me=Object.getOwnPropertySymbols,Fe=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable;const He=p(function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var s={};return"abcdefghijklmnopqrst".split("").forEach(function(e){s[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},s)).join("")}catch(n){return!1}}()?Object.assign:function(e,t){for(var r,s,n=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),i=1;i<arguments.length;i++){for(var o in r=Object(arguments[i]))Fe.call(r,o)&&(n[o]=r[o]);if(Me){s=Me(r);for(var a=0;a<s.length;a++)ze.call(r,s[a])&&(n[s[a]]=r[s[a]])}}return n});var qe="bodyAttributes",Ve="htmlAttributes",We="titleAttributes",Je={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"};Object.keys(Je).map(function(e){return Je[e]});var Ge,Ke,Ye,Qe,Xe="charset",Ze="cssText",et="href",tt="http-equiv",rt="innerHTML",st="itemprop",nt="name",it="property",ot="rel",at="src",lt="target",ct={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},ut="defaultTitle",dt="defer",ht="encodeSpecialCharacters",ft="onChangeClientState",pt="titleTemplate",mt=Object.keys(ct).reduce(function(e,t){return e[ct[t]]=t,e},{}),gt=[Je.NOSCRIPT,Je.SCRIPT,Je.STYLE],yt="data-react-helmet",vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bt=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}(),wt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},_t=function(e,t){var r={};for(var s in e)t.indexOf(s)>=0||Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=e[s]);return r},xt=function(e){return!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},jt=function(e){var t=Ot(e,Je.TITLE),r=Ot(e,pt);if(r&&t)return r.replace(/%s/g,function(){return Array.isArray(t)?t.join(""):t});var s=Ot(e,ut);return t||s||void 0},Tt=function(e){return Ot(e,ft)||function(){}},kt=function(e,t){return t.filter(function(t){return void 0!==t[e]}).map(function(t){return t[e]}).reduce(function(e,t){return wt({},e,t)},{})},St=function(e,t){return t.filter(function(e){return void 0!==e[Je.BASE]}).map(function(e){return e[Je.BASE]}).reverse().reduce(function(t,r){if(!t.length)for(var s=Object.keys(r),n=0;n<s.length;n++){var i=s[n].toLowerCase();if(-1!==e.indexOf(i)&&r[i])return t.concat(r)}return t},[])},Et=function(e,t,r){var s={};return r.filter(function(t){return!!Array.isArray(t[e])||(void 0!==t[e]&&Rt("Helmet: "+e+' should be of type "Array". Instead found type "'+vt(t[e])+'"'),!1)}).map(function(t){return t[e]}).reverse().reduce(function(e,r){var n={};r.filter(function(e){for(var r=void 0,i=Object.keys(e),o=0;o<i.length;o++){var a=i[o],l=a.toLowerCase();-1===t.indexOf(l)||r===ot&&"canonical"===e[r].toLowerCase()||l===ot&&"stylesheet"===e[l].toLowerCase()||(r=l),-1===t.indexOf(a)||a!==rt&&a!==Ze&&a!==st||(r=a)}if(!r||!e[r])return!1;var c=e[r].toLowerCase();return s[r]||(s[r]={}),n[r]||(n[r]={}),!s[r][c]&&(n[r][c]=!0,!0)}).reverse().forEach(function(t){return e.push(t)});for(var i=Object.keys(n),o=0;o<i.length;o++){var a=i[o],l=He({},s[a],n[a]);s[a]=l}return e},[]).reverse()},Ot=function(e,t){for(var r=e.length-1;r>=0;r--){var s=e[r];if(s.hasOwnProperty(t))return s[t]}return null},Nt=(Ge=Date.now(),function(e){var t=Date.now();t-Ge>16?(Ge=t,e(t)):setTimeout(function(){Nt(e)},0)}),Pt=function(e){return clearTimeout(e)},Ct="undefined"!=typeof window?window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||Nt:global.requestAnimationFrame||Nt,At="undefined"!=typeof window?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||Pt:global.cancelAnimationFrame||Pt,Rt=function(e){return console&&"function"==typeof console.warn&&void 0},It=null,$t=function(e,t){var r=e.baseTag,s=e.bodyAttributes,n=e.htmlAttributes,i=e.linkTags,o=e.metaTags,a=e.noscriptTags,l=e.onChangeClientState,c=e.scriptTags,u=e.styleTags,d=e.title,h=e.titleAttributes;Ut(Je.BODY,s),Ut(Je.HTML,n),Dt(d,h);var f={baseTag:Bt(Je.BASE,r),linkTags:Bt(Je.LINK,i),metaTags:Bt(Je.META,o),noscriptTags:Bt(Je.NOSCRIPT,a),scriptTags:Bt(Je.SCRIPT,c),styleTags:Bt(Je.STYLE,u)},p={},m={};Object.keys(f).forEach(function(e){var t=f[e],r=t.newTags,s=t.oldTags;r.length&&(p[e]=r),s.length&&(m[e]=f[e].oldTags)}),t&&t(),l(e,p,m)},Lt=function(e){return Array.isArray(e)?e.join(""):e},Dt=function(e,t){void 0!==e&&document.title!==e&&(document.title=Lt(e)),Ut(Je.TITLE,t)},Ut=function(e,t){var r=document.getElementsByTagName(e)[0];if(r){for(var s=r.getAttribute(yt),n=s?s.split(","):[],i=[].concat(n),o=Object.keys(t),a=0;a<o.length;a++){var l=o[a],c=t[l]||"";r.getAttribute(l)!==c&&r.setAttribute(l,c),-1===n.indexOf(l)&&n.push(l);var u=i.indexOf(l);-1!==u&&i.splice(u,1)}for(var d=i.length-1;d>=0;d--)r.removeAttribute(i[d]);n.length===i.length?r.removeAttribute(yt):r.getAttribute(yt)!==o.join(",")&&r.setAttribute(yt,o.join(","))}},Bt=function(e,t){var r=document.head||document.querySelector(Je.HEAD),s=r.querySelectorAll(e+"["+yt+"]"),n=Array.prototype.slice.call(s),i=[],o=void 0;return t&&t.length&&t.forEach(function(t){var r=document.createElement(e);for(var s in t)if(t.hasOwnProperty(s))if(s===rt)r.innerHTML=t.innerHTML;else if(s===Ze)r.styleSheet?r.styleSheet.cssText=t.cssText:r.appendChild(document.createTextNode(t.cssText));else{var a=void 0===t[s]?"":t[s];r.setAttribute(s,a)}r.setAttribute(yt,"true"),n.some(function(e,t){return o=t,r.isEqualNode(e)})?n.splice(o,1):i.push(r)}),n.forEach(function(e){return e.parentNode.removeChild(e)}),i.forEach(function(e){return r.appendChild(e)}),{oldTags:n,newTags:i}},Mt=function(e){return Object.keys(e).reduce(function(t,r){var s=void 0!==e[r]?r+'="'+e[r]+'"':""+r;return t?t+" "+s:s},"")},Ft=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).reduce(function(t,r){return t[ct[r]||r]=e[r],t},t)},zt=function(e,t,r){switch(e){case Je.TITLE:return{toComponent:function(){return e=t.title,r=t.titleAttributes,(s={key:e})[yt]=!0,n=Ft(r,s),[g.createElement(Je.TITLE,n,e)];var e,r,s,n},toString:function(){return function(e,t,r,s){var n=Mt(r),i=Lt(t);return n?"<"+e+" "+yt+'="true" '+n+">"+xt(i,s)+"</"+e+">":"<"+e+" "+yt+'="true">'+xt(i,s)+"</"+e+">"}(e,t.title,t.titleAttributes,r)}};case qe:case Ve:return{toComponent:function(){return Ft(t)},toString:function(){return Mt(t)}};default:return{toComponent:function(){return function(e,t){return t.map(function(t,r){var s,n=((s={key:r})[yt]=!0,s);return Object.keys(t).forEach(function(e){var r=ct[e]||e;if(r===rt||r===Ze){var s=t.innerHTML||t.cssText;n.dangerouslySetInnerHTML={__html:s}}else n[r]=t[e]}),g.createElement(e,n)})}(e,t)},toString:function(){return function(e,t,r){return t.reduce(function(t,s){var n=Object.keys(s).filter(function(e){return!(e===rt||e===Ze)}).reduce(function(e,t){var n=void 0===s[t]?t:t+'="'+xt(s[t],r)+'"';return e?e+" "+n:n},""),i=s.innerHTML||s.cssText||"",o=-1===gt.indexOf(e);return t+"<"+e+" "+yt+'="true" '+n+(o?"/>":">"+i+"</"+e+">")},"")}(e,t,r)}}}},Ht=function(e){var t=e.baseTag,r=e.bodyAttributes,s=e.encode,n=e.htmlAttributes,i=e.linkTags,o=e.metaTags,a=e.noscriptTags,l=e.scriptTags,c=e.styleTags,u=e.title,d=void 0===u?"":u,h=e.titleAttributes;return{base:zt(Je.BASE,t,s),bodyAttributes:zt(qe,r,s),htmlAttributes:zt(Ve,n,s),link:zt(Je.LINK,i,s),meta:zt(Je.META,o,s),noscript:zt(Je.NOSCRIPT,a,s),script:zt(Je.SCRIPT,l,s),style:zt(Je.STYLE,c,s),title:zt(Je.TITLE,{title:d,titleAttributes:h},s)}},qt=Re(function(e){return{baseTag:St([et,lt],e),bodyAttributes:kt(qe,e),defer:Ot(e,dt),encode:Ot(e,ht),htmlAttributes:kt(Ve,e),linkTags:Et(Je.LINK,[ot,et],e),metaTags:Et(Je.META,[nt,Xe,tt,it,st],e),noscriptTags:Et(Je.NOSCRIPT,[rt],e),onChangeClientState:Tt(e),scriptTags:Et(Je.SCRIPT,[at,rt],e),styleTags:Et(Je.STYLE,[Ze],e),title:jt(e),titleAttributes:kt(We,e)}},function(e){It&&At(It),e.defer?It=Ct(function(){$t(e,function(){It=null})}):($t(e),It=null)},Ht)(function(){return null}),Vt=(Ke=qt,Qe=Ye=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.shouldComponentUpdate=function(e){return!Be(this.props,e)},t.prototype.mapNestedChildrenToProps=function(e,t){if(!t)return null;switch(e.type){case Je.SCRIPT:case Je.NOSCRIPT:return{innerHTML:t};case Je.STYLE:return{cssText:t}}throw new Error("<"+e.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},t.prototype.flattenArrayTypeChildren=function(e){var t,r=e.child,s=e.arrayTypeChildren,n=e.newChildProps,i=e.nestedChildren;return wt({},s,((t={})[r.type]=[].concat(s[r.type]||[],[wt({},n,this.mapNestedChildrenToProps(r,i))]),t))},t.prototype.mapObjectTypeChildren=function(e){var t,r,s=e.child,n=e.newProps,i=e.newChildProps,o=e.nestedChildren;switch(s.type){case Je.TITLE:return wt({},n,((t={})[s.type]=o,t.titleAttributes=wt({},i),t));case Je.BODY:return wt({},n,{bodyAttributes:wt({},i)});case Je.HTML:return wt({},n,{htmlAttributes:wt({},i)})}return wt({},n,((r={})[s.type]=wt({},i),r))},t.prototype.mapArrayTypeChildrenToProps=function(e,t){var r=wt({},t);return Object.keys(e).forEach(function(t){var s;r=wt({},r,((s={})[t]=e[t],s))}),r},t.prototype.warnOnInvalidChildren=function(e,t){return!0},t.prototype.mapChildrenToProps=function(e,t){var r=this,s={};return g.Children.forEach(e,function(e){if(e&&e.props){var n=e.props,i=n.children,o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).reduce(function(t,r){return t[mt[r]||r]=e[r],t},t)}(_t(n,["children"]));switch(r.warnOnInvalidChildren(e,i),e.type){case Je.LINK:case Je.META:case Je.NOSCRIPT:case Je.SCRIPT:case Je.STYLE:s=r.flattenArrayTypeChildren({child:e,arrayTypeChildren:s,newChildProps:o,nestedChildren:i});break;default:t=r.mapObjectTypeChildren({child:e,newProps:t,newChildProps:o,nestedChildren:i})}}}),t=this.mapArrayTypeChildrenToProps(s,t)},t.prototype.render=function(){var e=this.props,t=e.children,r=_t(e,["children"]),s=wt({},r);return t&&(s=this.mapChildrenToProps(t,s)),g.createElement(Ke,s)},bt(t,null,[{key:"canUseDOM",set:function(e){Ke.canUseDOM=e}}]),t}(g.Component),Ye.propTypes={base:Ee.object,bodyAttributes:Ee.object,children:Ee.oneOfType([Ee.arrayOf(Ee.node),Ee.node]),defaultTitle:Ee.string,defer:Ee.bool,encodeSpecialCharacters:Ee.bool,htmlAttributes:Ee.object,link:Ee.arrayOf(Ee.object),meta:Ee.arrayOf(Ee.object),noscript:Ee.arrayOf(Ee.object),onChangeClientState:Ee.func,script:Ee.arrayOf(Ee.object),style:Ee.arrayOf(Ee.object),title:Ee.string,titleAttributes:Ee.object,titleTemplate:Ee.string},Ye.defaultProps={defer:!0,encodeSpecialCharacters:!0},Ye.peek=Ke.peek,Ye.rewind=function(){var e=Ke.rewind();return e||(e=Ht({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),e},Qe);function Wt(...e){return O(N(e))}Vt.renderStatic=Vt.rewind;const Jt=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,Gt=N,Kt=(e,t)=>r=>{var s;if(null==(null==t?void 0:t.variants))return Gt(e,null==r?void 0:r.class,null==r?void 0:r.className);const{variants:n,defaultVariants:i}=t,o=Object.keys(n).map(e=>{const t=null==r?void 0:r[e],s=null==i?void 0:i[e];if(null===t)return null;const o=Jt(t)||Jt(s);return n[e][o]}),a=r&&Object.entries(r).reduce((e,t)=>{let[r,s]=t;return void 0===s||(e[r]=s),e},{}),l=null==t||null===(s=t.compoundVariants)||void 0===s?void 0:s.reduce((e,t)=>{let{class:r,className:s,...n}=t;return Object.entries(n).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...i,...a}[t]):{...i,...a}[t]===r})?[...e,r,s]:e},[]);return Gt(e,o,l,null==r?void 0:r.class,null==r?void 0:r.className)},Yt=a,Qt=g.forwardRef(({className:r,...s},n)=>e.jsx(t,{ref:n,className:Wt("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",r),...s}));Qt.displayName=t.displayName;const Xt=Kt("data-[swipe=move]:transition-none group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-background border",destructive:"group destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Zt=g.forwardRef(({className:t,variant:s,...n},i)=>e.jsx(r,{ref:i,className:Wt(Xt({variant:s}),t),...n}));Zt.displayName=r.displayName;g.forwardRef(({className:t,...r},n)=>e.jsx(s,{ref:n,className:Wt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...r})).displayName=s.displayName;const er=g.forwardRef(({className:t,...r},s)=>e.jsx(n,{ref:s,className:Wt("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...r,children:e.jsx(P,{className:"h-4 w-4"})}));er.displayName=n.displayName;const tr=g.forwardRef(({className:t,...r},s)=>e.jsx(i,{ref:s,className:Wt("text-sm font-semibold",t),...r}));tr.displayName=i.displayName;const rr=g.forwardRef(({className:t,...r},s)=>e.jsx(o,{ref:s,className:Wt("text-sm opacity-90",t),...r}));rr.displayName=o.displayName;let sr=0;const nr={state:{toasts:[]},listeners:[],getState:()=>nr.state,setState:e=>{nr.state="function"==typeof e?e(nr.state):{...nr.state,...e},nr.listeners.forEach(e=>e(nr.state))},subscribe:e=>(nr.listeners.push(e),()=>{nr.listeners=nr.listeners.filter(t=>t!==e)})},ir=({...e})=>{const t=(sr=(sr+1)%Number.MAX_VALUE,sr.toString()),r=()=>nr.setState(e=>({...e,toasts:e.toasts.filter(e=>e.id!==t)}));return nr.setState(s=>({...s,toasts:[{...e,id:t,dismiss:r},...s.toasts].slice(0,1)})),{id:t,dismiss:r,update:e=>nr.setState(r=>({...r,toasts:r.toasts.map(r=>r.id===t?{...r,...e}:r)}))}};function or(){const[e,t]=m.useState(nr.getState());return m.useEffect(()=>nr.subscribe(e=>{t(e)}),[]),m.useEffect(()=>{const t=[];return e.toasts.forEach(e=>{if(e.duration===1/0)return;const r=setTimeout(()=>{e.dismiss()},e.duration||5e3);t.push(r)}),()=>{t.forEach(e=>clearTimeout(e))}},[e.toasts]),{toast:ir,toasts:e.toasts}}function ar(){const{toasts:t}=or();return e.jsxs(Yt,{children:[t.map(({id:t,title:r,description:s,action:n,...i})=>e.jsxs(Zt,{...i,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(tr,{children:r}),s&&e.jsx(rr,{children:s})]}),n,e.jsx(er,{})]},t)),e.jsx(Qt,{})]})}class lr extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class cr extends lr{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ur extends lr{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class dr extends lr{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var hr,fr;(fr=hr||(hr={})).Any="any",fr.ApNortheast1="ap-northeast-1",fr.ApNortheast2="ap-northeast-2",fr.ApSouth1="ap-south-1",fr.ApSoutheast1="ap-southeast-1",fr.ApSoutheast2="ap-southeast-2",fr.CaCentral1="ca-central-1",fr.EuCentral1="eu-central-1",fr.EuWest1="eu-west-1",fr.EuWest2="eu-west-2",fr.EuWest3="eu-west-3",fr.SaEast1="sa-east-1",fr.UsEast1="us-east-1",fr.UsWest1="us-west-1",fr.UsWest2="us-west-2";var pr=globalThis&&globalThis.__awaiter||function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((s=s.apply(e,t||[])).next())})};class mr{constructor(e,{headers:t={},customFetch:r,region:s=hr.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>je(()=>Promise.resolve().then(()=>Or),void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)})(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return pr(this,arguments,void 0,function*(e,t={}){var r;try{const{headers:s,method:n,body:i,signal:o}=t;let a={},{region:l}=t;l||(l=this.region);const c=new URL(`${this.url}/${e}`);let u;l&&"any"!==l&&(a["x-region"]=l,c.searchParams.set("forceFunctionRegion",l)),i&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&("undefined"!=typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=i):"string"==typeof i?(a["Content-Type"]="text/plain",u=i):"undefined"!=typeof FormData&&i instanceof FormData?u=i:(a["Content-Type"]="application/json",u=JSON.stringify(i)));const d=yield this.fetch(c.toString(),{method:n||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:u,signal:o}).catch(e=>{if("AbortError"===e.name)throw e;throw new cr(e)}),h=d.headers.get("x-relay-error");if(h&&"true"===h)throw new ur(d);if(!d.ok)throw new dr(d);let f,p=(null!==(r=d.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return f="application/json"===p?yield d.json():"application/octet-stream"===p?yield d.blob():"text/event-stream"===p?d:"multipart/form-data"===p?yield d.formData():yield d.text(),{data:f,error:null,response:d}}catch(s){return s instanceof Error&&"AbortError"===s.name?{data:null,error:new cr(s)}:{data:null,error:s,response:s instanceof dr||s instanceof ur?s.context:void 0}}})}}var gr={},yr={},vr={},br={},wr={},_r={},xr=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const jr=xr.fetch,Tr=xr.fetch.bind(xr),kr=xr.Headers,Sr=xr.Request,Er=xr.Response,Or=Object.freeze(Object.defineProperty({__proto__:null,Headers:kr,Request:Sr,Response:Er,default:Tr,fetch:jr},Symbol.toStringTag,{value:"Module"})),Nr=y(Or);var Pr={};Object.defineProperty(Pr,"__esModule",{value:!0});let Cr=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Pr.default=Cr;var Ar=v&&v.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_r,"__esModule",{value:!0});const Rr=Ar(Nr),Ir=Ar(Pr);_r.default=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(r=e.isMaybeSingle)&&void 0!==r&&r,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=Rr.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,s,n;let i=null,o=null,a=null,l=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){const r=await e.text();""===r||(o="text/csv"===this.headers.get("Accept")||this.headers.get("Accept")&&(null===(t=this.headers.get("Accept"))||void 0===t?void 0:t.includes("application/vnd.pgrst.plan+text"))?r:JSON.parse(r))}const n=null===(r=this.headers.get("Prefer"))||void 0===r?void 0:r.match(/count=(exact|planned|estimated)/),u=null===(s=e.headers.get("content-range"))||void 0===s?void 0:s.split("/");n&&u&&u.length>1&&(a=parseInt(u[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(o)&&(o.length>1?(i={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,a=null,l=406,c="Not Acceptable"):o=1===o.length?o[0]:null)}else{const t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(o=[],i=null,l=200,c="OK")}catch(u){404===e.status&&""===t?(l=204,c="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null===(n=null==i?void 0:i.details)||void 0===n?void 0:n.includes("0 rows"))&&(i=null,l=200,c="OK"),i&&this.shouldThrowOnError)throw new Ir.default(i)}return{error:i,data:o,count:a,status:l,statusText:c}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,r,s;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(r=null==e?void 0:e.stack)&&void 0!==r?r:""}`,hint:"",code:`${null!==(s=null==e?void 0:e.code)&&void 0!==s?s:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}};var $r=v&&v.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(wr,"__esModule",{value:!0});const Lr=$r(_r);let Dr=class extends Lr.default{select(e){let t=!1;const r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:n=s}={}){const i=n?`${n}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const n=void 0===s?"offset":`${s}.offset`,i=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(i,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:n=!1,format:i="text"}={}){var o;const a=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,n?"wal":null].filter(Boolean).join("|"),l=null!==(o=this.headers.get("Accept"))&&void 0!==o?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${a};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};wr.default=Dr;var Ur=v&&v.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(br,"__esModule",{value:!0});const Br=Ur(wr);let Mr=class extends Br.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let n="";"plain"===s?n="pl":"phrase"===s?n="ph":"websearch"===s&&(n="w");const i=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${n}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};br.default=Mr;var Fr=v&&v.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(vr,"__esModule",{value:!0});const zr=Fr(br);vr.default=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=s}select(e,{head:t=!1,count:r}={}){const s=t?"HEAD":"GET";let n=!1;const i=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join("");return this.url.searchParams.set("select",i),r&&this.headers.append("Prefer",`count=${r}`),new zr.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var s;if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new zr.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:n=!0}={}){var i;if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),void 0!==t&&this.url.searchParams.set("on_conflict",t),s&&this.headers.append("Prefer",`count=${s}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new zr.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}update(e,{count:t}={}){var r;return t&&this.headers.append("Prefer",`count=${t}`),new zr.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})}delete({count:e}={}){var t;return e&&this.headers.append("Prefer",`count=${e}`),new zr.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}};var Hr=v&&v.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yr,"__esModule",{value:!0});const qr=Hr(vr),Vr=Hr(br);yr.default=class e{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=s}from(e){const t=new URL(`${this.url}/${e}`);return new qr.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:s=!1,count:n}={}){var i;let o;const a=new URL(`${this.url}/rpc/${e}`);let l;r||s?(o=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{a.searchParams.append(e,t)})):(o="POST",l=t);const c=new Headers(this.headers);return n&&c.set("Prefer",`count=${n}`),new Vr.default({method:o,url:a,headers:c,schema:this.schemaName,body:l,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}};var Wr=v&&v.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gr,"__esModule",{value:!0}),gr.PostgrestError=gr.PostgrestBuilder=gr.PostgrestTransformBuilder=gr.PostgrestFilterBuilder=gr.PostgrestQueryBuilder=gr.PostgrestClient=void 0;const Jr=Wr(yr);gr.PostgrestClient=Jr.default;const Gr=Wr(vr);gr.PostgrestQueryBuilder=Gr.default;const Kr=Wr(br);gr.PostgrestFilterBuilder=Kr.default;const Yr=Wr(wr);gr.PostgrestTransformBuilder=Yr.default;const Qr=Wr(_r);gr.PostgrestBuilder=Qr.default;const Xr=Wr(Pr);gr.PostgrestError=Xr.default;var Zr=gr.default={PostgrestClient:Jr.default,PostgrestQueryBuilder:Gr.default,PostgrestFilterBuilder:Kr.default,PostgrestTransformBuilder:Yr.default,PostgrestBuilder:Qr.default,PostgrestError:Xr.default};const{PostgrestClient:es,PostgrestQueryBuilder:ts,PostgrestFilterBuilder:rs,PostgrestTransformBuilder:ss,PostgrestBuilder:ns,PostgrestError:is}=Zr;class os{static detectEnvironment(){var e;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!=typeof global&&void 0!==global.WebSocket)return{type:"native",constructor:global.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!=typeof process){const e=process.versions;if(e&&e.node){const t=e.node,r=parseInt(t.replace(/^v/,"").split(".")[0]);return r>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`\n\nSuggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}}const as=1e4;var ls,cs,us,ds,hs,fs,ps,ms,gs,ys,vs;(cs=ls||(ls={}))[cs.connecting=0]="connecting",cs[cs.open=1]="open",cs[cs.closing=2]="closing",cs[cs.closed=3]="closed",(ds=us||(us={})).closed="closed",ds.errored="errored",ds.joined="joined",ds.joining="joining",ds.leaving="leaving",(fs=hs||(hs={})).close="phx_close",fs.error="phx_error",fs.join="phx_join",fs.reply="phx_reply",fs.leave="phx_leave",fs.access_token="access_token",(ps||(ps={})).websocket="websocket",(gs=ms||(ms={})).Connecting="connecting",gs.Open="open",gs.Closing="closing",gs.Closed="closed";class bs{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),n=t.getUint8(2);let i=this.HEADER_LENGTH+2;const o=r.decode(e.slice(i,i+s));i+=s;const a=r.decode(e.slice(i,i+n));i+=n;return{ref:null,topic:o,event:a,payload:JSON.parse(r.decode(e.slice(i,e.byteLength)))}}}class ws{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(vs=ys||(ys={})).abstime="abstime",vs.bool="bool",vs.date="date",vs.daterange="daterange",vs.float4="float4",vs.float8="float8",vs.int2="int2",vs.int4="int4",vs.int4range="int4range",vs.int8="int8",vs.int8range="int8range",vs.json="json",vs.jsonb="jsonb",vs.money="money",vs.numeric="numeric",vs.oid="oid",vs.reltime="reltime",vs.text="text",vs.time="time",vs.timestamp="timestamp",vs.timestamptz="timestamptz",vs.timetz="timetz",vs.tsrange="tsrange",vs.tstzrange="tstzrange";const _s=(e,t,r={})=>{var s;const n=null!==(s=r.skipTypes)&&void 0!==s?s:[];return t?Object.keys(t).reduce((r,s)=>(r[s]=xs(s,e,t,n),r),{}):{}},xs=(e,t,r,s)=>{const n=t.find(t=>t.name===e),i=null==n?void 0:n.type,o=r[e];return i&&!s.includes(i)?js(i,o):Ts(o)},js=(e,t)=>{if("_"===e.charAt(0)){const r=e.slice(1,e.length);return Os(t,r)}switch(e){case ys.bool:return ks(t);case ys.float4:case ys.float8:case ys.int2:case ys.int4:case ys.int8:case ys.numeric:case ys.oid:return Ss(t);case ys.json:case ys.jsonb:return Es(t);case ys.timestamp:return Ns(t);case ys.abstime:case ys.date:case ys.daterange:case ys.int4range:case ys.int8range:case ys.money:case ys.reltime:case ys.text:case ys.time:case ys.timestamptz:case ys.timetz:case ys.tsrange:case ys.tstzrange:default:return Ts(t)}},Ts=e=>e,ks=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Ss=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Es=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e}return e},Os=(e,t)=>{if("string"!=typeof e)return e;const r=e.length-1,s=e[r];if("{"===e[0]&&"}"===s){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch(n){s=i?i.split(","):[]}return s.map(e=>js(t,e))}return e},Ns=e=>"string"==typeof e?e.replace(" ","T"):e,Ps=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Cs{constructor(e,t,r={},s=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var As,Rs,Is,$s,Ls,Ds,Us,Bs;(Rs=As||(As={})).SYNC="sync",Rs.JOIN="join",Rs.LEAVE="leave";class Ms{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{const{onJoin:t,onLeave:r,onSync:s}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ms.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=Ms.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],s()}),this.channel._on(r.diff,{},e=>{const{onJoin:t,onLeave:r,onSync:s}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Ms.syncDiff(this.state,e,t,r),s())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const n=this.cloneDeep(e),i=this.transformState(t),o={},a={};return this.map(n,(e,t)=>{i[e]||(a[e]=t)}),this.map(i,(e,t)=>{const r=n[e];if(r){const s=t.map(e=>e.presence_ref),n=r.map(e=>e.presence_ref),i=t.filter(e=>n.indexOf(e.presence_ref)<0),l=r.filter(e=>s.indexOf(e.presence_ref)<0);i.length>0&&(o[e]=i),l.length>0&&(a[e]=l)}else o[e]=t}),this.syncDiff(n,{joins:o,leaves:a},r,s)}static syncDiff(e,t,r,s){const{joins:n,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(n,(t,s)=>{var n;const i=null!==(n=e[t])&&void 0!==n?n:[];if(e[t]=this.cloneDeep(s),i.length>0){const r=e[t].map(e=>e.presence_ref),s=i.filter(e=>r.indexOf(e.presence_ref)<0);e[t].unshift(...s)}r(t,i,s)}),this.map(i,(t,r)=>{let n=e[t];if(!n)return;const i=r.map(e=>e.presence_ref);n=n.filter(e=>i.indexOf(e.presence_ref)<0),e[t]=n,s(t,n,r),0===n.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return t[r]="metas"in s?s.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}($s=Is||(Is={})).ALL="*",$s.INSERT="INSERT",$s.UPDATE="UPDATE",$s.DELETE="DELETE",(Ds=Ls||(Ls={})).BROADCAST="broadcast",Ds.PRESENCE="presence",Ds.POSTGRES_CHANGES="postgres_changes",Ds.SYSTEM="system",(Bs=Us||(Us={})).SUBSCRIBED="SUBSCRIBED",Bs.TIMED_OUT="TIMED_OUT",Bs.CLOSED="CLOSED",Bs.CHANNEL_ERROR="CHANNEL_ERROR";class Fs{constructor(e,t={config:{}},r){var s,n;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=us.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Cs(this,hs.join,this.params,this.timeout),this.rejoinTimer=new ws(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=us.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=us.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=us.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=us.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=us.errored,this.rejoinTimer.scheduleTimeout())}),this._on(hs.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new Ms(this),this.broadcastEndpointURL=Ps(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(n=null===(s=this.params.config)||void 0===s?void 0:s.broadcast)||void 0===n?void 0:n.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,s,n;if(this.socket.isConnected()||this.socket.connect(),this.state==us.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params,l=null!==(s=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==s?s:[],c=!!this.bindings[Ls.PRESENCE]&&this.bindings[Ls.PRESENCE].length>0||!0===(null===(n=this.params.config.presence)||void 0===n?void 0:n.enabled),u={},d={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:c}),postgres_changes:l,private:a};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(Us.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(Us.CLOSED)),this.updateJoinPayload(Object.assign({config:d},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var r;if(this.socket.setAuth(),void 0!==t){const s=this.bindings.postgres_changes,n=null!==(r=null==s?void 0:s.length)&&void 0!==r?r:0,i=[];for(let r=0;r<n;r++){const n=s[r],{filter:{event:o,schema:a,table:l,filter:c}}=n,u=t&&t[r];if(!u||u.event!==o||u.schema!==a||u.table!==l||u.filter!==c)return this.unsubscribe(),this.state=us.errored,void(null==e||e(Us.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));i.push(Object.assign(Object.assign({},n),{id:u.id}))}return this.bindings.postgres_changes=i,void(e&&e(Us.SUBSCRIBED))}null==e||e(Us.SUBSCRIBED)}).receive("error",t=>{this.state=us.errored,null==e||e(Us.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(Us.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===us.joined&&e===Ls.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e,t={}){var r,s;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var s,n,i;const o=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(i=null===(n=null===(s=this.params)||void 0===s?void 0:s.config)||void 0===n?void 0:n.broadcast)||void 0===i?void 0:i.ack)||r("ok"),o.receive("ok",()=>r("ok")),o.receive("error",()=>r("error")),o.receive("timeout",()=>r("timed out"))});{const{event:i,payload:o}=e,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,a,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await(null===(s=e.body)||void 0===s?void 0:s.cancel()),e.ok?"ok":"error"}catch(n){return"AbortError"===n.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=us.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(hs.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new Cs(this,hs.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null==r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=us.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const s=new AbortController,n=setTimeout(()=>s.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(n),i}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Cs(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,n;const i=e.toLocaleLowerCase(),{close:o,error:a,leave:l,join:c}=hs;if(r&&[o,a,l,c].indexOf(i)>=0&&r!==this._joinRef())return;let u=this._onMessage(i,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null===(s=this.bindings.postgres_changes)||void 0===s||s.filter(e=>{var t,r,s;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(s=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===s?void 0:s.toLocaleLowerCase())===i}).map(e=>e.callback(u,r)):null===(n=this.bindings[i])||void 0===n||n.filter(e=>{var r,s,n,o,a,l;if(["broadcast","presence","postgres_changes"].includes(i)){if("id"in e){const i=e.id,o=null===(r=e.filter)||void 0===r?void 0:r.event;return i&&(null===(s=t.ids)||void 0===s?void 0:s.includes(i))&&("*"===o||(null==o?void 0:o.toLocaleLowerCase())===(null===(n=t.data)||void 0===n?void 0:n.type.toLocaleLowerCase()))}{const r=null===(a=null===(o=null==e?void 0:e.filter)||void 0===o?void 0:o.event)||void 0===a?void 0:a.toLocaleLowerCase();return"*"===r||r===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===i}).map(e=>{if("object"==typeof u&&"ids"in u){const e=u.data,{schema:t,table:r,commit_timestamp:s,type:n,errors:i}=e,o={schema:t,table:r,commit_timestamp:s,eventType:n,new:{},old:{},errors:i};u=Object.assign(Object.assign({},o),this._getPayloadRecords(e))}e.callback(u,r)})}_isClosed(){return this.state===us.closed}_isJoined(){return this.state===us.joined}_isJoining(){return this.state===us.joining}_isLeaving(){return this.state===us.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),n={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(n):this.bindings[s]=[n],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var s;return!((null===(s=e.type)||void 0===s?void 0:s.toLocaleLowerCase())===r&&Fs.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(hs.close,{},e)}_onError(e){this._on(hs.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=us.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=_s(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=_s(e.columns,e.old_record)),t}}const zs=()=>{},Hs=25e3,qs=10,Vs=100,Ws=[1e3,2e3,5e3,1e4];class Js{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=as,this.transport=null,this.heartbeatIntervalMs=Hs,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=zs,this.ref=0,this.reconnectTimer=null,this.logger=zs,this.conn=null,this.sendBuffer=[],this.serializer=new bs,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>je(()=>Promise.resolve().then(()=>Or),void 0).then(({default:t})=>t(...e)).catch(e=>{throw new Error(`Failed to load @supabase/node-fetch: ${e.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):fetch),(...e)=>t(...e)},!(null===(r=null==t?void 0:t.params)||void 0===r?void 0:r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${ps.websocket}`,this.httpEndpoint=Ps(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=os.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error(`${t}\n\nTo use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })`);throw new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case ls.connecting:return ms.Connecting;case ls.open:return ms.Open;case ls.closing:return ms.Closing;default:return ms.Closed}}isConnected(){return this.connectionState()===ms.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(e=>e.topic===r);if(s)return s;{const r=new Fs(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){const{topic:t,event:r,payload:s,ref:n}=e,i=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${r} (${n})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},Vs)}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event)try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error")}catch(a){this.log("error","error in heartbeat callback",a)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:t,event:r,payload:s,ref:n}=e,i=n?`(${n})`:"",o=s.status||"";this.log("receive",`${o} ${t} ${r} ${i}`.trim(),s),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,s,n)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(hs.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const r=e.match(/\?/)?"&":"?";return`${e}${r}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;t=e||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{const r={access_token:t,version:"realtime-js/2.75.0"};t&&e.updateJoinPayload(r),e.joinedOnce&&e._isJoined()&&e._push(hs.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new ws(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},qs)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,n,i,o,a,l,c;if(this.transport=null!==(t=null==e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(r=null==e?void 0:e.timeout)&&void 0!==r?r:as,this.heartbeatIntervalMs=null!==(s=null==e?void 0:e.heartbeatIntervalMs)&&void 0!==s?s:Hs,this.worker=null!==(n=null==e?void 0:e.worker)&&void 0!==n&&n,this.accessToken=null!==(i=null==e?void 0:e.accessToken)&&void 0!==i?i:null,this.heartbeatCallback=null!==(o=null==e?void 0:e.heartbeatCallback)&&void 0!==o?o:zs,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(a=null==e?void 0:e.reconnectAfterMs)&&void 0!==a?a:e=>Ws[e-1]||1e4,this.encode=null!==(l=null==e?void 0:e.encode)&&void 0!==l?l:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(c=null==e?void 0:e.decode)&&void 0!==c?c:this.serializer.decode.bind(this.serializer),this.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}class Gs extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ks(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class Ys extends Gs{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Qs extends Gs{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Xs=globalThis&&globalThis.__awaiter||function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((s=s.apply(e,t||[])).next())})};const Zs=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>je(()=>Promise.resolve().then(()=>Or),void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},en=e=>{if(Array.isArray(e))return e.map(e=>en(e));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([e,r])=>{const s=e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[s]=en(r)}),t};var tn=globalThis&&globalThis.__awaiter||function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((s=s.apply(e,t||[])).next())})};const rn=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),sn=(e,t,r)=>tn(void 0,void 0,void 0,function*(){const s=yield Xs(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield je(()=>Promise.resolve().then(()=>Or),void 0)).Response:Response});e instanceof s&&!(null==r?void 0:r.noResolveJson)?e.json().then(r=>{const s=e.status||500,n=(null==r?void 0:r.statusCode)||s+"";t(new Ys(rn(r),s,n))}).catch(e=>{t(new Qs(rn(e),e))}):t(new Qs(rn(e),e))}),nn=(e,t,r,s)=>{const n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&s?((e=>{if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)})(s)?(n.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),n.body=JSON.stringify(s)):n.body=s,(null==t?void 0:t.duplex)&&(n.duplex=t.duplex),Object.assign(Object.assign({},n),r)):n};function on(e,t,r,s,n,i){return tn(this,void 0,void 0,function*(){return new Promise((o,a)=>{e(r,nn(t,s,n,i)).then(e=>{if(!e.ok)throw e;return(null==s?void 0:s.noResolveJson)?e:e.json()}).then(e=>o(e)).catch(e=>sn(e,a,s))})})}function an(e,t,r,s){return tn(this,void 0,void 0,function*(){return on(e,"GET",t,r,s)})}function ln(e,t,r,s,n){return tn(this,void 0,void 0,function*(){return on(e,"POST",t,s,n,r)})}function cn(e,t,r,s,n){return tn(this,void 0,void 0,function*(){return on(e,"PUT",t,s,n,r)})}function un(e,t,r,s,n){return tn(this,void 0,void 0,function*(){return on(e,"DELETE",t,s,n,r)})}var dn=globalThis&&globalThis.__awaiter||function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((s=s.apply(e,t||[])).next())})};class hn{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return dn(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ks(e))return{data:null,error:e};throw e}})}}var fn=globalThis&&globalThis.__awaiter||function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((s=s.apply(e,t||[])).next())})};class pn{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}asStream(){return new hn(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.execute().then(e,t)}execute(){return fn(this,void 0,void 0,function*(){try{const e=yield this.downloadFn();return{data:yield e.blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ks(e))return{data:null,error:e};throw e}})}}var mn=globalThis&&globalThis.__awaiter||function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((s=s.apply(e,t||[])).next())})};const gn={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},yn={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class vn{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=Zs(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,s){return mn(this,void 0,void 0,function*(){try{let n;const i=Object.assign(Object.assign({},yn),s);let o=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(i.upsert)});const a=i.metadata;"undefined"!=typeof Blob&&r instanceof Blob?(n=new FormData,n.append("cacheControl",i.cacheControl),a&&n.append("metadata",this.encodeMetadata(a)),n.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(n=r,n.append("cacheControl",i.cacheControl),a&&n.append("metadata",this.encodeMetadata(a))):(n=r,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,a&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),(null==s?void 0:s.headers)&&(o=Object.assign(Object.assign({},o),s.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),u=yield("PUT"==e?cn:ln)(this.fetch,`${this.url}/object/${c}`,n,Object.assign({headers:o},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{}));return{data:{path:l,id:u.Id,fullPath:u.Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ks(n))return{data:null,error:n};throw n}})}upload(e,t,r){return mn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return mn(this,void 0,void 0,function*(){const n=this._removeEmptyFolders(e),i=this._getFinalPath(n),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:yn.upsert},s),i=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r,e.append("cacheControl",t.cacheControl)):(e=r,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType);return{data:{path:n,fullPath:(yield cn(this.fetch,o.toString(),e,{headers:i})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ks(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(e,t){return mn(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(s["x-upsert"]="true");const n=yield ln(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),i=new URL(this.url+n.url),o=i.searchParams.get("token");if(!o)throw new Gs("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ks(r))return{data:null,error:r};throw r}})}update(e,t,r){return mn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return mn(this,void 0,void 0,function*(){try{return{data:yield ln(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ks(s))return{data:null,error:s};throw s}})}copy(e,t,r){return mn(this,void 0,void 0,function*(){try{return{data:{path:(yield ln(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ks(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return mn(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),n=yield ln(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers});const i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return n={signedUrl:encodeURI(`${this.url}${n.signedURL}${i}`)},{data:n,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ks(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return mn(this,void 0,void 0,function*(){try{const s=yield ln(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),n=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:s.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${n}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ks(s))return{data:null,error:s};throw s}})}download(e,t){const r=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),n=s?`?${s}`:"",i=this._getFinalPath(e);return new pn(()=>an(this.fetch,`${this.url}/${r}/${i}${n}`,{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}info(e){return mn(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const e=yield an(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:en(e),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ks(r))return{data:null,error:r};throw r}})}exists(e){return mn(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield function(e,t,r,s){return tn(this,void 0,void 0,function*(){return on(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ks(r)&&r instanceof Qs){const e=r.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],n=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==n&&s.push(n);const i=void 0!==(null==t?void 0:t.transform)?"render/image":"object",o=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==o&&s.push(o);let a=s.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${a}`)}}}remove(e){return mn(this,void 0,void 0,function*(){try{return{data:yield un(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ks(t))return{data:null,error:t};throw t}})}list(e,t,r){return mn(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},gn),t),{prefix:e||""});return{data:yield ln(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ks(s))return{data:null,error:s};throw s}})}listV2(e,t){return mn(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield ln(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ks(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const bn={"X-Client-Info":"storage-js/2.75.0"};var wn=globalThis&&globalThis.__awaiter||function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((s=s.apply(e,t||[])).next())})};class _n{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const n=new URL(e);if(null==s?void 0:s.useNewHostname){/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase."))}this.url=n.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},bn),t),this.fetch=Zs(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return wn(this,void 0,void 0,function*(){try{return{data:yield an(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ks(e))return{data:null,error:e};throw e}})}getBucket(e){return wn(this,void 0,void 0,function*(){try{return{data:yield an(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ks(t))return{data:null,error:t};throw t}})}createBucket(e){return wn(this,arguments,void 0,function*(e,t={public:!1}){try{return{data:yield ln(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ks(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return wn(this,void 0,void 0,function*(){try{return{data:yield cn(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ks(r))return{data:null,error:r};throw r}})}emptyBucket(e){return wn(this,void 0,void 0,function*(){try{return{data:yield ln(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ks(t))return{data:null,error:t};throw t}})}deleteBucket(e){return wn(this,void 0,void 0,function*(){try{return{data:yield un(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ks(t))return{data:null,error:t};throw t}})}}class xn extends _n{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new vn(this.url,this.headers,e,this.fetch)}}const jn={"X-Client-Info":"supabase-js/2.30.0"};var Tn={exports:{}};!function(e,t){var r,s="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==v&&v,n=function(){function e(){this.fetch=!1,this.DOMException=s.DOMException}return e.prototype=s,new e}();r=n,function(e){var t=void 0!==r&&r||"undefined"!=typeof self&&self||void 0!==v&&v||{},s="URLSearchParams"in t,n="Symbol"in t&&"iterator"in Symbol,i="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in t,a="ArrayBuffer"in t;if(a)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&l.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function d(e){return"string"!=typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function p(e){if(!e._noBody)return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function m(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function g(e){var t=new FileReader,r=m(t);return t.readAsArrayBuffer(e),r}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:s&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a&&i&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):s&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=p(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}if(i)return this.blob().then(g);throw new Error("could not read as ArrayBuffer")},this.text=function(){var e,t,r,s,n,i=p(this);if(i)return i;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=m(t),s=/charset=([A-Za-z0-9_-]+)/.exec(e.type),n=s?s[1]:"utf-8",t.readAsText(e,n),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),s=0;s<t.length;s++)r[s]=String.fromCharCode(t[s]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(x)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(e,t){e=u(e),t=d(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},f.prototype.delete=function(e){delete this.map[u(e)]},f.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},f.prototype.set=function(e,t){this.map[u(e)]=d(t)},f.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},f.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),h(e)},f.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),h(e)},f.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),h(e)},n&&(f.prototype[Symbol.iterator]=f.prototype.entries);var w=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function _(e,r){if(!(this instanceof _))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var s,n,i=(r=r||{}).body;if(e instanceof _){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,r.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=r.credentials||this.credentials||"same-origin",!r.headers&&this.headers||(this.headers=new f(r.headers)),this.method=(s=r.method||this.method||"GET",n=s.toUpperCase(),w.indexOf(n)>-1?n:s),this.mode=r.mode||this.mode||null,this.signal=r.signal||this.signal||function(){if("AbortController"in t)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(i),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==r.cache&&"no-cache"!==r.cache)){var o=/([?&])_=[^&]*/;o.test(this.url)?this.url=this.url.replace(o,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function x(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),s=r.shift().replace(/\+/g," "),n=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(s),decodeURIComponent(n))}}),t}function j(e,t){if(!(this instanceof j))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}_.prototype.clone=function(){return new _(this,{body:this._bodyInit})},b.call(_.prototype),b.call(j.prototype),j.prototype.clone=function(){return new j(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},j.error=function(){var e=new j(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var T=[301,302,303,307,308];j.redirect=function(e,t){if(-1===T.indexOf(t))throw new RangeError("Invalid status code");return new j(null,{status:t,headers:{location:e}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(S){e.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function k(r,s){return new Promise(function(n,o){var l=new _(r,s);if(l.signal&&l.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var c=new XMLHttpRequest;function h(){c.abort()}if(c.onload=function(){var e,t,r={statusText:c.statusText,headers:(e=c.getAllResponseHeaders()||"",t=new f,e.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e}).forEach(function(e){var r=e.split(":"),s=r.shift().trim();if(s){var n=r.join(":").trim();try{t.append(s,n)}catch(i){}}}),t)};0===l.url.indexOf("file://")&&(c.status<200||c.status>599)?r.status=200:r.status=c.status,r.url="responseURL"in c?c.responseURL:r.headers.get("X-Request-URL");var s="response"in c?c.response:c.responseText;setTimeout(function(){n(new j(s,r))},0)},c.onerror=function(){setTimeout(function(){o(new TypeError("Network request failed"))},0)},c.ontimeout=function(){setTimeout(function(){o(new TypeError("Network request timed out"))},0)},c.onabort=function(){setTimeout(function(){o(new e.DOMException("Aborted","AbortError"))},0)},c.open(l.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch(r){return e}}(l.url),!0),"include"===l.credentials?c.withCredentials=!0:"omit"===l.credentials&&(c.withCredentials=!1),"responseType"in c&&(i?c.responseType="blob":a&&(c.responseType="arraybuffer")),s&&"object"==typeof s.headers&&!(s.headers instanceof f||t.Headers&&s.headers instanceof t.Headers)){var p=[];Object.getOwnPropertyNames(s.headers).forEach(function(e){p.push(u(e)),c.setRequestHeader(e,d(s.headers[e]))}),l.headers.forEach(function(e,t){-1===p.indexOf(t)&&c.setRequestHeader(t,e)})}else l.headers.forEach(function(e,t){c.setRequestHeader(t,e)});l.signal&&(l.signal.addEventListener("abort",h),c.onreadystatechange=function(){4===c.readyState&&l.signal.removeEventListener("abort",h)}),c.send(void 0===l._bodyInit?null:l._bodyInit)})}k.polyfill=!0,t.fetch||(t.fetch=k,t.Headers=f,t.Request=_,t.Response=j),e.Headers=f,e.Request=_,e.Response=j,e.fetch=k,Object.defineProperty(e,"__esModule",{value:!0})}({}),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=s.fetch?s:n;(t=i.fetch).default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t}(Tn,Tn.exports);var kn=Tn.exports;const Sn=p(kn),En=be({__proto__:null,default:Sn},[kn]);var On=globalThis&&globalThis.__awaiter||function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((s=s.apply(e,t||[])).next())})};const Nn=(e,t,r)=>{const s=(e=>{let t;return t=e||("undefined"==typeof fetch?Sn:fetch),(...e)=>t(...e)})(r),n="undefined"==typeof Headers?kn.Headers:Headers;return(r,i)=>On(void 0,void 0,void 0,function*(){var o;const a=null!==(o=yield t())&&void 0!==o?o:e;let l=new n(null==i?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${a}`),s(r,Object.assign(Object.assign({},i),{headers:l}))})};const Pn=()=>"undefined"!=typeof document,Cn={tested:!1,writable:!1},An=()=>{if(!Pn())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(t){return!1}if(Cn.tested)return Cn.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Cn.tested=!0,Cn.writable=!0}catch(t){Cn.tested=!0,Cn.writable=!1}return Cn.writable};function Rn(e,t){var r;t||(t=(null===(r=null===window||void 0===window?void 0:window.location)||void 0===r?void 0:r.href)||""),e=e.replace(/[\[\]]/g,"\\$&");const s=new RegExp("[?&#]"+e+"(=([^&#]*)|&|#|$)").exec(t);return s?s[2]?decodeURIComponent(s[2].replace(/\+/g," ")):"":null}const In=e=>{let t;return t=e||("undefined"==typeof fetch?async(...e)=>await(await je(()=>Promise.resolve().then(()=>En),void 0)).fetch(...e):fetch),(...e)=>t(...e)},$n=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Ln=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(s){return r}},Dn=async(e,t)=>{await e.removeItem(t)};class Un{constructor(){this.promise=new Un.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function Bn(e){const t=e.split(".");if(3!==t.length)throw new Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=t[1];return JSON.parse(function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let r,s,n,i,o,a,l,c="",u=0;for(e=e.replace("-","+").replace("_","/");u<e.length;)i=t.indexOf(e.charAt(u++)),o=t.indexOf(e.charAt(u++)),a=t.indexOf(e.charAt(u++)),l=t.indexOf(e.charAt(u++)),r=i<<2|o>>4,s=(15&o)<<4|a>>2,n=(3&a)<<6|l,c+=String.fromCharCode(r),64!=a&&0!=s&&(c+=String.fromCharCode(s)),64!=l&&0!=n&&(c+=String.fromCharCode(n));return c}(r))}function Mn(e){return("0"+e.toString(16)).substr(-2)}function Fn(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let r="";for(let s=0;s<56;s++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,Mn).join("")}async function zn(e){if("undefined"==typeof crypto)return e;const t=await async function(e){const t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}Un.promiseConstructor=Promise;const Hn=/__stack_guard__([a-zA-Z0-9_-]+)__/;let qn,Vn=!1;function Wn(e){var t,r;let s;qn();try{throw new Error}catch(i){s=i}const n=null!==(r=null===(t=s.stack)||void 0===t?void 0:t.split("\n"))&&void 0!==r?r:[];for(let o=0;o<n.length;o+=1){const t=n[o].match(Hn);if(t&&t[1]===e)return!0}return!1}async function Jn(e,t){await qn();const r=`__stack_guard__${e}__`,s={[r]:async()=>await t()};return await s[r]()}qn=async()=>{Vn||(Vn=!0,await Jn("ENV_CHECK",async()=>{const e=Wn("ENV_CHECK");return e}))};class Gn extends Error{constructor(e,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t}}function Kn(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class Yn extends Gn{constructor(e,t){super(e,t),this.name="AuthApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Qn extends Gn{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Xn extends Gn{constructor(e,t,r){super(e),this.name=t,this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Zn extends Xn{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class ei extends Xn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class ti extends Xn{constructor(e){super(e,"AuthInvalidCredentialsError",400)}}class ri extends Xn{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class si extends Xn{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ni extends Xn{constructor(e,t){super(e,"AuthRetryableFetchError",t)}}function ii(e){return Kn(e)&&"AuthRetryableFetchError"===e.name}var oi=globalThis&&globalThis.__rest||function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]])}return r};const ai=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),li=[502,503,504];async function ci(e){if(!("object"==typeof(t=e)&&null!==t&&"status"in t&&"ok"in t&&"json"in t&&"function"==typeof t.json))throw new ni(ai(e),0);var t;if(li.includes(e.status))throw new ni(ai(e),e.status);let r;try{r=await e.json()}catch(s){throw new Qn(ai(s),s)}throw new Yn(ai(r),e.status||500)}async function ui(e,t,r,s){var n;const i=Object.assign({},null==s?void 0:s.headers);(null==s?void 0:s.jwt)&&(i.Authorization=`Bearer ${s.jwt}`);const o=null!==(n=null==s?void 0:s.query)&&void 0!==n?n:{};(null==s?void 0:s.redirectTo)&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await async function(e,t,r,s,n,i){const o=((e,t,r,s)=>{const n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))})(t,s,n,i);let a;try{a=await e(r,o)}catch(l){throw new ni(ai(l),0)}a.ok||await ci(a);if(null==s?void 0:s.noResolveJson)return a;try{return await a.json()}catch(l){await ci(l)}}(e,t,r+a,{headers:i,noResolveJson:null==s?void 0:s.noResolveJson},{},null==s?void 0:s.body);return(null==s?void 0:s.xform)?null==s?void 0:s.xform(l):{data:Object.assign({},l),error:null}}function di(e){var t;let r=null;var s;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(r=Object.assign({},e),r.expires_at=(s=e.expires_in,Math.round(Date.now()/1e3)+s));return{data:{session:r,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function hi(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function fi(e){return{data:e,error:null}}function pi(e){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i}=e,o=oi(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i},user:Object.assign({},o)},error:null}}function mi(e){return e}var gi=globalThis&&globalThis.__rest||function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]])}return r};class yi{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=In(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await ui(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Kn(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await ui(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:hi})}catch(r){if(Kn(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=gi(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=null==r?void 0:r.newEmail,delete s.newEmail),await ui(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:pi,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if(Kn(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await ui(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:hi})}catch(t){if(Kn(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,n,i,o,a;try{const l={nextPage:null,lastPage:0,total:0},c=await ui(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(n=null===(s=null==e?void 0:e.perPage)||void 0===s?void 0:s.toString())&&void 0!==n?n:""},xform:mi});if(c.error)throw c.error;const u=await c.json(),d=null!==(i=c.headers.get("x-total-count"))&&void 0!==i?i:0,h=null!==(a=null===(o=c.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==a?a:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(Kn(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await ui(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:hi})}catch(t){if(Kn(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await ui(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:hi})}catch(r){if(Kn(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await ui(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:hi})}catch(r){if(Kn(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await ui(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(t){if(Kn(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await ui(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Kn(t))return{data:null,error:t};throw t}}}const vi={"X-Client-Info":"gotrue-js/2.43.1"},bi={getItem:e=>An()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{An()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{An()&&globalThis.localStorage.removeItem(e)}};!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const wi={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:vi,flowType:"implicit",debug:!1},_i=3e4;class xi{constructor(e){var t;this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.broadcastChannel=null,this.instanceID=xi.nextInstanceID,xi.nextInstanceID+=1,this.instanceID>0&&Pn();const r=Object.assign(Object.assign({},wi),e);if(this.logDebugMessages=r.debug,this.inMemorySession=null,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.persistSession=r.persistSession,this.storage=r.storage||bi,this.admin=new yi({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=In(r.fetch),this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession&&this.storage===bi&&An(),Pn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){}null===(t=this.broadcastChannel)||void 0===t||t.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages,this}initialize(){return this.initializePromise?this.initializePromise:this._initialize()}async _initialize(){if(this.initializePromise)throw new Error("Double call of #_initialize()");return this.initializePromise=Jn("_initialize",async()=>{try{const e=!!Pn()&&await this._isPKCEFlow();if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:t,error:r}=await this._getSessionFromUrl(e);if(r)return this._debug("#_initialize()","error detecting session from URL",r),await this._removeSession(),{error:r};const{session:s,redirectType:n}=t;return this._debug("#_initialize()","detected session in URL",s,"redirect type",n),await this._saveSession(s),setTimeout(async()=>{"recovery"===n?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return Kn(e)?{error:e}:{error:new Qn("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}),await this.initializePromise}async signUp(e){var t,r,s;try{let n;if(await this._removeSession(),"email"in e){const{email:r,password:s,options:i}=e;let o=null,a=null;if("pkce"===this.flowType){const e=Fn();await $n(this.storage,`${this.storageKey}-code-verifier`,e),o=await zn(e),a=e===o?"plain":"s256"}n=await ui(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==i?void 0:i.emailRedirectTo,body:{email:r,password:s,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:o,code_challenge_method:a},xform:di})}else{if(!("phone"in e))throw new ti("You must provide either an email or phone number and a password");{const{phone:t,password:i,options:o}=e;n=await ui(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:i,data:null!==(r=null==o?void 0:o.data)&&void 0!==r?r:{},channel:null!==(s=null==o?void 0:o.channel)&&void 0!==s?s:"sms",gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},xform:di})}}const{data:i,error:o}=n;if(o||!i)return{data:{user:null,session:null},error:o};const a=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(n){if(Kn(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithPassword(e){try{let t;if(await this._removeSession(),"email"in e){const{email:r,password:s,options:n}=e;t=await ui(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:di})}else{if(!("phone"in e))throw new ti("You must provide either an email or phone number and a password");{const{phone:r,password:s,options:n}=e;t=await ui(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:di})}}const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:r&&r.session&&r.user?(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:{user:r.user,session:r.session},error:s}):{data:{user:null,session:null},error:new ei}}catch(t){if(Kn(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,n;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(s=e.options)||void 0===s?void 0:s.queryParams,skipBrowserRedirect:null===(n=e.options)||void 0===n?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(e){const t=await Ln(this.storage,`${this.storageKey}-code-verifier`),{data:r,error:s}=await ui(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:t},xform:di});return await Dn(this.storage,`${this.storageKey}-code-verifier`),s?{data:{user:null,session:null},error:s}:r&&r.session&&r.user?(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:r,error:s}):{data:{user:null,session:null},error:new ei}}async signInWithIdToken(e){await this._removeSession();try{const{options:t,provider:r,token:s,access_token:n,nonce:i}=e,o=await ui(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:n,nonce:i,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:di}),{data:a,error:l}=o;return l?{data:{user:null,session:null},error:l}:a&&a.session&&a.user?(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:l}):{data:{user:null,session:null},error:new ei}}catch(t){if(Kn(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,n,i;try{if(await this._removeSession(),"email"in e){const{email:s,options:n}=e;let i=null,o=null;if("pkce"===this.flowType){const e=Fn();await $n(this.storage,`${this.storageKey}-code-verifier`,e),i=await zn(e),o=e===i?"plain":"s256"}const{error:a}=await ui(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:s,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},create_user:null===(r=null==n?void 0:n.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:i,code_challenge_method:o},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){const{phone:t,options:r}=e,{data:o,error:a}=await ui(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(s=null==r?void 0:r.data)&&void 0!==s?s:{},create_user:null===(n=null==r?void 0:r.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(i=null==r?void 0:r.channel)&&void 0!==i?i:"sms"}});return{data:{user:null,session:null,messageId:null==o?void 0:o.message_id},error:a}}throw new ti("You must provide either an email or phone number.")}catch(o){if(Kn(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,r;try{"email_change"!==e.type&&"phone_change"!==e.type&&await this._removeSession();const{data:s,error:n}=await ui(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:null===(t=e.options)||void 0===t?void 0:t.captchaToken}}),redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,xform:di});if(n)throw n;if(!s)throw new Error("An error occurred on token verification.");const i=s.session,o=s.user;return(null==i?void 0:i.access_token)&&(await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)),{data:{user:o,session:i},error:null}}catch(s){if(Kn(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{return await this._removeSession(),await ui(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(s=null==e?void 0:e.options)||void 0===s?void 0:s.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0}),headers:this.headers,xform:fi})}catch(n){if(Kn(n))return{data:null,error:n};throw n}}async reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Zn;const{error:s}=await ui(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(Kn(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{"email_change"!=e.type&&"phone_change"!=e.type&&await this._removeSession();const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:n}=e,{error:i}=await ui(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){const{phone:r,type:s,options:n}=e,{data:i,error:o}=await ui(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:o}}throw new ti("You must provide either an email or phone number and a type")}catch(t){if(Kn(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return this._useSession(async e=>e)}async _useSession(e){return await Jn("_useSession",async()=>{const t=await this.__loadSession();return await e(t)})}async __loadSession(){if(this._debug("#__loadSession()","begin"),this.logDebugMessages&&!Wn("_useSession"))throw new Error("Please use #_useSession()");Wn("_initialize")||await this.initializePromise;try{let e=null;if(this.persistSession){const t=await Ln(this.storage,this.storageKey);this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession()))}else e=this.inMemorySession,this._debug("#getSession()","session from memory",e);if(!e)return{data:{session:null},error:null};const t=!!e.expires_at&&e.expires_at<=Date.now()/1e3;if(this._debug("#__loadSession()",`session has${t?"":" not"} expired`,"expires_at",e.expires_at),!t)return{data:{session:e},error:null};const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){try{return await this._useSession(async t=>{var r,s;if(!e){const{data:n,error:i}=t;if(i)throw i;e=null!==(s=null===(r=n.session)||void 0===r?void 0:r.access_token)&&void 0!==s?s:void 0}return await ui(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:hi})})}catch(t){if(Kn(t))return{data:{user:null},error:t};throw t}}async updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:n}=r;if(n)throw n;if(!s.session)throw new Zn;const i=s.session,{data:o,error:a}=await ui(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:e,jwt:i.access_token,xform:hi});if(a)throw a;return i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(r){if(Kn(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return Bn(e)}async setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Zn;const t=Date.now()/1e3;let r=t,s=!0,n=null;const i=Bn(e.access_token);if(i.exp&&(r=i.exp,s=r<=t),s){const{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};n=t}else{const{data:s,error:i}=await this.getUser(e.access_token);if(i)throw i;n={access_token:e.access_token,refresh_token:e.refresh_token,user:s.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)}return{data:{user:n.user,session:n},error:null}}catch(t){if(Kn(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:s,error:n}=t;if(n)throw n;e=null!==(r=s.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new Zn;const{session:s,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{user:null,session:null},error:n}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Kn(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromUrl(e){try{if(!Pn())throw new ri("No browser detected.");if("implicit"===this.flowType&&!this._isImplicitGrantFlow())throw new ri("Not a valid implicit grant flow url.");if("pkce"==this.flowType&&!e)throw new si("Not a valid PKCE flow url.");if(e){const e=Rn("code");if(!e)throw new si("No code detected.");const{data:t,error:r}=await this.exchangeCodeForSession(e);if(r)throw r;if(!t.session)throw new si("No session detected.");let s=new URL(window.location.href);return s.searchParams.delete("code"),window.history.replaceState(window.history.state,"",s.toString()),{data:{session:t.session,redirectType:null},error:null}}const t=Rn("error_description");if(t){const e=Rn("error_code");if(!e)throw new ri("No error_code detected.");const r=Rn("error");if(!r)throw new ri("No error detected.");throw new ri(t,{error:r,code:e})}const r=Rn("provider_token"),s=Rn("provider_refresh_token"),n=Rn("access_token");if(!n)throw new ri("No access_token detected.");const i=Rn("expires_in");if(!i)throw new ri("No expires_in detected.");const o=Rn("refresh_token");if(!o)throw new ri("No refresh_token detected.");const a=Rn("token_type");if(!a)throw new ri("No token_type detected.");const l=Math.round(Date.now()/1e3)+parseInt(i),{data:c,error:u}=await this.getUser(n);if(u)throw u;const d=c.user,h={provider_token:r,provider_refresh_token:s,access_token:n,expires_in:parseInt(i),expires_at:l,refresh_token:o,token_type:a,user:d},f=Rn("type");return window.location.hash="",this._debug("#_getSessionFromUrl()","clearing window.location.hash"),{data:{session:h,redirectType:f},error:null}}catch(t){if(Kn(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){return Pn()&&(Boolean(Rn("access_token"))||Boolean(Rn("error_description")))}async _isPKCEFlow(){const e=await Ln(this.storage,`${this.storageKey}-code-verifier`);return Boolean(Rn("code"))&&Boolean(e)}async signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:n}=t;if(n)return{error:n};const i=null===(r=s.session)||void 0===r?void 0:r.access_token;if(i){const{error:t}=await this.admin.signOut(i,e);if(t&&(!function(e){return Kn(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await Dn(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),this._emitInitialSession(t),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:s},error:n}=t;if(n)throw n;await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(n){await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",n)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;if("pkce"===this.flowType){const e=Fn();await $n(this.storage,`${this.storageKey}-code-verifier`,e),r=await zn(e),s=e===r?"plain":"s256"}try{return await ui(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(n){if(Kn(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await(r=async r=>{var s;return await(s=200*r,new Promise(e=>{setTimeout(()=>e(null),s)})),this._debug(t,"refreshing attempt",r),await ui(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:di})},s=(e,t,r)=>r&&r.error&&ii(r.error)&&Date.now()+200*(e+1)-n<_i,new Promise((e,t)=>{(async()=>{for(let i=0;i<1/0;i++)try{const t=await r(i);if(!s(i,null,t))return void e(t)}catch(n){if(!s(i,n))return void t(n)}})()}))}catch(n){if(this._debug(t,"error",n),Kn(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}var r,s}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Pn()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await Ln(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r))return this._debug(t,"session is not valid"),void(null!==r&&await this._removeSession());const s=Math.round(Date.now()/1e3),n=(null!==(e=r.expires_at)&&void 0!==e?e:1/0)<s+10;if(this._debug(t,`session has${n?"":" not"} expired with margin of 10s`),n){if(this.autoRefreshToken&&r.refresh_token){const{error:e}=await this._callRefreshToken(r.refresh_token);e&&(ii(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){return void this._debug(t,"error",r)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Zn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Un;const{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new Zn;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const s={session:t.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(n){if(this._debug(s,"error",n),Kn(n)){const e={session:null,error:n};return null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(n),n}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const s=[],n=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(n){s.push(n)}});if(await Promise.all(n),s.length>0){for(let e=0;e<s.length;e+=1);throw s[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.persistSession||(this.inMemorySession=e),this.persistSession&&e.expires_at&&await this._persistSession(e)}_persistSession(e){return this._debug("#_persistSession()",e),$n(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),this.persistSession?await Dn(this.storage,this.storageKey):this.inMemorySession=null}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Pn()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),_i);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),await this._autoRefreshTokenTick()}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:r}}=e;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const s=Math.floor((1e3*r.expires_at-t)/_i);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),s<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){}}finally{this._debug("#_autoRefreshTokenTick()","end")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Pn()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){}}async _onVisibilityChanged(e){this._debug(`#_onVisibilityChanged(${e})`,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(e||(await this.initializePromise,await this._recoverAndRefresh(),this._debug("#_onVisibilityChanged()","finished waiting for initialize, _recoverAndRefresh")),this.autoRefreshToken&&this._startAutoRefresh()):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t){const r=[`provider=${encodeURIComponent(e)}`];if((null==t?void 0:t.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),(null==t?void 0:t.scopes)&&r.push(`scopes=${encodeURIComponent(t.scopes)}`),"pkce"===this.flowType){const e=Fn();await $n(this.storage,`${this.storageKey}-code-verifier`,e);const t=await zn(e),s=e===t?"plain":"s256";this._debug("PKCE","code verifier",`${e.substring(0,5)}...`,"code challenge",t,"method",s);const n=new URLSearchParams({code_challenge:`${encodeURIComponent(t)}`,code_challenge_method:`${encodeURIComponent(s)}`});r.push(n.toString())}if(null==t?void 0:t.queryParams){const e=new URLSearchParams(t.queryParams);r.push(e.toString())}return`${this.url}/authorize?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:n}=t;return n?{data:null,error:n}:await ui(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token})})}catch(t){if(Kn(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:n,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:a}=await ui(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token});return a?{data:null,error:a}:((null===(s=null==o?void 0:o.totp)||void 0===s?void 0:s.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(t){if(Kn(t))return{data:null,error:t};throw t}}async _verify(e){try{return await this._useSession(async t=>{var r;const{data:s,error:n}=t;if(n)return{data:null,error:n};const{data:i,error:o}=await ui(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(t){if(Kn(t))return{data:null,error:t};throw t}}async _challenge(e){try{return await this._useSession(async t=>{var r;const{data:s,error:n}=t;return n?{data:null,error:n}:await ui(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token})})}catch(t){if(Kn(t))return{data:null,error:t};throw t}}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(null==e?void 0:e.factors)||[],s=r.filter(e=>"totp"===e.factor_type&&"verified"===e.status);return{data:{all:r,totp:s},error:null}}async _getAuthenticatorAssuranceLevel(){return await this._useSession(async e=>{var t,r;const{data:{session:s},error:n}=e;if(n)return{data:null,error:n};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const i=this._decodeJWT(s.access_token);let o=null;i.aal&&(o=i.aal);let a=o;(null!==(r=null===(t=s.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(a="aal2");return{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:i.amr||[]},error:null}})}}xi.nextInstanceID=0;class ji extends xi{constructor(e){super(e)}}var Ti=globalThis&&globalThis.__awaiter||function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((s=s.apply(e,t||[])).next())})};const ki={headers:jn},Si={schema:"public"},Ei={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Oi={};class Ni{constructor(e,t,r){var s,n,i,o,a,l,c,u;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const d=e.replace(/\/$/,"");this.realtimeUrl=`${d}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${d}/auth/v1`,this.storageUrl=`${d}/storage/v1`,this.functionsUrl=`${d}/functions/v1`;const h=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,f=function(e,t){const{db:r,auth:s,realtime:n,global:i}=e,{db:o,auth:a,realtime:l,global:c}=t;return{db:Object.assign(Object.assign({},o),r),auth:Object.assign(Object.assign({},a),s),realtime:Object.assign(Object.assign({},l),n),global:Object.assign(Object.assign({},c),i)}}(null!=r?r:{},{db:Si,realtime:Oi,auth:Object.assign(Object.assign({},Ei),{storageKey:h}),global:ki});this.storageKey=null!==(n=null===(s=f.auth)||void 0===s?void 0:s.storageKey)&&void 0!==n?n:"",this.headers=null!==(o=null===(i=f.global)||void 0===i?void 0:i.headers)&&void 0!==o?o:{},this.auth=this._initSupabaseAuthClient(null!==(a=f.auth)&&void 0!==a?a:{},this.headers,null===(l=f.global)||void 0===l?void 0:l.fetch),this.fetch=Nn(t,this._getAccessToken.bind(this),null===(c=f.global)||void 0===c?void 0:c.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},f.realtime)),this.rest=new es(`${d}/rest/v1`,{headers:this.headers,schema:null===(u=f.db)||void 0===u?void 0:u.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new mr(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new xn(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}rpc(e,t={},r){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Ti(this,void 0,void 0,function*(){const{data:r}=yield this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:n,flowType:i,debug:o},a,l){const c={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ji({url:this.authUrl,headers:Object.assign(Object.assign({},c),a),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:i,debug:o,fetch:l})}_initRealtimeClient(e){return new Js(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===r?"SIGNED_OUT"===e&&(this.realtime.setAuth(this.supabaseKey),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.realtime.setAuth(null!=r?r:null),this.changedAccessToken=r)}}const Pi=(Ci="https://xdzoikocriuvgkoenjqk.supabase.co",Ai="sb_publishable_VXiUtpRKA79e51E2p2csvw_vmmek-LL",Ri={auth:{storage:window.localStorage,storageKey:"greenofig-auth",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},realtime:{params:{eventsPerSecond:10}},global:{headers:{"X-Client-Info":"greenofig-web"}}},new Ni(Ci,Ai,Ri));var Ci,Ai,Ri;const Ii=m.createContext(null),$i=({children:t})=>{const[r,s]=m.useState(null),[n,i]=m.useState(null),[o,a]=m.useState(!0),{toast:l}=or(),c=m.useCallback(async e=>{var t,r,s,n,o;if(!e)return i(null),null;try{let{data:a,error:l}=await Pi.from("user_profiles").select("*").eq("id",e.id).single();if(l&&"PGRST116"===l.code){const i=(null==(t=e.user_metadata)?void 0:t.full_name)||(null==(r=e.user_metadata)?void 0:r.name)||(null==(s=e.email)?void 0:s.split("@")[0])||"User",l=(null==(n=e.user_metadata)?void 0:n.avatar_url)||(null==(o=e.user_metadata)?void 0:o.picture),{data:c,error:u}=await Pi.from("user_profiles").insert({id:e.id,full_name:i,email:e.email,role:"user",profile_picture_url:l}).select().single();if(u)throw u;a=c}else if(l)throw l;return i(a),a}catch(a){return l({variant:"destructive",title:"Error",description:"Could not load profile. Please refresh the page."}),null}},[l]),u=m.useCallback(()=>r?c(r):Promise.resolve(null),[r,c]);m.useEffect(()=>{(async()=>{a(!0);const{data:{session:e}}=await Pi.auth.getSession();s((null==e?void 0:e.user)??null),(null==e?void 0:e.user)&&await c(e.user),a(!1)})();const{data:e}=Pi.auth.onAuthStateChange(async(e,t)=>{const r=(null==t?void 0:t.user)??null;if(s(r),"SIGNED_IN"===e&&window.location.search.includes("code=")){const e=new URL(window.location.href);return e.searchParams.delete("code"),void(window.location.href=e.toString())}r?await c(r):i(null),a(!1)});return()=>{var t;null==(t=null==e?void 0:e.subscription)||t.unsubscribe()}},[c]);const d=m.useCallback(async e=>{const{data:t,error:r}=await Pi.auth.signInWithPassword(e);if(r)return l({variant:"destructive",title:"Login Failed",description:r.message}),{error:r};const n=await c(t.user);return s(t.user),i(n),l({title:"Login Successful",description:`Welcome back${(null==n?void 0:n.full_name)?", "+n.full_name:""}!`}),{error:null,profile:n}},[c,l]),h=m.useCallback(async()=>{a(!0);const e=`${window.location.origin}/app`,{error:t}=await Pi.auth.signInWithOAuth({provider:"google",options:{redirectTo:e}});t&&(a(!1),l({variant:"destructive",title:"Google Sign-In Failed",description:t.message}))},[l]),f=m.useCallback(async e=>{const{email:t,password:r,full_name:n}=e,{data:o,error:a}=await Pi.auth.signUp({email:t,password:r,options:{data:{full_name:n,role:"user"}}});if(a)return l({variant:"destructive",title:"Sign Up Failed",description:a.message}),{user:null,error:a};const{data:u,error:d}=await Pi.auth.signInWithPassword({email:t,password:r});if(d)return l({variant:"destructive",title:"Sign-in after sign-up failed.",description:d.message}),{user:null,error:d};await new Promise(e=>setTimeout(e,1500));const h=await c(u.user);return s(u.user),i(h),{user:u.user,error:null,profile:h}},[c,l]),p=m.useCallback(async()=>{a(!0);try{await Pi.auth.signOut(),s(null),i(null),localStorage.clear(),sessionStorage.clear(),l({title:"Signed Out",description:"You have been successfully signed out."})}catch(e){}window.location.replace("/home")},[l]),g=m.useMemo(()=>({user:r,userProfile:n,loading:o,signIn:d,signInWithGoogle:h,signUp:f,signOut:p,refreshUserProfile:u}),[r,n,o,d,h,f,p,u]);return e.jsx(Ii.Provider,{value:g,children:t})},Li=()=>{const e=m.useContext(Ii);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},Di="/assets/Remove background project-af9f111b.png",Ui=Kt("inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-semibold ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-95",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 hover:shadow-lg hover:shadow-primary/20",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 hover:shadow-lg hover:shadow-destructive/20",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground hover:border-primary/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 hover:shadow-md",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline focus-visible:ring-offset-0"},size:{default:"h-9 px-3 text-sm",sm:"h-9 px-3 text-sm",lg:"h-11 px-4 text-base",icon:"h-9 w-9 p-0"}},defaultVariants:{variant:"default",size:"sm"}}),Bi=m.forwardRef(({className:t,variant:r,size:s,asChild:n=!1,...i},o)=>{const a=n?l:"button";return e.jsx(a,{className:Wt(Ui({variant:r,size:s,className:t})),ref:o,type:"button"!==a||i.type?i.type:"button",...i})});Bi.displayName="Button";const Mi=t=>e.jsxs("svg",{viewBox:"0 0 48 48",...t,children:[e.jsx("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),e.jsx("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),e.jsx("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.222,0-9.651-3.356-11.303-8H6.306C9.656,39.663,16.318,44,24,44z"}),e.jsx("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571l6.19,5.238C44.572,34.046,48,27.461,48,20C48,17.222,47.113,14.69,45.54,12.591L39.9,18.335C42.128,20.45,43.611,20.083,43.611,20.083z"})]}),Fi=({logoUrl:t,initialIsLogin:r=!0})=>{const{signIn:s,signUp:n,signInWithGoogle:i,user:o,userProfile:a}=Li(),l=b(),c=w(),[u,d]=m.useState(r),[h,f]=m.useState(""),[p,g]=m.useState(""),[y,v]=m.useState(""),[x,j]=m.useState(!1),[T,k]=m.useState(!1),[S,E]=m.useState(null);m.useEffect(()=>{var e;(null==(e=c.state)?void 0:e.selectedPlan)&&E(c.state.selectedPlan)},[c.state]),m.useEffect(()=>{d("/login"===c.pathname)},[c.pathname]);return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-background touch-auto",children:e.jsx(C.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"w-full max-w-md",children:e.jsxs("div",{className:"glass-effect rounded-2xl p-4 sm:p-8 shadow-2xl",children:[e.jsxs("button",{onClick:()=>l(-1),className:"flex items-center gap-2 text-text-secondary hover:text-primary transition-colors mb-4 group",children:[e.jsx(A,{className:"w-5 h-5 group-hover:-translate-x-1 transition-transform"}),e.jsx("span",{className:"text-sm font-medium",children:"Back"})]}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(_,{to:"/home",className:"inline-block mb-4",children:e.jsx(C.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:e.jsx("img",{src:t,alt:"GreenoFig Logo",className:"w-20 h-20"})})}),e.jsx("h1",{className:"text-4xl font-bold gradient-text mb-2",children:"GreenoFig"}),e.jsx("p",{className:"text-text-secondary",children:"Your Personal Wellness Companion"}),S&&!u&&e.jsxs("div",{className:"mt-4 bg-primary/10 text-primary font-semibold p-2 rounded-lg",children:["Signing up for the ",e.jsx("span",{className:"font-bold",children:S})," plan"]})]}),e.jsxs(Bi,{variant:"outline",className:"w-full py-3 min-h-[44px] rounded-lg shadow-lg flex items-center justify-center gap-2 touch-manipulation active:scale-95 transition-transform",onClick:async()=>{x||T||(k(!0),await i(),setTimeout(()=>k(!1),5e3))},disabled:T||x,type:"button",children:[T?e.jsx(R,{className:"h-5 w-5 animate-spin"}):e.jsx(Mi,{className:"w-5 h-5"}),e.jsxs("span",{children:["Sign ",u?"in":"up"," with Google"]})]}),e.jsxs("div",{className:"my-4 flex items-center",children:[e.jsx("div",{className:"flex-grow border-t border-border"}),e.jsx("span",{className:"flex-shrink mx-4 text-xs text-text-secondary uppercase",children:"Or continue with"}),e.jsx("div",{className:"flex-grow border-t border-border"})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!x&&!T)if(h&&p&&(u||y))if(j(!0),u){const{error:e,profile:t}=await s({email:h,password:p});if(!e&&t){const e=t.role;let r="/app/user";return"admin"===e||"super_admin"===e?r="/app/admin":"nutritionist"===e&&(r="/app/nutritionist"),void l(r,{replace:!0,state:{skipLoading:!0}})}j(!1)}else{const{user:e,error:t,profile:r}=await n({email:h,password:p,full_name:y});if(!t&&e&&r){ir({title:"Account created! ",description:"Welcome! Let's get you set up."});const e=r.role;let t="/app/user";return"admin"===e||"super_admin"===e?t="/app/admin":"nutritionist"===e&&(t="/app/nutritionist"),void l(t,{replace:!0,state:{skipLoading:!0}})}j(!1)}else ir({title:"Missing fields",description:"Please fill in all required fields",variant:"destructive"})},className:"space-y-4",children:[!u&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-primary"}),e.jsx("input",{type:"text",value:y,onChange:e=>v(e.target.value),className:"w-full pl-10 pr-4 py-3 min-h-[44px] bg-background border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring touch-manipulation",style:{fontSize:"16px"},placeholder:"John Doe",disabled:x||T,required:!0,autoComplete:"name"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-primary"}),e.jsx("input",{type:"email",value:h,onChange:e=>f(e.target.value),className:"w-full pl-10 pr-4 py-3 min-h-[44px] bg-background border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring touch-manipulation",style:{fontSize:"16px"},placeholder:"you@example.com",disabled:x||T,required:!0,autoComplete:"email",inputMode:"email"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-primary"}),e.jsx("input",{type:"password",value:p,onChange:e=>g(e.target.value),className:"w-full pl-10 pr-4 py-3 min-h-[44px] bg-background border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring touch-manipulation",style:{fontSize:"16px"},placeholder:"",disabled:x||T,required:!0,autoComplete:u?"current-password":"new-password"})]})]}),e.jsxs(Bi,{type:"submit",className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground font-semibold py-3 min-h-[44px] rounded-lg shadow-lg touch-manipulation active:scale-95 transition-transform",disabled:x||T,children:[x&&e.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"}),x?"Processing...":u?"Login":"Sign Up"]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>{x||T||l(u?"/signup":"/login")},type:"button",className:"text-text-secondary hover:text-primary transition-colors disabled:opacity-50 min-h-[44px] py-2 px-4 touch-manipulation",disabled:x||T,children:u?"Don't have an account? Sign up":"Already have an account? Login"})})]})})})},zi=m.forwardRef(({className:t,...r},s)=>e.jsx(c,{ref:s,className:Wt("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...r}));zi.displayName=c.displayName;const Hi=m.forwardRef(({className:t,...r},s)=>e.jsx(u,{ref:s,className:Wt("aspect-square h-full w-full",t),...r}));Hi.displayName=u.displayName;const qi=m.forwardRef(({className:t,...r},s)=>e.jsx(d,{ref:s,className:Wt("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...r}));qi.displayName=d.displayName;const Vi=Kt("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"text-foreground hover:bg-accent"}},defaultVariants:{variant:"default"}});function Wi({className:t,variant:r,...s}){return e.jsx("div",{className:Wt(Vi({variant:r}),t),...s})}const Ji=m.forwardRef(({className:t,...r},s)=>e.jsx("textarea",{className:Wt("flex min-h-[120px] w-full rounded-2xl border border-input bg-background/50 backdrop-blur-sm px-4 py-3 text-base text-foreground ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:border-primary disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-200 hover:border-primary/50 resize-y",t),style:{fontSize:"16px"},ref:s,"aria-invalid":r["aria-invalid"],...r}));Ji.displayName="Textarea";const Gi=m.forwardRef(({className:t,type:r,...s},n)=>e.jsx("input",{type:r,className:Wt("flex h-12 lg:h-14 w-full min-w-0 max-w-full rounded-2xl border border-input bg-background/50 backdrop-blur-sm px-4 lg:px-5 py-3 lg:py-3.5 text-base lg:text-lg text-foreground ring-offset-background file:border-0 file:bg-transparent file:text-base lg:file:text-lg file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:border-primary disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-200 hover:border-primary/50",t),style:{fontSize:"16px"},ref:n,"aria-invalid":s["aria-invalid"],...s}));Gi.displayName="Input";const Ki=Kt("text-sm font-semibold text-foreground mb-2 block tracking-wide leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Yi=m.forwardRef(({className:t,...r},s)=>e.jsx(h,{ref:s,className:Wt(Ki(),t),...r}));Yi.displayName=h.displayName;const Qi=()=>{var t,r,s,n;const{userProfile:i,user:o}=Li(),{toast:a}=or(),[l,c]=m.useState(!1),[u,d]=m.useState(!1),[h,f]=m.useState("ai"),[p,g]=m.useState([]),[y,v]=m.useState(""),[b,w]=m.useState(!1),[_,x]=m.useState(!1),[j,T]=m.useState([]),[k,S]=m.useState(null),[E,O]=m.useState([]),[N,R]=m.useState(0),[I,L]=m.useState(!0),[J,G]=m.useState(window.innerHeight),[K,Y]=m.useState(()=>localStorage.getItem("chatButtonPosition")||"right"),[Q,X]=m.useState(!1),[Z,ee]=m.useState(""),[te,re]=m.useState(""),[se,ne]=m.useState(""),[ie,oe]=m.useState(!1),[ae,le]=m.useState(!1),[ce,ue]=m.useState([]),[de,he]=m.useState(""),fe=m.useRef(null),pe=m.useRef(null),me=m.useRef(null),ge=!o;m.useEffect(()=>{const e=new(window.AudioContext||window.webkitAudioContext);return me.current=e,()=>{e&&"closed"!==e.state&&e.close()}},[]),m.useEffect(()=>{const e=()=>{window.visualViewport?G(window.visualViewport.height):G(window.innerHeight)};return window.visualViewport?(window.visualViewport.addEventListener("resize",e),window.visualViewport.addEventListener("scroll",e)):window.addEventListener("resize",e),()=>{window.visualViewport?(window.visualViewport.removeEventListener("resize",e),window.visualViewport.removeEventListener("scroll",e)):window.removeEventListener("resize",e)}},[]);m.useEffect(()=>{if((null==o?void 0:o.id)&&(null==i?void 0:i.role)){ye();const e=Pi.channel("messages-changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},e=>{if(e.new.recipient_id===o.id||e.new.sender_id===o.id){if(ye(),k){const t=null==i?void 0:i.role;let r=!1;r="nutritionist"===t||"admin"===t||"super_admin"===t?e.new.sender_id===k||e.new.recipient_id===k:e.new.conversation_id===k,r&&ve(k)}e.new.recipient_id===o.id&&e.new.sender_id!==o.id&&((()=>{if(I&&me.current)try{const e=me.current.createOscillator(),t=me.current.createGain();e.connect(t),t.connect(me.current.destination),e.frequency.value=800,e.type="sine",t.gain.setValueAtTime(.3,me.current.currentTime),t.gain.exponentialRampToValueAtTime(.01,me.current.currentTime+.3),e.start(me.current.currentTime),e.stop(me.current.currentTime+.3)}catch(e){}})(),a({title:" New Message",description:"You have received a new message",duration:3e3}))}}).subscribe();return()=>{Pi.removeChannel(e)}}},[null==o?void 0:o.id,null==i?void 0:i.role,k]);const ye=async()=>{if(null==o?void 0:o.id)try{const e=null==i?void 0:i.role;let t;t="nutritionist"===e||"admin"===e||"super_admin"===e?Pi.from("messages").select("\n            *,\n            sender:user_profiles!messages_sender_id_fkey(id, full_name, email, profile_picture_url),\n            recipient:user_profiles!messages_recipient_id_fkey(id, full_name, email, profile_picture_url)\n          ").or(`sender_id.eq.${o.id},recipient_id.eq.${o.id}`).order("created_at",{ascending:!1}):Pi.from("conversations").select("\n            *,\n            nutritionist:nutritionist_id (\n              id,\n              full_name,\n              email,\n              profile_picture_url\n            )\n          ").eq("user_id",o.id).order("last_message_at",{ascending:!1});const{data:r,error:s}=await t;if(s)throw s;if("nutritionist"===e||"admin"===e||"super_admin"===e){const e=new Map;null==r||r.forEach(t=>{if(!t||!t.sender_id||!t.recipient_id)return;const r=t.sender_id===o.id?t.recipient_id:t.sender_id,s=t.sender_id===o.id?t.recipient||{}:t.sender||{};if(s&&s.id)if(e.has(r)){const s=e.get(r);new Date(t.created_at)>new Date(s.lastMessage.created_at)&&(s.lastMessage=t),t.recipient_id!==o.id||t.is_read||s.unreadCount++}else e.set(r,{id:r,partner:s,lastMessage:t,unreadCount:t.recipient_id!==o.id||t.is_read?0:1})}),T(Array.from(e.values())),R(Array.from(e.values()).reduce((e,t)=>e+t.unreadCount,0))}else T(r||[]),R((null==r?void 0:r.reduce((e,t)=>e+(t.unread_count||0),0))||0)}catch(e){}},ve=async e=>{try{const t=null==i?void 0:i.role;let r;r="nutritionist"===t||"admin"===t||"super_admin"===t?Pi.from("messages").select("*").or(`and(sender_id.eq.${o.id},recipient_id.eq.${e}),and(sender_id.eq.${e},recipient_id.eq.${o.id})`).order("created_at",{ascending:!0}):Pi.from("messages").select("*").eq("conversation_id",e).order("created_at",{ascending:!0});const{data:s,error:n}=await r;if(n)throw n;O(s||[]),"nutritionist"===t||"admin"===t||"super_admin"===t?await Pi.from("messages").update({is_read:!0}).eq("recipient_id",o.id).eq("sender_id",e):await Pi.from("messages").update({is_read:!0}).eq("conversation_id",e).eq("recipient_id",o.id),ye()}catch(t){}},be=(()=>{if(ge)return["What features does GreenoFig offer?","Tell me about the pricing plans","I'd like to speak with someone from your team"];const e=null==i?void 0:i.role;return"admin"===e||"super_admin"===e?["Show me platform analytics overview","What are the best practices for user engagement?","Help me analyze subscription trends"]:"nutritionist"===e?["Suggest evidence-based nutrition strategies","Help me create a client meal plan template","What are current nutrition research trends?"]:["Give me a healthy breakfast idea","Suggest a quick 15-minute workout","How can I improve my sleep quality?"]})();m.useEffect(()=>{const e=setTimeout(()=>x(!0),3e3),t=setTimeout(()=>x(!1),8e3);return()=>{clearTimeout(e),clearTimeout(t)}},[]),m.useEffect(()=>{const e=e=>{pe.current&&!pe.current.contains(e.target)&&l&&c(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[l]);m.useEffect(()=>{var e;null==(e=fe.current)||e.scrollIntoView({behavior:"smooth"})},[p,E]),m.useEffect(()=>{var e,t,r;if(l&&0===p.length&&"ai"===h){let s="";if(ge)s="Hi there!  Welcome to GreenoFig! I'm your Website Assistant. I can help answer questions about our platform, features, pricing, and how we can support your health journey. If you'd like to speak with our team, just let me know!";else{const n=null==i?void 0:i.role;s="admin"===n||"super_admin"===n?`Hi ${(null==(e=null==i?void 0:i.full_name)?void 0:e.split(" ")[0])||"Admin"}!  I'm your AI Business Assistant. I can help with analytics, strategies, and platform insights.`:"nutritionist"===n?`Hi ${(null==(t=null==i?void 0:i.full_name)?void 0:t.split(" ")[0])||"there"}!  I'm your AI Nutrition Assistant. I can help with evidence-based strategies, client plans, and research.`:`Hi ${(null==(r=null==i?void 0:i.full_name)?void 0:r.split(" ")[0])||"there"}!  I'm your AI Health Coach. How can I help you today?`}const n={id:Date.now(),text:s,sender:"ai"};g([n])}},[l,ge,i,h]);const we=async(e,t)=>{if(e&&e.preventDefault(),"messages"===h)return void(async()=>{var e,t;if(!y.trim()||!k)return;const r=y.trim();v("");try{const s=null==i?void 0:i.role,n={message_text:r,sender_id:o.id,is_read:!1,created_at:(new Date).toISOString()};"nutritionist"===s||"admin"===s||"super_admin"===s?n.recipient_id=k:(n.conversation_id=k,n.recipient_id=null==(t=null==(e=j.find(e=>e.id===k))?void 0:e.nutritionist)?void 0:t.id);const{error:a}=await Pi.from("messages").insert([n]);if(a)throw a}catch(s){a({title:"Error",description:"Failed to send message",variant:"destructive"})}})();const r=t||y;if(!r.trim()||b)return;const s={...{text:r,sender:"user",user_id:null==o?void 0:o.id},id:Date.now(),created_at:(new Date).toISOString()},n=[...p,s];g(n),v(""),w(!0);try{if(ge&&(r.toLowerCase().includes("talk to someone")||r.toLowerCase().includes("speak with")||r.toLowerCase().includes("contact")||r.toLowerCase().includes("representative")||r.toLowerCase().includes("human")||r.toLowerCase().includes("real person")||r.toLowerCase().includes("team member"))){const e={text:"I'd be happy to connect you with our team! Please provide your name and email address, and someone from our team will reach out to you shortly.",sender:"ai",id:Date.now()+1};return g(t=>[...t,e]),X(!0),void w(!1)}const{data:e,error:t}=await Pi.functions.invoke("ai-coach-memory",{body:JSON.stringify({messages:n.slice(-10),userProfile:ge?{isVisitor:!0,role:"visitor",systemPrompt:"You are a helpful Website Assistant for GreenoFig, an AI-powered health and wellness platform. You can ONLY answer questions about: the website features, pricing plans, how the platform works, subscription details, privacy and security, payment methods, and general information about our services. If asked about personal health advice, meal plans, or fitness routines, politely explain that users need to sign up to access our AI Health Coach. Keep responses friendly, concise, and focused on helping visitors understand our platform."}:{...i,isAdmin:"admin"===(null==i?void 0:i.role)||"super_admin"===(null==i?void 0:i.role),isNutritionist:"nutritionist"===(null==i?void 0:i.role)}})});if(t)throw t;const s={text:e.reply,sender:"ai",user_id:null==o?void 0:o.id,id:Date.now()+1,created_at:(new Date).toISOString()};g(e=>[...e,s])}catch(l){const e={text:"I'm having trouble connecting right now. Please try again! ",sender:"ai",id:Date.now()+1};g(t=>[...t,e]),a({title:"Error",description:"Failed to get AI response. Please try again.",variant:"destructive"})}finally{w(!1)}},_e=e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),we())},xe=()=>{c(!l),d(!1)};return e.jsxs("div",{ref:pe,children:[e.jsx(D,{children:!l&&e.jsxs(C.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1,[K]:16},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:500,damping:30,mass:.8},className:"fixed bottom-6 z-[9999]",style:{[K]:"16px"},children:[e.jsx(D,{children:_&&e.jsxs(C.div,{initial:{opacity:0,x:"right"===K?20:-20,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:"right"===K?20:-20,scale:.8},className:"absolute bottom-20 bg-card rounded-lg shadow-xl p-3 w-56 border border-primary/20 "+("right"===K?"right-0":"left-0"),children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(U,{className:"h-5 w-5 text-primary shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-card-foreground",children:"Need help?"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Chat with AI Coach or message your nutritionist!"})]})]}),e.jsx("div",{className:"absolute -bottom-2 w-4 h-4 bg-card border-r border-b border-primary/20 transform rotate-45 "+("right"===K?"right-6":"left-6")})]})}),e.jsxs(C.div,{drag:"x",dragConstraints:{left:-(window.innerWidth-96),right:window.innerWidth-96},dragElastic:.1,dragMomentum:!1,onDragEnd:(e,t)=>{const r=window.innerWidth,s=e.target.getBoundingClientRect(),n=s.left+s.width/2<r/2?"left":"right";Y(n),localStorage.setItem("chatButtonPosition",n)},onClick:xe,whileHover:{scale:1.05},whileTap:{scale:.95},className:"h-16 w-16 rounded-full shadow-2xl cursor-grab active:cursor-grabbing relative bg-gradient-to-br from-primary to-green-400 touch-none select-none",children:[N>0&&e.jsx(C.div,{initial:{scale:0},animate:{scale:1},className:"absolute -top-1 -right-1 h-6 w-6 rounded-full bg-red-500 flex items-center justify-center text-white text-xs font-bold shadow-lg z-10",children:N>9?"9+":N}),e.jsx(C.div,{animate:{boxShadow:["0 0 10px hsl(var(--primary) / 0.3)","0 0 20px hsl(var(--primary) / 0.4)","0 0 10px hsl(var(--primary) / 0.3)"]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"absolute inset-0 rounded-full"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-2",children:e.jsx("img",{src:Di,alt:"GreenoFig AI Coach",className:"h-12 w-12 object-contain drop-shadow-lg",style:{filter:"brightness(0.75) contrast(1.15)"}})})]})]})}),e.jsx(D,{children:l&&e.jsxs(C.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1,[K]:16},exit:{opacity:0,y:50,scale:.9},transition:{type:"spring",stiffness:300,damping:30},className:"fixed w-[calc(100vw-32px)] max-w-[320px] md:max-w-[340px] bg-card rounded-2xl shadow-2xl z-[9999] border border-border overflow-hidden flex flex-col",style:{[K]:"16px",bottom:"16px",height:u?"60px":"auto",maxHeight:u?"60px":"550px"},children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary to-green-400 p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0 overflow-hidden",children:[e.jsx("div",{className:"rounded-full bg-white/20 flex items-center justify-center overflow-hidden flex-shrink-0 "+(u?"h-8 w-8":"h-10 w-10"),children:e.jsx("img",{src:Di,alt:"GreenoFig",className:"rounded-full object-cover "+(u?"h-6 w-6":"h-8 w-8")})}),e.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[e.jsx("h3",{className:"font-semibold text-white text-sm truncate whitespace-nowrap",children:ge?"Website Assistant":"ai"===h?"AI Health Coach":"Messages"}),!u&&e.jsx("p",{className:"text-xs text-white/80 truncate whitespace-nowrap",children:ge?"Ask me about GreenoFig!":"ai"===h?b?"Thinking...":"Online":`${j.length} conversations`})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bi,{variant:"ghost",size:"sm",onClick:()=>L(!I),className:"h-8 w-8 p-0 text-white hover:bg-white/20",title:I?"Mute notifications":"Unmute notifications",children:I?e.jsx(B,{className:"h-4 w-4"}):e.jsx(M,{className:"h-4 w-4"})}),e.jsx(Bi,{variant:"ghost",size:"sm",onClick:()=>{d(!u)},className:"h-8 w-8 p-0 text-white hover:bg-white/20",children:u?e.jsx(F,{className:"h-4 w-4"}):e.jsx(z,{className:"h-4 w-4"})}),e.jsx(Bi,{variant:"ghost",size:"sm",onClick:xe,className:"h-8 w-8 p-0 text-white hover:bg-white/20",children:e.jsx(P,{className:"h-4 w-4"})})]})]}),!u&&!ge&&e.jsxs("div",{className:"flex border-b border-border bg-muted/30",children:[e.jsxs("button",{onClick:()=>f("ai"),className:"flex-1 py-3 px-4 flex items-center justify-center gap-2 font-medium text-sm transition-all "+("ai"===h?"bg-background text-primary border-b-2 border-primary":"text-muted-foreground hover:text-foreground hover:bg-muted/50"),children:[e.jsx(H,{className:"h-4 w-4"}),"AI Coach"]}),e.jsxs("button",{onClick:()=>f("messages"),className:"flex-1 py-3 px-4 flex items-center justify-center gap-2 font-medium text-sm transition-all relative "+("messages"===h?"bg-background text-primary border-b-2 border-primary":"text-muted-foreground hover:text-foreground hover:bg-muted/50"),children:[e.jsx(q,{className:"h-4 w-4"}),"Messages",N>0&&e.jsx(Wi,{variant:"destructive",className:"h-5 min-w-[20px] px-1.5 text-[10px]",children:N>9?"9+":N})]})]}),!u&&"ai"===h&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-muted/30",style:{maxHeight:"320px"},children:[e.jsx(D,{children:p.map((t,r)=>e.jsx(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex "+("user"===t.sender?"justify-end":"justify-start"),children:e.jsx("div",{className:"max-w-[85%] rounded-xl px-3 py-2.5 shadow-sm "+("user"===t.sender?"bg-gradient-to-br from-primary to-green-400 text-primary-foreground":"bg-card border border-border text-card-foreground"),children:e.jsx("p",{className:"text-[13px] leading-relaxed whitespace-pre-wrap break-words",children:t.text})})},t.id||r))}),b&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-start",children:e.jsx("div",{className:"bg-muted rounded-xl px-4 py-3 shadow-sm",children:e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})}),e.jsx("div",{ref:fe})]}),p.length<=1&&!b&&!Q&&e.jsx("div",{className:"px-3 pb-2 pt-1",children:e.jsx("div",{className:"space-y-2",children:be.map((t,r)=>e.jsx(C.button,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{delay:.1*r},onClick:e=>we(e,t),className:"w-full p-2 bg-muted hover:bg-accent rounded-lg text-left text-xs transition-colors",children:t},r))})}),e.jsx("div",{className:"p-4 bg-card border-t border-border",children:Q?e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),te.trim()&&Z.trim()){oe(!0);try{const{error:e}=await Pi.from("visitor_inquiries").insert([{name:Z,email:te,question:se||y,conversation_history:JSON.stringify(p),status:"pending",created_at:(new Date).toISOString()}]);if(e)throw e;a({title:"Thank you!",description:"Our team will get back to you shortly via email."});const t={id:Date.now(),text:`Thank you, ${Z}! I've forwarded your information to our team. Someone will reach out to you at ${te} shortly. Is there anything else I can help you with about our website?`,sender:"ai"};g(e=>[...e,t]),X(!1),ee(""),re(""),ne("")}catch(t){a({title:"Error",description:"Failed to submit your information. Please try again or email us directly at support@greenofig.com",variant:"destructive"})}finally{oe(!1)}}else a({title:"Missing Information",description:"Please provide your name and email",variant:"destructive"})},className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(Yi,{htmlFor:"visitor-name",className:"text-xs font-medium",children:"Name *"}),e.jsx(Gi,{id:"visitor-name",type:"text",value:Z,onChange:e=>ee(e.target.value),placeholder:"Your name",className:"mt-1 text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx(Yi,{htmlFor:"visitor-email",className:"text-xs font-medium",children:"Email *"}),e.jsx(Gi,{id:"visitor-email",type:"email",value:te,onChange:e=>re(e.target.value),placeholder:"your@email.com",className:"mt-1 text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx(Yi,{htmlFor:"visitor-question",className:"text-xs font-medium",children:"Question (Optional)"}),e.jsx(Ji,{id:"visitor-question",value:se,onChange:e=>ne(e.target.value),placeholder:"Tell us how we can help...",className:"mt-1 text-sm resize-none",rows:2})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Bi,{type:"button",variant:"outline",onClick:()=>X(!1),className:"flex-1",disabled:ie,children:"Cancel"}),e.jsx(Bi,{type:"submit",disabled:ie,className:"flex-1 bg-gradient-to-br from-primary to-green-400",children:ie?"Sending...":"Submit"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:we,className:"flex gap-3 items-end",children:[e.jsx(Ji,{value:y,onChange:e=>v(e.target.value),onKeyPress:_e,placeholder:ge?"Ask about our platform...":"Ask me anything...",className:"flex-1 min-h-[48px] max-h-[120px] resize-none text-sm bg-background border-input focus:border-ring focus:ring-2 focus:ring-primary/20 rounded-lg p-3",rows:2}),e.jsx(Bi,{type:"submit",disabled:!y.trim()||b,size:"icon",className:"h-12 w-12 bg-gradient-to-br from-primary to-green-400 hover:from-primary/90 hover:to-green-400/90 shrink-0 shadow-md transition-all",children:e.jsx(V,{className:"h-5 w-5"})})]}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-2 text-center",children:"Press Enter to send  Shift+Enter for new line"})]})})]}),!u&&"messages"===h&&e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[!k&&!ae&&("admin"===(null==i?void 0:i.role)||"super_admin"===(null==i?void 0:i.role)||"nutritionist"===(null==i?void 0:i.role))&&e.jsx("div",{className:"p-3 border-b border-border",children:e.jsxs(Bi,{onClick:()=>{le(!0),(async()=>{try{const{data:e,error:t}=await Pi.from("user_profiles").select("id, full_name, email, profile_picture_url, role").neq("id",o.id).order("full_name");if(t)throw t;ue(e||[])}catch(e){}})()},className:"w-full bg-gradient-to-br from-primary to-green-400",size:"sm",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"New Message"]})}),ae&&e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-3 border-b border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Bi,{variant:"ghost",size:"sm",onClick:()=>{le(!1),he("")},className:"h-8 w-8 p-0",title:"Back to conversations",children:e.jsx(A,{className:"h-4 w-4"})}),e.jsx("h3",{className:"text-sm font-semibold",children:"Select User to Message"})]}),e.jsx(Gi,{placeholder:"Search users...",value:de,onChange:e=>he(e.target.value),className:"text-sm"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto divide-y divide-border",children:ce.filter(e=>{var t,r;return(null==(t=e.full_name)?void 0:t.toLowerCase().includes(de.toLowerCase()))||(null==(r=e.email)?void 0:r.toLowerCase().includes(de.toLowerCase()))}).map(t=>{var r;return e.jsxs(C.button,{onClick:()=>{return e=t.id,S(e),le(!1),he(""),void ve(e);var e},className:"w-full p-3 hover:bg-muted/50 transition-colors text-left flex items-center gap-3",whileHover:{backgroundColor:"rgba(0,0,0,0.02)"},children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:t.profile_picture_url?e.jsx("img",{src:t.profile_picture_url,alt:t.full_name,className:"h-full w-full rounded-full object-cover"}):e.jsx("span",{className:"text-sm font-semibold text-primary",children:(null==(r=t.full_name)?void 0:r.charAt(0))||"?"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground truncate",children:t.full_name||"Unknown"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:t.email})]}),e.jsx(Wi,{variant:"outline",className:"text-[10px]",children:t.role})]},t.id)})})]}),!k&&!ae&&e.jsx("div",{className:"flex-1 overflow-y-auto",children:0===j.length?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center",children:[e.jsx(q,{className:"h-12 w-12 text-muted-foreground mb-3"}),e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"No conversations yet"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Start chatting with your ","user"===(null==i?void 0:i.role)?"nutritionist":"clients","!"]})]}):e.jsx("div",{className:"divide-y divide-border",children:j.map(t=>{var r;const s=t.partner||t.nutritionist,n=t.lastMessage||{message_text:t.last_message,created_at:t.last_message_at},i=t.unreadCount||t.unread_count||0;return e.jsxs(C.button,{onClick:()=>{return e=t.id,S(e),void ve(e);var e},className:"w-full p-3 hover:bg-muted/50 transition-colors text-left flex items-start gap-3",whileHover:{backgroundColor:"rgba(0,0,0,0.02)"},children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:(null==s?void 0:s.profile_picture_url)?e.jsx("img",{src:s.profile_picture_url,alt:s.full_name,className:"h-full w-full rounded-full object-cover"}):e.jsx("span",{className:"text-sm font-semibold text-primary",children:(null==(r=null==s?void 0:s.full_name)?void 0:r.charAt(0))||"?"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground truncate",children:(null==s?void 0:s.full_name)||"Unknown"}),(null==n?void 0:n.created_at)&&e.jsx("span",{className:"text-[10px] text-muted-foreground whitespace-nowrap ml-2",children:W(new Date(n.created_at),"MMM d")})]}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:(null==n?void 0:n.message_text)||"No messages yet"})]}),i>0&&e.jsx(Wi,{variant:"destructive",className:"h-5 min-w-[20px] px-1.5 text-[10px] flex-shrink-0",children:i})]},t.id)})})}),k&&e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b border-border flex items-center gap-3 bg-muted/30",children:[e.jsx(Bi,{variant:"ghost",size:"sm",onClick:()=>{S(null),O([])},className:"h-8 w-8 p-0",title:"Back to conversations",children:e.jsx(A,{className:"h-4 w-4"})}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm font-semibold",children:(null==(r=null==(t=j.find(e=>e.id===k))?void 0:t.partner)?void 0:r.full_name)||(null==(n=null==(s=j.find(e=>e.id===k))?void 0:s.nutritionist)?void 0:n.full_name)||"Conversation"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-2 bg-muted/30",style:{maxHeight:"320px"},children:[E.map(t=>e.jsx(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex "+(t.sender_id===o.id?"justify-end":"justify-start"),children:e.jsxs("div",{className:"max-w-[85%] rounded-xl px-3 py-2 shadow-sm "+(t.sender_id===o.id?"bg-gradient-to-br from-primary to-green-400 text-primary-foreground":"bg-card border border-border text-card-foreground"),children:[e.jsx("p",{className:"text-[13px] leading-relaxed whitespace-pre-wrap break-words",children:t.message_text}),e.jsx("span",{className:"text-[10px] opacity-70 mt-1 block",children:W(new Date(t.created_at),"h:mm a")})]})},t.id)),e.jsx("div",{ref:fe})]}),e.jsx("div",{className:"p-4 bg-card border-t border-border",children:e.jsxs("form",{onSubmit:we,className:"flex gap-3 items-end",children:[e.jsx(Ji,{value:y,onChange:e=>v(e.target.value),onKeyPress:_e,placeholder:"Type a message...",className:"flex-1 min-h-[48px] max-h-[120px] resize-none text-sm bg-background border-input focus:border-ring focus:ring-2 focus:ring-primary/20 rounded-lg p-3",rows:2}),e.jsx(Bi,{type:"submit",disabled:!y.trim(),size:"icon",className:"h-12 w-12 bg-gradient-to-br from-primary to-green-400 hover:from-primary/90 hover:to-green-400/90 shrink-0 shadow-md transition-all",children:e.jsx(V,{className:"h-5 w-5"})})]})})]})]})]})})]})},Xi=({targetId:t="main-content"})=>{const[r,s]=m.useState(!1);m.useEffect(()=>{document.getElementById(t)||window;const e=t?document.getElementById(t):null,r=()=>{e?e.scrollTop>300?s(!0):s(!1):window.pageYOffset>300?s(!0):s(!1)};return e?e.addEventListener("scroll",r):window.addEventListener("scroll",r),()=>{e?e.removeEventListener("scroll",r):window.removeEventListener("scroll",r)}},[t]);return e.jsx(D,{children:r&&e.jsx(C.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:20},className:"fixed bottom-6 left-1/2 -translate-x-1/2 md:left-6 md:translate-x-0 z-40",children:e.jsx(Bi,{onClick:()=>{const e=t?document.getElementById(t):null;e?e.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},size:"icon",className:"h-12 w-12 rounded-full shadow-lg bg-primary/60 hover:bg-primary/80 backdrop-blur-sm text-primary-foreground border border-primary/20","aria-label":"Scroll to top",children:e.jsx(J,{className:"h-5 w-5"})})})})},Zi=({user:t})=>{const[r,s]=m.useState([]),[n,i]=m.useState(0),[o,a]=m.useState(!1),[l,c]=m.useState(!1),u=m.useRef(null),d=b(),{toast:h}=or();m.useEffect(()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&a(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const f=async()=>{if(null==t?void 0:t.id){c(!0);try{const{data:e,error:r}=await Pi.from("notifications").select("*").eq("user_id",t.id).order("created_at",{ascending:!1}).limit(20);if(r)throw r;s(e||[]),i((null==e?void 0:e.filter(e=>!e.is_read).length)||0)}catch(e){}finally{c(!1)}}};m.useEffect(()=>{if(!(null==t?void 0:t.id))return;f();const e=Pi.channel("notifications").on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`user_id=eq.${t.id}`},e=>{f()}).subscribe();return()=>{Pi.removeChannel(e)}},[null==t?void 0:t.id]);const p=(t,r)=>{const s="urgent"===r?"text-red-400":"high"===r?"text-orange-400":"text-blue-400";switch(t){case"blog_generated":case"new_user":case"user_login":case"nutritionist_login":return e.jsx(Y,{className:`w-5 h-5 ${s}`});case"queue_low":case"queue_empty":return e.jsx(Q,{className:"w-5 h-5 text-yellow-400"});case"system_alert":return e.jsx(K,{className:"w-5 h-5 text-red-400"});default:return e.jsx(B,{className:`w-5 h-5 ${s}`})}},g=e=>{const t=Math.floor((new Date-new Date(e))/1e3);if(t<60)return"Just now";const r=Math.floor(t/60);if(r<60)return`${r}m ago`;const s=Math.floor(r/60);if(s<24)return`${s}h ago`;return`${Math.floor(s/24)}d ago`};return e.jsxs("div",{className:"relative",ref:u,children:[e.jsxs("button",{onClick:()=>a(!o),className:"relative p-2 rounded-full hover:bg-accent transition-colors","aria-label":"Notifications",children:[e.jsx(B,{className:"w-6 h-6 text-foreground"}),n>0&&e.jsx("span",{className:"absolute top-0 right-0 flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-red-500 rounded-full",children:n>9?"9+":n})]}),o&&e.jsxs("div",{className:"absolute right-0 mt-2 w-96 bg-background border border-border rounded-2xl shadow-2xl z-50 max-h-[600px] overflow-hidden flex flex-col glass-effect",children:[e.jsxs("div",{className:"p-4 border-b border-border flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold",children:"Notifications"}),e.jsx("div",{className:"flex items-center gap-2",children:n>0&&e.jsxs("button",{onClick:async()=>{try{const{error:e}=await Pi.from("notifications").update({is_read:!0,read_at:(new Date).toISOString()}).eq("user_id",t.id).eq("is_read",!1);if(e)throw e;s(e=>e.map(e=>({...e,is_read:!0}))),i(0),h({title:"All notifications marked as read"})}catch(e){h({title:"Error",description:"Failed to mark notifications as read",variant:"destructive"})}},className:"text-sm text-primary hover:underline flex items-center gap-1",children:[e.jsx(G,{className:"w-4 h-4"}),"Mark all read"]})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:l?e.jsx("div",{className:"p-8 text-center text-text-secondary",children:"Loading notifications..."}):0===r.length?e.jsxs("div",{className:"p-8 text-center text-text-secondary",children:[e.jsx(B,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No notifications yet"})]}):e.jsx("div",{className:"divide-y divide-border",children:r.map(t=>e.jsx("div",{className:"p-4 hover:bg-accent/50 transition-colors cursor-pointer "+(t.is_read?"":"bg-accent/20"),onClick:()=>(async(e,t)=>{try{const{error:r}=await Pi.from("notifications").update({is_read:!0,read_at:(new Date).toISOString()}).eq("id",e);if(r)throw r;s(t=>t.map(t=>t.id===e?{...t,is_read:!0}:t)),i(e=>Math.max(0,e-1)),t&&(d(t),a(!1))}catch(r){}})(t.id,t.action_url),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:p(t.type,t.priority)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-foreground",children:t.title}),e.jsx("button",{onClick:e=>{e.stopPropagation(),(async e=>{try{const{error:t}=await Pi.from("notifications").delete().eq("id",e);if(t)throw t;s(t=>t.filter(t=>t.id!==e))}catch(t){}})(t.id)},className:"text-text-secondary hover:text-red-400 flex-shrink-0",children:e.jsx(P,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-sm text-text-secondary mt-1 line-clamp-2",children:t.message}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-xs text-text-secondary",children:g(t.created_at)}),!t.is_read&&e.jsx("span",{className:"w-2 h-2 bg-primary rounded-full"})]})]})]})},t.id))})}),r.length>0&&e.jsx("div",{className:"p-3 border-t border-border",children:e.jsx(Bi,{variant:"ghost",size:"sm",className:"w-full",onClick:()=>{d("/app/notifications"),a(!1)},children:"View all notifications"})})]})]})},eo=({logoUrl:t})=>{const{userProfile:r,signOut:s}=Li();b();const n=w(),[i,o]=m.useState(!1),[a,l]=m.useState(0);m.useEffect(()=>{if(null==r?void 0:r.id){c();try{const e=Pi.channel("conversations-changes").on("postgres_changes",{event:"*",schema:"public",table:"conversations",filter:"user"===r.role?`user_id=eq.${r.id}`:`nutritionist_id=eq.${r.id}`},()=>{c()}).subscribe(e=>{});return()=>{try{Pi.removeChannel(e)}catch(t){}}}catch(e){const t=setInterval(c,3e4);return()=>clearInterval(t)}}},[null==r?void 0:r.id]);const c=async()=>{if(null==r?void 0:r.id)try{if("user"===r.role){const{data:e,error:t}=await Pi.rpc("get_unread_message_count",{p_user_id:r.id});t||l(e||0)}else if(["nutritionist","admin","super_admin"].includes(r.role)){const{data:e,error:t}=await Pi.rpc("get_nutritionist_unread_count",{p_nutritionist_id:r.id});t||l(e||0)}}catch(e){}},u=async()=>{await s()},d=[{icon:te,label:"Dashboard",path:"/app/user"},{icon:re,label:"AI Coach",path:"/app/ai-coach"},{icon:se,label:"Nutrition",path:"/app/nutrition"},{icon:ne,label:"Fitness",path:"/app/fitness"},{icon:ie,label:"Progress",path:"/app/progress"},{icon:$,label:"Messages",path:"/app/messages"},{icon:q,label:"Support",path:"/app/support"}],h=[{icon:te,label:"Dashboard",path:"/app/nutritionist?tab=dashboard"},{icon:oe,label:"Clients",path:"/app/nutritionist?tab=clients"},{icon:se,label:"Meal Plans",path:"/app/nutritionist?tab=meals"},{icon:ae,label:"Schedule",path:"/app/nutritionist?tab=schedule"},{icon:q,label:"Messages",path:"/app/nutritionist?tab=messages"},{icon:ie,label:"Analytics",path:"/app/nutritionist?tab=analytics"},{icon:le,label:"Resources",path:"/app/nutritionist?tab=resources"},{icon:le,label:"Blog",path:"/app/nutritionist?tab=blog"},{icon:ce,label:"Settings",path:"/app/nutritionist?tab=settings"}],f=[{icon:te,label:"Dashboard",path:"/app/admin"},{icon:ie,label:"Analytics",path:"/app/admin?tab=analytics"},{icon:ue,label:"Revenue",path:"/app/admin?tab=revenue"},{icon:de,label:"AI Errors",path:"/app/admin?tab=errors"},{icon:oe,label:"User Management",path:"/app/admin?tab=customers"},{icon:he,label:"Subscriptions",path:"/app/admin?tab=subscriptions"},{icon:fe,label:"Payments",path:"/app/admin?tab=payments"},{icon:pe,label:"Coupons",path:"/app/admin?tab=coupons"},{icon:me,label:"Referrals",path:"/app/admin?tab=referrals"},{icon:ge,label:"Support",path:"/app/admin?tab=issues"},{icon:q,label:"Messaging",path:"/app/admin?tab=messaging"},{icon:le,label:"Blog",path:"/app/admin?tab=blog"},{icon:ye,label:"Website",path:"/app/admin?tab=website"},{icon:re,label:"AI Coach",path:"/app/admin?tab=ai-coach"},{icon:ve,label:"Database",path:"/app/admin?tab=studio"}],p=(()=>{switch(null==r?void 0:r.role){case"admin":case"super_admin":return f;case"nutritionist":return h;default:return d}})(),g=({link:t,isActive:r})=>{const[s,n]=m.useState(!1),l="/app/messages"===t.path&&a>0;return e.jsxs(j,{to:t.path,end:!0,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),className:`flex items-center gap-2 px-2 py-2 sm:py-1.5 rounded-md transition-all duration-200 text-sm sm:text-xs font-medium border min-h-[44px] sm:min-h-0 ${r||s?"bg-gradient-to-r from-primary to-green-400 text-primary-foreground border-primary/30":"bg-transparent text-muted-foreground border-transparent hover:border-primary/30"} ${s?"translate-x-1":"translate-x-0"}`,onClick:()=>i&&o(!1),children:[e.jsx(t.icon,{className:"w-4 h-4 sm:w-3.5 sm:h-3.5 flex-shrink-0"}),e.jsx("span",{className:"flex-1 truncate",children:t.label}),l&&e.jsx(Wi,{className:"bg-red-500 text-white text-xs px-1.5 py-0.5 min-w-[20px] h-5 sm:h-4 flex items-center justify-center",children:a>99?"99+":a})]})},y=()=>{return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"p-3 sm:p-2.5 border-b border-border flex items-center gap-2",children:e.jsxs(_,{to:"/home",className:"flex items-center gap-1.5",children:[e.jsx("img",{src:t,alt:"GreenoFig Logo",className:"w-7 h-7 sm:w-6 sm:h-6"}),e.jsx("span",{className:"text-base sm:text-sm font-bold gradient-text",children:"GreenoFig"})]})}),e.jsx("nav",{className:"flex-1 p-2 space-y-0.5 overflow-y-auto",children:p.map(t=>{let r=!1;return r=t.path.includes("?")?n.pathname+n.search===t.path:"/app/admin"===t.path?n.pathname===t.path&&!n.search:n.pathname===t.path,e.jsx(g,{link:t,isActive:r},t.path)})}),e.jsxs("div",{className:"p-3 border-t border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsxs(zi,{className:"w-9 h-9 sm:w-8 sm:h-8",children:[e.jsx(Hi,{src:null==r?void 0:r.profile_picture_url}),e.jsx(qi,{className:"text-xs sm:text-[10px]",children:(s=null==r?void 0:r.full_name,s?s.split(" ").map(e=>e[0]).join("").toUpperCase():"?")})]}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[e.jsx("p",{className:"text-sm sm:text-xs font-semibold truncate",children:null==r?void 0:r.full_name}),e.jsx("p",{className:"text-xs sm:text-[10px] text-text-secondary truncate",children:null==r?void 0:r.email})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs(j,{to:"/app/profile",className:({isActive:e})=>"flex items-center gap-3 px-3 py-2.5 sm:py-2 rounded-lg transition-colors text-sm font-medium min-h-[44px] sm:min-h-0 "+(e?"bg-muted text-foreground":"text-text-secondary hover:bg-muted hover:text-foreground"),onClick:()=>i&&o(!1),children:[e.jsx(I,{className:"w-4 h-4"}),"Profile"]}),e.jsxs("button",{onClick:u,className:"w-full flex items-center gap-3 px-3 py-2.5 sm:py-2 rounded-lg transition-colors text-sm font-medium text-text-secondary hover:bg-muted hover:text-foreground min-h-[44px] sm:min-h-0",children:[e.jsx(ee,{className:"w-4 h-4"}),"Sign Out"]})]})]})]});var s};return e.jsxs("div",{className:"flex h-screen bg-background text-foreground overflow-hidden",children:[e.jsx("aside",{className:"hidden lg:block w-64 bg-card border-r border-border flex-shrink-0",children:e.jsx(y,{})}),e.jsx(D,{children:i&&e.jsxs(e.Fragment,{children:[e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>o(!1)}),e.jsx(C.aside,{variants:{open:{x:0,transition:{type:"spring",stiffness:300,damping:30}},closed:{x:"-100%",transition:{type:"spring",stiffness:300,damping:30}}},initial:"closed",animate:"open",exit:"closed",className:"fixed top-0 left-0 h-full w-72 sm:w-64 bg-card z-50 lg:hidden shadow-2xl",children:e.jsx(y,{})})]})}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-w-0",children:[e.jsxs("header",{className:"sticky top-0 z-30 flex items-center justify-between lg:justify-end h-14 sm:h-16 px-4 border-b border-border bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60 flex-shrink-0",children:[e.jsx(Bi,{variant:"ghost",size:"icon",className:"lg:hidden min-h-[44px] min-w-[44px]",onClick:()=>o(!0),children:e.jsx(X,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx(Zi,{user:r}),"admin"===(null==r?void 0:r.role)||"super_admin"===(null==r?void 0:r.role)?e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 text-xs sm:text-sm font-semibold text-primary",children:[e.jsx(Z,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"hidden sm:inline",children:"Admin Mode"}),e.jsx("span",{className:"sm:hidden",children:"Admin"})]}):null]})]}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 sm:p-6 lg:p-8",id:"main-content",children:e.jsx(x,{})})]}),e.jsx(Qi,{}),e.jsx(Xi,{targetId:"main-content"})]})},to=()=>{const{pathname:e}=w();return m.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),null},ro=m.lazy(()=>je(()=>import("./HomePage-ec9121c1.js"),["assets/HomePage-ec9121c1.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),so=m.lazy(()=>je(()=>import("./FeaturesPage-b0908743.js"),["assets/FeaturesPage-b0908743.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js","assets/SiteLayout-f03d29d2.js","assets/OnboardingSurvey-c2168d73.js","assets/dialog-aab7369c.js"])),no=m.lazy(()=>je(()=>import("./PricingPage-2de349bf.js"),["assets/PricingPage-2de349bf.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/SiteLayout-f03d29d2.js","assets/OnboardingSurvey-c2168d73.js","assets/dialog-aab7369c.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js","assets/index-6dac4401.js"])),io=m.lazy(()=>je(()=>import("./BlogPage-18bcf6c2.js"),["assets/BlogPage-18bcf6c2.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/card-b68930bc.js","assets/tabs-eac78ff9.js","assets/SiteLayout-f03d29d2.js","assets/OnboardingSurvey-c2168d73.js","assets/dialog-aab7369c.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js","assets/purify.es-3247f85f.js"])),oo=m.lazy(()=>je(()=>import("./ReviewsPage-3b406e24.js"),["assets/ReviewsPage-3b406e24.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/SiteLayout-f03d29d2.js","assets/OnboardingSurvey-c2168d73.js","assets/dialog-aab7369c.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js","assets/card-b68930bc.js"])),ao=m.lazy(()=>je(()=>import("./ContactPage-b38790aa.js"),["assets/ContactPage-b38790aa.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/SiteLayout-f03d29d2.js","assets/OnboardingSurvey-c2168d73.js","assets/dialog-aab7369c.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),lo=m.lazy(()=>je(()=>import("./FaqPage-8bf4d788.js"),["assets/FaqPage-8bf4d788.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/SiteLayout-f03d29d2.js","assets/OnboardingSurvey-c2168d73.js","assets/dialog-aab7369c.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),co=m.lazy(()=>je(()=>import("./AboutPage-e1e033a3.js"),["assets/AboutPage-e1e033a3.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/SiteLayout-f03d29d2.js","assets/OnboardingSurvey-c2168d73.js","assets/dialog-aab7369c.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),uo=m.lazy(()=>je(()=>import("./UserDashboard-936170f3.js"),["assets/UserDashboard-936170f3.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/card-b68930bc.js","assets/dialog-aab7369c.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js","assets/QuickLogMeal-e2499b18.js","assets/select-1d5620de.js","assets/tabs-eac78ff9.js"])),ho=m.lazy(()=>je(()=>import("./NutritionistDashboardV2-cc081fce.js"),["assets/NutritionistDashboardV2-cc081fce.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/EnhancedBlogManager-fb243088.js","assets/card-b68930bc.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js","assets/tabs-eac78ff9.js","assets/checkbox-04380905.js","assets/dialog-aab7369c.js","assets/switch-9295dfa7.js"])),fo=m.lazy(()=>je(()=>import("./AdminDashboard-e1e66b05.js"),["assets/AdminDashboard-e1e66b05.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/EnhancedBlogManager-fb243088.js","assets/card-b68930bc.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js","assets/tabs-eac78ff9.js","assets/checkbox-04380905.js","assets/dialog-aab7369c.js","assets/select-1d5620de.js","assets/dropdown-menu-0c2cc548.js","assets/switch-9295dfa7.js","assets/RevenueAnalyticsPage-90226967.js"])),po=m.lazy(()=>je(()=>import("./OnboardingSurvey-c2168d73.js").then(e=>e.a),["assets/OnboardingSurvey-c2168d73.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/dialog-aab7369c.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),mo=m.lazy(()=>je(()=>import("./ProfilePage-73c18a13.js"),["assets/ProfilePage-73c18a13.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/card-b68930bc.js","assets/checkbox-04380905.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),go=m.lazy(()=>je(()=>import("./EnhancedBlogPostEditor-6253d38c.js"),["assets/EnhancedBlogPostEditor-6253d38c.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/card-b68930bc.js","assets/switch-9295dfa7.js","assets/tabs-eac78ff9.js","assets/purify.es-3247f85f.js","assets/select-1d5620de.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js","assets/dropdown-menu-0c2cc548.js","assets/dialog-aab7369c.js","assets/defineProperty-ef0651d8.js","assets/typeof-b9ca4a95.js"])),yo=m.lazy(()=>je(()=>import("./BlogTagsManager-64f80b4a.js"),["assets/BlogTagsManager-64f80b4a.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/card-b68930bc.js","assets/tabs-eac78ff9.js","assets/dialog-aab7369c.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),vo=m.lazy(()=>je(()=>import("./AiCoachPage-f3540a18.js"),["assets/AiCoachPage-f3540a18.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),bo=m.lazy(()=>je(()=>import("./SurveyPage-67387f47.js"),["assets/SurveyPage-67387f47.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),wo=m.lazy(()=>je(()=>import("./RevenueAnalyticsPage-90226967.js"),["assets/RevenueAnalyticsPage-90226967.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/card-b68930bc.js","assets/tabs-eac78ff9.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),_o=m.lazy(()=>je(()=>import("./BillingPage-9f00df89.js"),["assets/BillingPage-9f00df89.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/card-b68930bc.js","assets/tabs-eac78ff9.js","assets/typeof-b9ca4a95.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js","assets/index-6dac4401.js","assets/dialog-aab7369c.js"])),xo=m.lazy(()=>je(()=>import("./SupportPage-90dcb2c6.js"),["assets/SupportPage-90dcb2c6.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/card-b68930bc.js","assets/select-1d5620de.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js","assets/tabs-eac78ff9.js"])),jo=m.lazy(()=>je(()=>import("./ResetPasswordPage-c1164478.js"),["assets/ResetPasswordPage-c1164478.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),To=m.lazy(()=>je(()=>import("./NutritionPageFunctional-1432c9ca.js"),["assets/NutritionPageFunctional-1432c9ca.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/QuickLogMeal-e2499b18.js","assets/dialog-aab7369c.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js","assets/select-1d5620de.js"])),ko=m.lazy(()=>je(()=>import("./FitnessPage-d173122a.js"),["assets/FitnessPage-d173122a.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),So=m.lazy(()=>je(()=>import("./ProgressPage-44969a8e.js"),["assets/ProgressPage-44969a8e.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),Eo=m.lazy(()=>je(()=>import("./MessagingCenter-09e6b63d.js"),["assets/MessagingCenter-09e6b63d.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/card-b68930bc.js","assets/select-1d5620de.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js","assets/dialog-aab7369c.js"])),Oo=m.lazy(()=>je(()=>import("./PrivacyPolicyPage-081b2cb3.js"),["assets/PrivacyPolicyPage-081b2cb3.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/SiteLayout-f03d29d2.js","assets/OnboardingSurvey-c2168d73.js","assets/dialog-aab7369c.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),No=m.lazy(()=>je(()=>import("./TermsOfServicePage-a50412e8.js"),["assets/TermsOfServicePage-a50412e8.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/SiteLayout-f03d29d2.js","assets/OnboardingSurvey-c2168d73.js","assets/dialog-aab7369c.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),Po=m.lazy(()=>je(()=>import("./AdminFAQPage-a66f5faa.js"),["assets/AdminFAQPage-a66f5faa.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/card-b68930bc.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),Co=m.lazy(()=>je(()=>import("./DownloadPage-e2250090.js"),["assets/DownloadPage-e2250090.js","assets/vendor-ui-c5075e48.js","assets/vendor-react-c35372bd.js","assets/SiteLayout-f03d29d2.js","assets/OnboardingSurvey-c2168d73.js","assets/dialog-aab7369c.js","assets/vendor-utils-7072100e.js","assets/vendor-editor-d6577754.js"])),Ao=()=>e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx("img",{src:Di,alt:"GreenoFig Logo",className:"w-24 h-24 animate-pulse"})}),Ro=({children:t})=>{const{user:r,userProfile:s,loading:n}=Li(),i=w();return r&&s?t:n&&!r?e.jsx(Ao,{}):r?t:e.jsx(S,{to:"/login",state:{from:i},replace:!0})},Io=({children:t})=>{const{user:r,userProfile:s,loading:n}=Li();return n&&!r?e.jsx(Ao,{}):"admin"!==(null==s?void 0:s.role)&&"super_admin"!==(null==s?void 0:s.role)?e.jsx(S,{to:"/app",replace:!0}):t},$o=({children:t})=>{const{user:r,userProfile:s,loading:n}=Li();return n&&!r?e.jsx(Ao,{}):["admin","super_admin","nutritionist"].includes(null==s?void 0:s.role)?t:e.jsx(S,{to:"/app",replace:!0})},Lo=()=>{const{user:t,userProfile:r,loading:s}=Li();if(s||t&&!r)return e.jsx(Ao,{});if(!t)return e.jsx(S,{to:"/login",replace:!0});if(!r)return e.jsx(S,{to:"/login",replace:!0});const n=r.role;let i="/app/user";return"admin"===n||"super_admin"===n?i="/app/admin":"nutritionist"===n&&(i="/app/nutritionist"),e.jsx(S,{to:i,replace:!0})},Do=()=>{const{user:t,loading:r}=Li();return r?e.jsx(Ao,{}):t?e.jsx(S,{to:"/app",replace:!0}):e.jsx(S,{to:"/home",replace:!0})};function Uo(){const t=w();return e.jsxs(e.Fragment,{children:[e.jsx(to,{}),e.jsxs(Vt,{children:[e.jsx("title",{children:"GreenoFig - AI-Powered Health & Wellness"}),e.jsx("meta",{name:"description",content:"Your AI-Powered Health Companion. Achieve your wellness goals with personalized nutrition, fitness, and lifestyle coaching."})]}),e.jsx(m.Suspense,{fallback:e.jsx(Ao,{}),children:e.jsx(D,{mode:"wait",children:e.jsxs(T,{location:t,children:[e.jsx(k,{path:"/login",element:e.jsx(Fi,{logoUrl:Di})}),e.jsx(k,{path:"/signup",element:e.jsx(Fi,{logoUrl:Di,initialIsLogin:!1})}),e.jsx(k,{path:"/reset-password",element:e.jsx(jo,{})}),e.jsxs(k,{path:"/app",element:e.jsx(Ro,{children:e.jsx(eo,{logoUrl:Di})}),children:[e.jsx(k,{index:!0,element:e.jsx(Lo,{})}),e.jsx(k,{path:"user",element:e.jsx(uo,{logoUrl:Di})}),e.jsx(k,{path:"nutritionist",element:e.jsx(ho,{logoUrl:Di})}),e.jsx(k,{path:"admin",element:e.jsx(fo,{logoUrl:Di})}),e.jsx(k,{path:"profile",element:e.jsx(mo,{logoUrl:Di})}),e.jsx(k,{path:"billing",element:e.jsx(_o,{})}),e.jsx(k,{path:"support",element:e.jsx(xo,{})}),e.jsx(k,{path:"ai-coach",element:e.jsx(vo,{})}),e.jsx(k,{path:"nutrition",element:e.jsx(To,{})}),e.jsx(k,{path:"fitness",element:e.jsx(ko,{})}),e.jsx(k,{path:"progress",element:e.jsx(So,{})}),e.jsx(k,{path:"messages",element:e.jsx(Eo,{})}),e.jsx(k,{path:"admin/blog/new",element:e.jsx($o,{children:e.jsx(go,{logoUrl:Di})})}),e.jsx(k,{path:"admin/blog/edit/:postId",element:e.jsx($o,{children:e.jsx(go,{logoUrl:Di})})}),e.jsx(k,{path:"admin/blog/tags",element:e.jsx(Io,{children:e.jsx(yo,{logoUrl:Di})})}),e.jsx(k,{path:"nutritionist/blog/new",element:e.jsx($o,{children:e.jsx(go,{logoUrl:Di})})}),e.jsx(k,{path:"nutritionist/blog/edit/:postId",element:e.jsx($o,{children:e.jsx(go,{logoUrl:Di})})}),e.jsx(k,{path:"admin/faq",element:e.jsx(Io,{children:e.jsx(Po,{})})}),e.jsx(k,{path:"admin/revenue",element:e.jsx(Io,{children:e.jsx(wo,{})})})]}),e.jsx(k,{path:"/onboarding",element:e.jsx(Ro,{children:e.jsx(po,{logoUrl:Di})})}),e.jsx(k,{path:"/survey",element:e.jsx(bo,{logoUrl:Di})}),e.jsx(k,{path:"/home",element:e.jsx(ro,{logoUrl:Di})}),e.jsx(k,{path:"/features",element:e.jsx(so,{logoUrl:Di})}),e.jsx(k,{path:"/pricing",element:e.jsx(no,{logoUrl:Di})}),e.jsx(k,{path:"/download",element:e.jsx(Co,{logoUrl:Di})}),e.jsx(k,{path:"/blog",element:e.jsx(io,{logoUrl:Di})}),e.jsx(k,{path:"/blog/:postId",element:e.jsx(io,{logoUrl:Di})}),e.jsx(k,{path:"/reviews",element:e.jsx(oo,{logoUrl:Di})}),e.jsx(k,{path:"/contact",element:e.jsx(ao,{logoUrl:Di})}),e.jsx(k,{path:"/faq",element:e.jsx(lo,{logoUrl:Di})}),e.jsx(k,{path:"/about",element:e.jsx(co,{logoUrl:Di})}),e.jsx(k,{path:"/privacy-policy",element:e.jsx(Oo,{logoUrl:Di})}),e.jsx(k,{path:"/terms-of-service",element:e.jsx(No,{logoUrl:Di})}),e.jsx(k,{path:"/",element:e.jsx(Do,{})}),e.jsx(k,{path:"/*",element:e.jsx(S,{to:"/home",replace:!0})})]},t.pathname)})}),e.jsx(ar,{})]})}const Bo=new class{constructor(){this.isInitialized=!1}init(){this.isInitialized||(window.onerror=(e,t,r,s,n)=>(this.logError({message:e.toString(),stack:null==n?void 0:n.stack,type:"runtime_error",url:window.location.href,source:t,line:r,column:s}),!1),window.addEventListener("unhandledrejection",e=>{var t;this.logError({message:`Unhandled Promise Rejection: ${e.reason}`,stack:null==(t=e.reason)?void 0:t.stack,type:"promise_rejection",url:window.location.href})}),this.isInitialized=!0)}async logError({message:e,stack:t="",type:r="unknown",componentName:s="unknown",severity:n="medium",url:i=window.location.href,source:o="",line:a=null,column:l=null,userId:c=null}){try{if(!c){const{data:{user:e}}=await Pi.auth.getUser();c=(null==e?void 0:e.id)||null}const u={error_message:e,error_stack:t,error_type:r,component_name:s,user_id:c,user_agent:navigator.userAgent,url:i,severity:n,status:"open",source_file:o,line_number:a,column_number:l,browser_info:{language:navigator.language,platform:navigator.platform,screen:{width:window.screen.width,height:window.screen.height}}},{error:d}=await Pi.from("error_logs").insert([u])}catch(u){}}log(e,t="unknown",r="medium"){this.logError({message:e.message||e.toString(),stack:e.stack,type:"manual_log",componentName:t,severity:r})}};var Mo;"undefined"!=typeof window&&Bo.init(),Bo.init(),we.createRoot(document.getElementById("root")).render(e.jsx(g.StrictMode,{children:e.jsx($i,{children:e.jsx(E,{children:e.jsx(Uo,{})})})})),(Mo=e=>{})&&Mo instanceof Function&&je(()=>import("./web-vitals-22b21531.js"),[]).then(({getCLS:e,getFID:t,getFCP:r,getLCP:s,getTTFB:n})=>{e(Mo),t(Mo),r(Mo),s(Mo),n(Mo)}).catch(()=>{}),"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(e=>{e.forEach(e=>{e.unregister()})});export{zi as A,Bi as B,Qi as F,Vt as H,Gi as I,Yi as L,Ji as T,je as _,Wi as a,Hi as b,Wt as c,qi as d,or as e,Ui as f,Xi as g,Di as l,Pi as s,ir as t,Li as u};
