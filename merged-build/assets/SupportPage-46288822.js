import{j as e}from"./vendor-ui-1f4695e3.js";import{r as s}from"./vendor-react-c35372bd.js";import{u as t,a as r,B as a,T as i,I as l,s as c,t as n,g as o}from"./index-6b8dec48.js";import{C as d,a as p,b as u,e as m,c as x}from"./card-337a2a4f.js";import{S as h,a as j,b as g,c as b,d as f}from"./select-2a07d39b.js";import{T as y,a as N,b as v,c as w}from"./tabs-fb6868c7.js";import{m as k,a3 as S,cP as C,cQ as D,M as q,L as P,h as T,g as _,bD as F,a6 as I,a8 as B,Z as L,am as M}from"./vendor-utils-a892ab91.js";import"./vendor-editor-8f9f6f2d.js";const E=()=>{const{t:E}=t(),{userProfile:H}=r(),[U,V]=s.useState(!1),[G,$]=s.useState([]),[z,J]=s.useState([]),[O,Q]=s.useState(!0),[R,Y]=s.useState(""),[Z,A]=s.useState(""),[K,W]=s.useState(""),[X,ee]=s.useState("medium"),[se,te]=s.useState(0),[re,ae]=s.useState("suggestion"),[ie,le]=s.useState(""),ce=async()=>{if(!(null==H?void 0:H.id))return;Q(!0);const{data:e,error:s}=await c.from("issues").select("*").eq("user_id",H.id).order("created_at",{ascending:!1});s||J(e||[]),Q(!1)};s.useEffect(()=>{(null==H?void 0:H.id)&&((async()=>{const{data:e}=await c.from("issue_categories").select("*").eq("is_active",!0).order("display_order");e&&$(e)})(),ce())},[null==H?void 0:H.id]);const ne=s=>{switch(s){case"open":return e.jsxs(o,{className:"bg-blue-500/20 text-blue-300 border-blue-500/30",children:[e.jsx(L,{className:"w-3 h-3 mr-1"}),E("support.statusOpen")]});case"in_progress":return e.jsxs(o,{className:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30",children:[e.jsx(B,{className:"w-3 h-3 mr-1"}),E("support.statusInProgress")]});case"resolved":return e.jsxs(o,{className:"bg-green-500/20 text-green-400 border-green-500/30",children:[e.jsx(I,{className:"w-3 h-3 mr-1"}),E("support.statusResolved")]});case"closed":return e.jsx(o,{variant:"outline",children:E("support.statusClosed")});default:return e.jsx(o,{children:s})}},oe=s=>{switch(s){case"urgent":return e.jsxs(o,{className:"bg-red-500/20 text-red-300 border-red-500/30",children:[e.jsx(M,{className:"w-3 h-3 mr-1"}),E("support.priorityUrgentBadge")]});case"high":return e.jsxs(o,{className:"bg-orange-500/20 text-orange-300 border-orange-500/30",children:[e.jsx(M,{className:"w-3 h-3 mr-1"}),E("support.priorityHighBadge")]});case"medium":return e.jsx(o,{className:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30",children:E("support.priorityMediumBadge")});case"low":return e.jsx(o,{className:"bg-gray-500/20 text-gray-300 border-gray-500/30",children:E("support.priorityLowBadge")});default:return e.jsx(o,{children:s})}};return e.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:E("support.title")}),e.jsx("p",{className:"text-text-secondary",children:E("support.subtitle")})]}),e.jsxs(y,{defaultValue:"feedback",className:"w-full",children:[e.jsxs(N,{className:"grid w-full grid-cols-3",children:[e.jsx(v,{value:"feedback",children:E("support.quickFeedback")}),e.jsx(v,{value:"create",children:E("support.createTicket")}),e.jsxs(v,{value:"mytickets",children:[E("support.myTickets")," (",z.length,")"]})]}),e.jsx(w,{value:"feedback",children:e.jsxs(d,{className:"glass-effect",children:[e.jsxs(p,{children:[e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-6 h-6 text-yellow-500"}),E("support.quickFeedback")]}),e.jsx(m,{children:E("support.quickFeedbackDesc")})]}),e.jsx(x,{children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!ie.trim())return void n({title:E("support.missingInfo"),description:E("support.missingFeedbackDesc"),variant:"destructive"});V(!0);const s=`${"suggestion"===re?"ðŸ’¡ Suggestion":"complaint"===re?"âš ï¸ Complaint":"â­ Praise"} - ${se} stars`,{error:t}=await c.from("issues").insert({user_id:H.id,subject:s,description:ie.trim(),category:"feedback",priority:"complaint"===re?"high":"low",status:"open"});t?n({title:E("support.errorSubmitting"),description:t.message,variant:"destructive"}):(n({title:E("support.feedbackSubmitted"),description:E("support.feedbackSubmittedDesc")}),te(0),ae("suggestion"),le(""),ce()),V(!1)},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-3",children:E("support.rateExperience")}),e.jsx("div",{className:"flex gap-2 justify-center py-4",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>te(s),className:"transition-all transform hover:scale-110",children:e.jsx(S,{className:"w-10 h-10 "+(s<=se?"fill-yellow-500 text-yellow-500":"text-gray-400")})},s))}),se>0&&e.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:[5===se&&E("support.ratingExcellent"),4===se&&E("support.ratingGreat"),3===se&&E("support.ratingGood"),2===se&&E("support.ratingCouldBeBetter"),1===se&&E("support.ratingNeedsImprovement")]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:E("support.feedbackType")}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs(a,{type:"button",variant:"suggestion"===re?"default":"outline",onClick:()=>ae("suggestion"),className:"h-auto py-4 flex flex-col items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5"}),e.jsx("span",{children:E("support.suggestion")})]}),e.jsxs(a,{type:"button",variant:"complaint"===re?"default":"outline",onClick:()=>ae("complaint"),className:"h-auto py-4 flex flex-col items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5"}),e.jsx("span",{children:E("support.issue")})]}),e.jsxs(a,{type:"button",variant:"praise"===re?"default":"outline",onClick:()=>ae("praise"),className:"h-auto py-4 flex flex-col items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5"}),e.jsx("span",{children:E("support.praise")})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[E("support.tellUsMore")," ",e.jsx("span",{className:"text-red-400",children:E("support.required")})]}),e.jsx(i,{placeholder:E("suggestion"===re?"support.feedbackPlaceholderSuggestion":"complaint"===re?"support.feedbackPlaceholderIssue":"support.feedbackPlaceholderPraise"),value:ie,onChange:e=>le(e.target.value),rows:6,required:!0})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(q,{className:"w-5 h-5 text-blue-400 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-blue-300 mb-1",children:E("support.conversationInfo")}),e.jsx("p",{className:"text-blue-200/70",children:E("support.conversationInfoDesc")})]})]}),e.jsx(a,{type:"submit",className:"w-full",disabled:U||!ie.trim(),children:U?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-4 h-4 mr-2 animate-spin"}),E("support.submitting")]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),E("support.sendFeedback")]})})]})})]})}),e.jsx(w,{value:"create",children:e.jsxs(d,{className:"glass-effect",children:[e.jsxs(p,{children:[e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-6 h-6"}),E("support.submitTicket")]}),e.jsx(m,{children:E("support.submitTicketDesc")})]}),e.jsx(x,{children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!R.trim()||!Z.trim()||!K)return void n({title:E("support.missingInfo"),description:E("support.missingInfoDesc"),variant:"destructive"});V(!0);const{error:s}=await c.from("issues").insert({user_id:H.id,subject:R.trim(),description:Z.trim(),category:K,priority:X,status:"open"});s?n({title:E("support.errorCreating"),description:s.message,variant:"destructive"}):(n({title:E("support.ticketCreated"),description:E("support.ticketCreatedDesc")}),Y(""),A(""),W(""),ee("medium"),ce()),V(!1)},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[E("support.subject")," ",e.jsx("span",{className:"text-red-400",children:E("support.required")})]}),e.jsx(l,{type:"text",placeholder:E("support.subjectPlaceholder"),value:R,onChange:e=>Y(e.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[E("support.category")," ",e.jsx("span",{className:"text-red-400",children:E("support.required")})]}),e.jsxs(h,{value:K,onValueChange:W,required:!0,children:[e.jsx(j,{children:e.jsx(g,{placeholder:E("support.categoryPlaceholder")})}),e.jsx(b,{children:G.map(s=>e.jsxs(f,{value:s.slug,children:[s.name," - ",s.description]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:E("support.priority")}),e.jsxs(h,{value:X,onValueChange:ee,children:[e.jsx(j,{children:e.jsx(g,{})}),e.jsxs(b,{children:[e.jsx(f,{value:"low",children:E("support.priorityLow")}),e.jsx(f,{value:"medium",children:E("support.priorityMedium")}),e.jsx(f,{value:"high",children:E("support.priorityHigh")}),e.jsx(f,{value:"urgent",children:E("support.priorityUrgent")})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[E("support.description")," ",e.jsx("span",{className:"text-red-400",children:E("support.required")})]}),e.jsx(i,{placeholder:E("support.descriptionPlaceholder"),value:Z,onChange:e=>A(e.target.value),rows:8,required:!0}),e.jsx("p",{className:"text-xs text-text-secondary mt-2",children:E("support.descriptionHelper")})]}),e.jsx(a,{type:"submit",className:"w-full",disabled:U,children:U?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-4 h-4 mr-2 animate-spin"}),E("support.submitting")]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),E("support.submitButton")]})})]})})]})}),e.jsx(w,{value:"mytickets",children:e.jsxs(d,{className:"glass-effect",children:[e.jsxs(p,{children:[e.jsx(u,{children:E("support.myTicketsTitle")}),e.jsx(m,{children:E("support.myTicketsDesc")})]}),e.jsx(x,{children:O?e.jsx("div",{className:"flex justify-center items-center py-10",children:e.jsx(P,{className:"h-8 w-8 animate-spin text-primary"})}):0===z.length?e.jsxs("div",{className:"text-center py-10",children:[e.jsx(F,{className:"w-16 h-16 mx-auto text-text-secondary opacity-50 mb-4"}),e.jsx("p",{className:"text-text-secondary",children:E("support.noTicketsYet")})]}):e.jsx("div",{className:"space-y-4",children:z.map(s=>e.jsxs(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-4 rounded-lg glass-effect border border-white/10 hover:border-primary/30 transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg mb-1",children:s.subject}),e.jsx("p",{className:"text-sm text-text-secondary line-clamp-2",children:s.description})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[ne(s.status),oe(s.priority)]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-text-secondary",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:[E("support.ticketNumber"),s.id.slice(0,8)]}),s.category&&e.jsxs("span",{className:"capitalize",children:[E("support.categoryLabel")," ",s.category.replace("_"," ")]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:[E("support.created")," ",new Date(s.created_at).toLocaleDateString()]}),e.jsxs("span",{children:[E("support.updated")," ",new Date(s.updated_at).toLocaleDateString()]})]})]}),"resolved"===s.status&&e.jsx("div",{className:"mt-3 pt-3 border-t border-white/10",children:e.jsx("p",{className:"text-sm text-green-400",children:E("support.resolved")})})]},s.id))})})]})})]})]})};export{E as default};
