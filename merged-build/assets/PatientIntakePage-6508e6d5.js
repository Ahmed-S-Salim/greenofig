import{j as e}from"./vendor-ui-1f4695e3.js";import{k as r,r as s}from"./vendor-react-c35372bd.js";import{u as t,n as a,s as n,I as i,B as l,T as o}from"./index-6b8dec48.js";import{L as d,au as c,a6 as m,M as x,S as u,J as p,U as h,l as b,b9 as f,an as g,a as y,h as v,aA as j,a1 as N,X as w,av as _,H as k,by as q,F as S}from"./vendor-utils-a892ab91.js";import"./vendor-editor-8f9f6f2d.js";const $=({value:r,onChange:t,label:a,required:n,isRTL:i})=>{const o=s.useRef(null),[d,c]=s.useState(!1);s.useEffect(()=>{const e=o.current,s=e.getContext("2d");if(s.fillStyle="rgba(255,255,255,0.95)",s.fillRect(0,0,e.width,e.height),s.strokeStyle="#1a1a1a",s.lineWidth=2,s.lineCap="round",r){const e=new Image;e.onload=()=>s.drawImage(e,0,0),e.src=r}},[]);const m=e=>{var r,s,t,a;const n=o.current,i=n.getBoundingClientRect(),l=n.getContext("2d"),d=(e.clientX||(null==(s=null==(r=e.touches)?void 0:r[0])?void 0:s.clientX))-i.left,m=(e.clientY||(null==(a=null==(t=e.touches)?void 0:t[0])?void 0:a.clientY))-i.top;l.beginPath(),l.moveTo(d,m),c(!0)},x=e=>{var r,s,t,a;if(!d)return;const n=o.current,i=n.getBoundingClientRect(),l=n.getContext("2d"),c=(e.clientX||(null==(s=null==(r=e.touches)?void 0:r[0])?void 0:s.clientX))-i.left,m=(e.clientY||(null==(a=null==(t=e.touches)?void 0:t[0])?void 0:a.clientY))-i.top;l.lineTo(c,m),l.stroke()},u=()=>{if(d){c(!1);const e=o.current;t(e.toDataURL())}};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground",children:[a," ",n&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"border-2 border-primary/30 rounded-xl overflow-hidden bg-white shadow-inner",children:e.jsx("canvas",{ref:o,width:400,height:150,className:"w-full touch-none cursor-crosshair",onMouseDown:m,onMouseMove:x,onMouseUp:u,onMouseLeave:u,onTouchStart:m,onTouchMove:x,onTouchEnd:u})}),e.jsx(l,{type:"button",variant:"outline",size:"sm",onClick:()=>{const e=o.current,r=e.getContext("2d");r.fillStyle="rgba(255,255,255,0.95)",r.fillRect(0,0,e.width,e.height),t("")},className:"text-xs border-primary/30 text-primary hover:bg-primary/10",children:i?"Ù…Ø³Ø­ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹":"Clear Signature"})]})},C=({question:r,value:s,onChange:t,language:a})=>{var n,d;const c="ar"===a&&r.label_ar||r.label,m="ar"===a,x={id:r.id,value:s||"",onChange:e=>t(r.id,e.target.value),required:r.required,className:"w-full bg-card/50 border-border/50 focus:border-primary focus:ring-primary rounded-xl shadow-sm text-foreground "+(m?"text-right":"text-left"),dir:m?"rtl":"ltr"};switch(r.type){case"text":case"tel":case"phone":case"email":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:r.id,className:"block text-sm font-semibold text-foreground",children:[c," ",r.required&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(i,{type:"phone"===r.type?"tel":r.type,...x})]});case"number":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:r.id,className:"block text-sm font-semibold text-foreground",children:[c," ",r.required&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(i,{type:"number",...x})]});case"date":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:r.id,className:"block text-sm font-semibold text-foreground",children:[c," ",r.required&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(i,{type:"date",...x})]});case"textarea":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:r.id,className:"block text-sm font-semibold text-foreground",children:[c," ",r.required&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{...x,rows:3})]});case"yes_no":case"yesno":return e.jsxs("div",{className:"flex items-center justify-between p-4 glass-effect rounded-xl border border-border/30",children:[e.jsxs("span",{className:"text-sm font-medium text-foreground flex-1 pr-4",children:[c," ",r.required&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{type:"button",size:"sm",variant:!0===s||"yes"===s?"default":"outline",className:"min-w-[70px] rounded-xl transition-all "+(!0===s||"yes"===s?"bg-primary hover:bg-primary/90 text-primary-foreground shadow-lg":"border-border/50 hover:bg-primary/10 hover:border-primary/30"),onClick:()=>t(r.id,!0),children:[e.jsx(N,{className:"w-4 h-4 mr-1"}),"ar"===a?"Ù†Ø¹Ù…":"Yes"]}),e.jsxs(l,{type:"button",size:"sm",variant:!1===s||"no"===s?"default":"outline",className:"min-w-[70px] rounded-xl transition-all "+(!1===s||"no"===s?"bg-red-500 hover:bg-red-600 text-white shadow-lg":"border-border/50 hover:bg-red-500/10 hover:border-red-500/30"),onClick:()=>t(r.id,!1),children:[e.jsx(w,{className:"w-4 h-4 mr-1"}),"ar"===a?"Ù„Ø§":"No"]})]})]});case"select":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:r.id,className:"block text-sm font-semibold text-foreground",children:[c," ",r.required&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...x,className:"w-full p-3 bg-card/50 border border-border/50 rounded-xl focus:ring-2 focus:ring-primary focus:border-primary text-foreground shadow-sm",children:[e.jsx("option",{value:"",children:"ar"===a?"Ø§Ø®ØªØ±...":"Select..."}),null==(n=r.options)?void 0:n.map((r,s)=>e.jsx("option",{value:r.value||r,children:"ar"===a?r.label_ar||r.label||r:r.label||r},s))]})]});case"multiselect":const u=Array.isArray(s)?s:[];return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-semibold text-foreground",children:[c," ",r.required&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:null==(d=r.options)?void 0:d.map((s,n)=>{const i=s.value||s,l=u.includes(i);return e.jsxs("button",{type:"button",className:"px-4 py-2 rounded-xl text-sm font-medium transition-all "+(l?"bg-primary text-primary-foreground shadow-lg":"bg-card/50 text-foreground hover:bg-primary/10 border border-border/50 hover:border-primary/30"),onClick:()=>{const e=l?u.filter(e=>e!==i):[...u,i];t(r.id,e)},children:[l&&e.jsx(N,{className:"w-3 h-3 inline mr-1"}),"ar"===a?s.label_ar||s.label||s:s.label||s]},n)})})]});case"signature":return e.jsx($,{value:s,onChange:e=>t(r.id,e),label:c,required:r.required,isRTL:m});default:return null}},F=r=>{const s=[_,k,q,b,S],t=s[r%s.length];return e.jsx(t,{className:"w-5 h-5"})},D=[{name:"Exercise History",name_ar:"ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†",sections:[{title:"Exercise Habits",title_ar:"Ø¹Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†",questions:[{id:"exercise_frequency",label:"How often do you exercise?",label_ar:"ÙƒÙ… Ù…Ø±Ø© ØªÙ…Ø§Ø±Ø³ Ø§Ù„Ø±ÙŠØ§Ø¶Ø©ØŸ",type:"select",options:[{value:"never",label:"Never",label_ar:"Ø£Ø¨Ø¯Ø§Ù‹"},{value:"1-2",label:"1-2 times/week",label_ar:"1-2 Ù…Ø±Ø§Øª/Ø£Ø³Ø¨ÙˆØ¹"},{value:"3-4",label:"3-4 times/week",label_ar:"3-4 Ù…Ø±Ø§Øª/Ø£Ø³Ø¨ÙˆØ¹"},{value:"5+",label:"5+ times/week",label_ar:"5+ Ù…Ø±Ø§Øª/Ø£Ø³Ø¨ÙˆØ¹"}],required:!0},{id:"exercise_types",label:"Types of exercise you do",label_ar:"Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„ØªÙŠ ØªÙ…Ø§Ø±Ø³Ù‡Ø§",type:"textarea",required:!1},{id:"exercise_duration",label:"Average workout duration (minutes)",label_ar:"Ù…ØªÙˆØ³Ø· Ù…Ø¯Ø© Ø§Ù„ØªÙ…Ø±ÙŠÙ† (Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚)",type:"number",required:!1},{id:"fitness_goals",label:"What are your fitness goals?",label_ar:"Ù…Ø§ Ù‡ÙŠ Ø£Ù‡Ø¯Ø§ÙÙƒ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©ØŸ",type:"textarea",required:!0},{id:"gym_membership",label:"Do you have a gym membership?",label_ar:"Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø¹Ø¶ÙˆÙŠØ© ØµØ§Ù„Ø© Ø±ÙŠØ§Ø¶ÙŠØ©ØŸ",type:"yes_no",required:!1}]}]},{name:"Health History",name_ar:"Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„ØµØ­ÙŠ",sections:[{title:"Health & Lifestyle",title_ar:"Ø§Ù„ØµØ­Ø© ÙˆÙ†Ù…Ø· Ø§Ù„Ø­ÙŠØ§Ø©",questions:[{id:"current_weight",label:"Current Weight (kg)",label_ar:"Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø­Ø§Ù„ÙŠ (ÙƒØ¬Ù…)",type:"number",required:!0},{id:"target_weight",label:"Target Weight (kg)",label_ar:"Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù (ÙƒØ¬Ù…)",type:"number",required:!1},{id:"height",label:"Height (cm)",label_ar:"Ø§Ù„Ø·ÙˆÙ„ (Ø³Ù…)",type:"number",required:!0},{id:"sleep_hours",label:"Average sleep hours per night",label_ar:"Ù…ØªÙˆØ³Ø· Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù†ÙˆÙ… ÙÙŠ Ø§Ù„Ù„ÙŠÙ„Ø©",type:"number",required:!1},{id:"water_intake",label:"Daily water intake (glasses)",label_ar:"ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ…ÙŠØ© (Ø£ÙƒÙˆØ§Ø¨)",type:"number",required:!1},{id:"smoking",label:"Do you smoke?",label_ar:"Ù‡Ù„ ØªØ¯Ø®Ù†ØŸ",type:"yes_no",required:!0},{id:"alcohol",label:"Do you drink alcohol?",label_ar:"Ù‡Ù„ ØªØ´Ø±Ø¨ Ø§Ù„ÙƒØ­ÙˆÙ„ØŸ",type:"yes_no",required:!0},{id:"dietary_restrictions",label:"Any dietary restrictions or allergies?",label_ar:"Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ù‚ÙŠÙˆØ¯ ØºØ°Ø§Ø¦ÙŠØ© Ø£Ùˆ Ø­Ø³Ø§Ø³ÙŠØ©ØŸ",type:"textarea",required:!1}]}]},{name:"Medical History",name_ar:"Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ø¨ÙŠ",sections:[{title:"Medical Information",title_ar:"Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ©",questions:[{id:"chronic_conditions",label:"Do you have any chronic conditions?",label_ar:"Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø£ÙŠ Ø£Ù…Ø±Ø§Ø¶ Ù…Ø²Ù…Ù†Ø©ØŸ",type:"textarea",required:!1},{id:"diabetes",label:"Do you have diabetes?",label_ar:"Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ù…Ø±Ø¶ Ø§Ù„Ø³ÙƒØ±ÙŠØŸ",type:"yes_no",required:!0},{id:"heart_disease",label:"Any heart conditions?",label_ar:"Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø£Ù…Ø±Ø§Ø¶ Ù‚Ù„Ø¨ÙŠØ©ØŸ",type:"yes_no",required:!0},{id:"blood_pressure",label:"High blood pressure?",label_ar:"Ø¶ØºØ· Ø¯Ù… Ù…Ø±ØªÙØ¹ØŸ",type:"yes_no",required:!0},{id:"current_medications",label:"Current medications",label_ar:"Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©",type:"textarea",required:!1},{id:"supplements",label:"Supplements you take",label_ar:"Ø§Ù„Ù…ÙƒÙ…Ù„Ø§Øª Ø§Ù„ØªÙŠ ØªØªÙ†Ø§ÙˆÙ„Ù‡Ø§",type:"textarea",required:!1},{id:"injuries",label:"Any past injuries affecting exercise?",label_ar:"Ø£ÙŠ Ø¥ØµØ§Ø¨Ø§Øª Ø³Ø§Ø¨Ù‚Ø© ØªØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†ØŸ",type:"textarea",required:!1},{id:"doctor_clearance",label:"Has your doctor cleared you for exercise?",label_ar:"Ù‡Ù„ ÙˆØ§ÙÙ‚ Ø·Ø¨ÙŠØ¨Ùƒ Ø¹Ù„Ù‰ Ù…Ù…Ø§Ø±Ø³Ø© Ø§Ù„Ø±ÙŠØ§Ø¶Ø©ØŸ",type:"yes_no",required:!0}]}]},{name:"Client Intake",name_ar:"Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø¹Ù…ÙŠÙ„",sections:[{title:"Goals & Expectations",title_ar:"Ø§Ù„Ø£Ù‡Ø¯Ø§Ù ÙˆØ§Ù„ØªÙˆÙ‚Ø¹Ø§Øª",questions:[{id:"primary_goal",label:"What is your primary health/fitness goal?",label_ar:"Ù…Ø§ Ù‡Ùˆ Ù‡Ø¯ÙÙƒ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„ØµØ­Ø©/Ø§Ù„Ù„ÙŠØ§Ù‚Ø©ØŸ",type:"select",options:[{value:"lose_weight",label:"Lose Weight",label_ar:"Ø¥Ù†Ù‚Ø§Øµ Ø§Ù„ÙˆØ²Ù†"},{value:"gain_muscle",label:"Build Muscle",label_ar:"Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¹Ø¶Ù„Ø§Øª"},{value:"improve_health",label:"Improve Health",label_ar:"ØªØ­Ø³ÙŠÙ† Ø§Ù„ØµØ­Ø©"},{value:"increase_energy",label:"Increase Energy",label_ar:"Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø·Ø§Ù‚Ø©"},{value:"other",label:"Other",label_ar:"Ø£Ø®Ø±Ù‰"}],required:!0},{id:"goal_timeline",label:"What is your goal timeline?",label_ar:"Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ Ù„Ù‡Ø¯ÙÙƒØŸ",type:"select",options:[{value:"1_month",label:"1 month",label_ar:"Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯"},{value:"3_months",label:"3 months",label_ar:"3 Ø£Ø´Ù‡Ø±"},{value:"6_months",label:"6 months",label_ar:"6 Ø£Ø´Ù‡Ø±"},{value:"1_year",label:"1 year",label_ar:"Ø³Ù†Ø© ÙˆØ§Ø­Ø¯Ø©"}],required:!0},{id:"motivation",label:"What motivates you to achieve your goals?",label_ar:"Ù…Ø§ Ø§Ù„Ø°ÙŠ ÙŠØ­ÙØ²Ùƒ Ù„ØªØ­Ù‚ÙŠÙ‚ Ø£Ù‡Ø¯Ø§ÙÙƒØŸ",type:"textarea",required:!1},{id:"previous_attempts",label:"Have you tried to achieve this goal before?",label_ar:"Ù‡Ù„ Ø­Ø§ÙˆÙ„Øª ØªØ­Ù‚ÙŠÙ‚ Ù‡Ø°Ø§ Ø§Ù„Ù‡Ø¯Ù Ù…Ù† Ù‚Ø¨Ù„ØŸ",type:"yes_no",required:!0},{id:"challenges",label:"What challenges do you face?",label_ar:"Ù…Ø§ Ù‡ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„ØªÙŠ ØªÙˆØ§Ø¬Ù‡Ù‡Ø§ØŸ",type:"textarea",required:!1},{id:"commitment_level",label:"How committed are you (1-10)?",label_ar:"Ù…Ø§ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ²Ø§Ù…Ùƒ (1-10)ØŸ",type:"number",required:!0},{id:"expectations",label:"What do you expect from working with a nutritionist?",label_ar:"Ù…Ø§ Ø§Ù„Ø°ÙŠ ØªØªÙˆÙ‚Ø¹Ù‡ Ù…Ù† Ø§Ù„Ø¹Ù…Ù„ Ù…Ø¹ Ø£Ø®ØµØ§Ø¦ÙŠ Ø§Ù„ØªØºØ°ÙŠØ©ØŸ",type:"textarea",required:!1}]}]}];function T(){var o,N,w,_,k,q,S,$,T,I;const{linkCode:z}=r();t();const{sendPushToUser:A}=a(),[G,P]=s.useState(!0),[E,Y]=s.useState(!1),[H,W]=s.useState(!1),[L,O]=s.useState(null),[M,B]=s.useState([]),[R,U]=s.useState(null),[X,J]=s.useState(!1),[V,K]=s.useState(null),[Q,Z]=s.useState("en"),ee=Q,re="ar"===Q,[se,te]=s.useState({fullName:"",email:"",phone:"",birthDate:"",age:"",address:""}),ae=e=>{const r=e.target.value,s=(e=>{if(!e)return"";const r=new Date,s=new Date(e);let t=r.getFullYear()-s.getFullYear();const a=r.getMonth()-s.getMonth();return(a<0||0===a&&r.getDate()<s.getDate())&&t--,t>0?t:""})(r);te({...se,birthDate:r,age:s.toString()})},[ne,ie]=s.useState(!1),[le,oe]=s.useState(0),[de,ce]=s.useState(0),[me,xe]=s.useState({}),[ue,pe]=s.useState([]);s.useState([]);const[he,be]=s.useState(!1),[fe,ge]=s.useState(null),[ye,ve]=s.useState({}),[je,Ne]=s.useState(null);s.useEffect(()=>{we(),_e()},[z]);const we=async()=>{try{const{data:e,error:r}=await n.from("public_form_links").select("*, form_template:form_templates(*)").eq("link_code",z).eq("is_active",!0).single();if(r||!e)return U(re?"Ø±Ø§Ø¨Ø· Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ØºÙŠØ± ØµØ§Ù„Ø­ Ø£Ùˆ Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©":"Invalid or expired form link"),void P(!1);if(e.expires_at&&new Date(e.expires_at)<new Date)return U(re?"Ø§Ù†ØªÙ‡Øª ØµÙ„Ø§Ø­ÙŠØ© Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø·":"This link has expired"),void P(!1);if(e.max_submissions&&e.current_submissions>=e.max_submissions)return U(re?"ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„ØªÙ‚Ø¯ÙŠÙ…Ø§Øª":"Maximum submissions reached"),void P(!1);O(e);const s=e.form_language||"en";Z(s),B(D);const{data:t}=await n.from("user_profiles").select("full_name, email").eq("id",e.nutritionist_id).single();K(t)}catch(e){U(re?"Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬":"Error loading form")}finally{P(!1)}},_e=async()=>{const e=localStorage.getItem(`draft_${z}`);if(e)try{const{data:r}=await n.from("external_form_submissions").select("*").eq("id",e).eq("status","draft").single();r&&(Ne(r.id),te({fullName:r.submitter_name||"",email:r.submitter_email||"",phone:r.submitter_phone||"",age:r.submitter_age||"",address:r.submitter_address||""}),xe(r.responses||{}),pe(r.completed_forms||[]),r.submitter_name&&r.submitter_email&&ie(!0))}catch(r){}},ke=(e,r)=>{xe(s=>({...s,[e]:r})),ye[e]&&ve(r=>({...r,[e]:null}))},qe=()=>{var e,r;const s=M[le];if(!(null==(e=null==s?void 0:s.sections)?void 0:e[de]))return!0;const t={};return null==(r=s.sections[de].questions)||r.forEach(e=>{if(e.required){const r=me[e.id];(null==r||""===r||Array.isArray(r)&&0===r.length)&&(t[e.id]=!0)}}),ve(t),0===Object.keys(t).length},Se=()=>{(()=>{const e={};return se.fullName.trim()||(e.fullName=!0),se.email.trim()&&/\S+@\S+\.\S+/.test(se.email)||(e.email=!0),se.phone.trim()||(e.phone=!0),se.birthDate||(e.birthDate=!0),ve(e),0===Object.keys(e).length})()&&(ie(!0),Ce())},$e=()=>{const e=fe;be(!1),ge(null),e&&(e.isLastSectionOfForm?(pe(e=>[...e,le]),e.isLastForm||(oe(e=>e+1),ce(0))):ce(e=>e+1))},Ce=async()=>{var e;W(!0);try{const r={link_id:L.id,nutritionist_id:L.nutritionist_id,form_template_id:null==(e=M[0])?void 0:e.id,submitter_name:se.fullName,submitter_email:se.email,submitter_phone:se.phone,submitter_age:se.age,submitter_address:se.address,responses:me,completed_forms:ue,status:"draft"};if(je)await n.from("external_form_submissions").update(r).eq("id",je);else{const{data:e}=await n.from("external_form_submissions").insert(r).select().single();e&&(Ne(e.id),localStorage.setItem(`draft_${z}`,e.id))}}catch(r){}finally{W(!1)}},Fe=async(e,r,s)=>{try{const t=await fetch("https://greenofig.com/api/send-email.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:e,from:"nutritionist@greenofig.com",subject:r,html:s})});if(!t.ok)throw new Error("Email sending failed");await t.json()}catch(t){}},De=async()=>{var e;if(qe()){Y(!0);try{const t={link_id:L.id,nutritionist_id:L.nutritionist_id,form_template_id:null==(e=M[0])?void 0:e.id,submitter_name:se.fullName,submitter_email:se.email,submitter_phone:se.phone,submitter_age:se.age,submitter_address:se.address,responses:me,completed_forms:[...ue,le],signature_data:me.signature||null,status:"submitted",submitted_at:(new Date).toISOString()};je?await n.from("external_form_submissions").update(t).eq("id",je):await n.from("external_form_submissions").insert(t),await n.from("public_form_links").update({current_submissions:(L.current_submissions||0)+1}).eq("id",L.id),localStorage.removeItem(`draft_${z}`),await n.from("notifications").insert({user_id:L.nutritionist_id,type:"patient_intake_submitted",title:re?"ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ù†Ù…Ø§Ø°Ø¬ Ù…Ø±ÙŠØ¶ Ø¬Ø¯ÙŠØ¯":"New Patient Intake Submitted",message:re?`Ù‚Ø§Ù… ${se.fullName} Ø¨ØªÙ‚Ø¯ÙŠÙ… Ø¬Ù…ÙŠØ¹ Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ù‚Ø¨ÙˆÙ„`:`${se.fullName} has submitted all intake forms`,is_read:!1,data:{patient_name:se.fullName,patient_email:se.email}});try{await A(L.nutritionist_id,re?"Ù†Ù…Ø§Ø°Ø¬ Ù…Ø±ÙŠØ¶ Ø¬Ø¯ÙŠØ¯!":"New Patient Intake!",re?`${se.fullName} Ø£ÙƒÙ…Ù„ Ø¬Ù…ÙŠØ¹ Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ù‚Ø¨ÙˆÙ„`:`${se.fullName} completed all intake forms`,{data:{type:"patient_intake",url:"/nutritionist/forms"}})}catch(r){}try{await Fe("nutritionist@greenofig.com",re?`Ù†Ù…ÙˆØ°Ø¬ Ù…Ø±ÙŠØ¶ Ø¬Ø¯ÙŠØ¯: ${se.fullName}`:`New Patient Intake: ${se.fullName}`,(()=>{const e=(new Date).toLocaleDateString(re?"ar-EG":"en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return`\n      <!DOCTYPE html>\n      <html dir="${re?"rtl":"ltr"}">\n      <head>\n        <meta charset="UTF-8">\n        <style>\n          body { font-family: Arial, sans-serif; background: #f5f5f5; margin: 0; padding: 20px; }\n          .container { max-width: 600px; margin: 0 auto; background: #fff; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }\n          .header { background: linear-gradient(135deg, #6BD55C, #4ade80); padding: 30px; text-align: center; }\n          .header img { width: 60px; height: 60px; border-radius: 12px; margin-bottom: 10px; }\n          .header h1 { color: #fff; margin: 0; font-size: 24px; }\n          .content { padding: 30px; }\n          .alert-box { background: #fef3c7; border: 1px solid #f59e0b; border-radius: 12px; padding: 15px; margin-bottom: 20px; }\n          .alert-box h3 { color: #d97706; margin: 0 0 5px 0; }\n          .patient-card { background: #f0fdf4; border: 2px solid #6BD55C; border-radius: 12px; padding: 20px; margin-bottom: 20px; }\n          .patient-card h3 { color: #16a34a; margin: 0 0 15px 0; }\n          .info-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #e5e7eb; }\n          .info-row:last-child { border-bottom: none; }\n          .info-label { color: #6b7280; font-size: 14px; }\n          .info-value { color: #1f2937; font-weight: 600; }\n          .cta-btn { display: inline-block; background: #6BD55C; color: #fff; padding: 15px 30px; border-radius: 10px; text-decoration: none; font-weight: 600; margin-top: 20px; }\n          .footer { background: #f9fafb; padding: 20px; text-align: center; border-top: 1px solid #e5e7eb; }\n          .footer p { color: #6b7280; font-size: 12px; margin: 0; }\n        </style>\n      </head>\n      <body>\n        <div class="container">\n          <div class="header">\n            <img src="https://greenofig.com/logo.png" alt="GreenoFig">\n            <h1>GreenoFig</h1>\n          </div>\n          <div class="content">\n            <div class="alert-box">\n              <h3>${re?"ğŸ”” Ù†Ù…ÙˆØ°Ø¬ Ù…Ø±ÙŠØ¶ Ø¬Ø¯ÙŠØ¯!":"ğŸ”” New Patient Intake!"}</h3>\n              <p style="margin: 0; color: #92400e;">${re?"Ù‚Ø§Ù… Ù…Ø±ÙŠØ¶ Ø¬Ø¯ÙŠØ¯ Ø¨Ø¥ÙƒÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ù‚Ø¨ÙˆÙ„":"A new patient has completed all intake forms"}</p>\n            </div>\n\n            <div class="patient-card">\n              <h3>${re?"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø±ÙŠØ¶":"Patient Information"}</h3>\n              <div class="info-row">\n                <span class="info-label">${re?"Ø§Ù„Ø§Ø³Ù…":"Name"}</span>\n                <span class="info-value">${se.fullName}</span>\n              </div>\n              <div class="info-row">\n                <span class="info-label">${re?"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ":"Email"}</span>\n                <span class="info-value">${se.email}</span>\n              </div>\n              <div class="info-row">\n                <span class="info-label">${re?"Ø§Ù„Ù‡Ø§ØªÙ":"Phone"}</span>\n                <span class="info-value">${se.phone}</span>\n              </div>\n              <div class="info-row">\n                <span class="info-label">${re?"Ø§Ù„Ø¹Ù…Ø±":"Age"}</span>\n                <span class="info-value">${se.age} ${re?"Ø³Ù†Ø©":"years"}</span>\n              </div>\n              <div class="info-row">\n                <span class="info-label">${re?"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø±Ø³Ø§Ù„":"Submitted"}</span>\n                <span class="info-value">${e}</span>\n              </div>\n            </div>\n\n            <p style="color: #374151;">${re?"ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© ÙˆØ§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø±ÙŠØ¶ Ù„ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø©.":"Please review the submitted forms and contact the patient to schedule their consultation."}</p>\n\n            <center>\n              <a href="https://greenofig.com/nutritionist/forms" class="cta-btn">\n                ${re?"Ø¹Ø±Ø¶ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬":"View Forms"}\n              </a>\n            </center>\n          </div>\n          <div class="footer">\n            <p>Â© ${(new Date).getFullYear()} GreenoFig - ${re?"Ø´Ø±ÙŠÙƒÙƒ Ø§Ù„ØºØ°Ø§Ø¦ÙŠ Ø§Ù„Ø´Ø®ØµÙŠ":"Your Personal Nutrition Partner"}</p>\n          </div>\n        </div>\n      </body>\n      </html>\n    `})())}catch(s){}try{await Fe(se.email,re?"Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ GreenoFig! ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ù†Ù…Ø§Ø°Ø¬Ùƒ":"Welcome to GreenoFig! Your forms have been received",`\n      <!DOCTYPE html>\n      <html dir="${re?"rtl":"ltr"}">\n      <head>\n        <meta charset="UTF-8">\n        <style>\n          body { font-family: Arial, sans-serif; background: #f5f5f5; margin: 0; padding: 20px; }\n          .container { max-width: 600px; margin: 0 auto; background: #fff; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }\n          .header { background: linear-gradient(135deg, #6BD55C, #4ade80); padding: 40px 30px; text-align: center; }\n          .header img { width: 70px; height: 70px; border-radius: 12px; margin-bottom: 15px; }\n          .header h1 { color: #fff; margin: 0 0 10px 0; font-size: 28px; }\n          .header p { color: rgba(255,255,255,0.9); margin: 0; font-size: 16px; }\n          .content { padding: 30px; }\n          .success-icon { width: 80px; height: 80px; background: #f0fdf4; border-radius: 50%; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; }\n          .success-icon span { font-size: 40px; }\n          h2 { color: #1f2937; text-align: center; margin: 0 0 10px 0; }\n          .subtitle { color: #6b7280; text-align: center; margin-bottom: 30px; }\n          .steps { background: #f9fafb; border-radius: 12px; padding: 20px; margin-bottom: 25px; }\n          .steps h3 { color: #6BD55C; margin: 0 0 15px 0; font-size: 16px; }\n          .step { display: flex; align-items: flex-start; margin-bottom: 12px; }\n          .step:last-child { margin-bottom: 0; }\n          .step-num { width: 24px; height: 24px; background: #6BD55C; color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600; margin-${re?"left":"right"}: 12px; flex-shrink: 0; }\n          .step-text { color: #4b5563; font-size: 14px; line-height: 1.5; }\n          .contact-box { background: #eff6ff; border: 1px solid #3b82f6; border-radius: 12px; padding: 20px; text-align: center; }\n          .contact-box h4 { color: #1d4ed8; margin: 0 0 10px 0; }\n          .contact-box p { color: #1e40af; margin: 0; font-size: 14px; }\n          .contact-box a { color: #1d4ed8; font-weight: 600; }\n          .footer { background: #f9fafb; padding: 25px; text-align: center; border-top: 1px solid #e5e7eb; }\n          .footer p { color: #6b7280; font-size: 12px; margin: 5px 0; }\n          .social-links { margin-top: 15px; }\n          .social-links a { color: #6BD55C; margin: 0 10px; text-decoration: none; font-size: 14px; }\n        </style>\n      </head>\n      <body>\n        <div class="container">\n          <div class="header">\n            <img src="https://greenofig.com/logo.png" alt="GreenoFig">\n            <h1>GreenoFig</h1>\n            <p>${re?"Ø´Ø±ÙŠÙƒÙƒ Ø§Ù„ØºØ°Ø§Ø¦ÙŠ Ø§Ù„Ø´Ø®ØµÙŠ":"Your Personal Nutrition Partner"}</p>\n          </div>\n          <div class="content">\n            <div class="success-icon"><span>âœ“</span></div>\n            <h2>${re?`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${se.fullName}!`:`Welcome ${se.fullName}!`}</h2>\n            <p class="subtitle">${re?"Ø´ÙƒØ±Ø§Ù‹ Ù„Ø¥ÙƒÙ…Ø§Ù„ Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ù‚Ø¨ÙˆÙ„ Ø§Ù„ØµØ­ÙŠØ©":"Thank you for completing your health intake forms"}</p>\n\n            <div class="steps">\n              <h3>${re?"âœ¨ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:":"âœ¨ What happens next:"}</h3>\n              <div class="step">\n                <span class="step-num">1</span>\n                <span class="step-text">${re?"Ø³ÙŠÙ‚ÙˆÙ… Ø£Ø®ØµØ§Ø¦ÙŠ Ø§Ù„ØªØºØ°ÙŠØ© Ø¨Ù…Ø±Ø§Ø¬Ø¹Ø© Ù†Ù…Ø§Ø°Ø¬Ùƒ Ø¨Ø¹Ù†Ø§ÙŠØ©":"Our nutritionist will carefully review your forms"}</span>\n              </div>\n              <div class="step">\n                <span class="step-num">2</span>\n                <span class="step-text">${re?"Ø³Ù†ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ø®Ù„Ø§Ù„ 24-48 Ø³Ø§Ø¹Ø© Ù„ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø©":"We'll contact you within 24-48 hours to schedule your consultation"}</span>\n              </div>\n              <div class="step">\n                <span class="step-num">3</span>\n                <span class="step-text">${re?"Ø³ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø®Ø·Ø© ØªØºØ°ÙŠØ© Ù…Ø®ØµØµØ© Ù„ØªØ­Ù‚ÙŠÙ‚ Ø£Ù‡Ø¯Ø§ÙÙƒ":"You'll receive a personalized nutrition plan to achieve your goals"}</span>\n              </div>\n              <div class="step">\n                <span class="step-num">4</span>\n                <span class="step-text">${re?"Ø¯Ø¹Ù… Ù…ØªÙˆØ§ØµÙ„ ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ø·ÙˆØ§Ù„ Ø±Ø­Ù„ØªÙƒ Ø§Ù„ØµØ­ÙŠØ©":"Continuous support and follow-up throughout your health journey"}</span>\n              </div>\n            </div>\n\n            <div class="contact-box">\n              <h4>${re?"ğŸ“§ Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø£Ø³Ø¦Ù„Ø©ØŸ":"ğŸ“§ Have questions?"}</h4>\n              <p>${re?"ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¹Ù„Ù‰":"Contact us at"} <a href="mailto:nutritionist@greenofig.com">nutritionist@greenofig.com</a></p>\n            </div>\n          </div>\n          <div class="footer">\n            <p><strong>GreenoFig</strong></p>\n            <p>${re?"Ù†Ø­Ù† Ù…ØªØ­Ù…Ø³ÙˆÙ† Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø±Ø­Ù„ØªÙƒ Ù†Ø­Ùˆ Ø­ÙŠØ§Ø© ØµØ­ÙŠØ© Ø£ÙØ¶Ù„!":"We're excited to help you on your journey to a healthier life!"}</p>\n            <p>Â© ${(new Date).getFullYear()} GreenoFig - greenofig.com</p>\n          </div>\n        </div>\n      </body>\n      </html>\n    `)}catch(s){}J(!0)}catch(t){U(re?"Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬":"Error submitting forms")}finally{Y(!1)}}};if(G)return e.jsxs("div",{className:"min-h-screen bg-background text-foreground flex items-center justify-center relative overflow-hidden",children:[e.jsx("div",{className:"fixed inset-0 bg-grid-pattern opacity-30 pointer-events-none"}),e.jsxs("div",{className:"text-center relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-6",children:[e.jsx("img",{src:"/logo.png",alt:"GreenoFig",className:"w-12 h-12 animate-pulse"}),e.jsx("span",{className:"text-2xl font-extrabold tracking-tight gradient-text",children:"GreenoFig"})]}),e.jsx(d,{className:"w-8 h-8 animate-spin text-primary mx-auto"}),e.jsx("p",{className:"mt-4 text-text-secondary",children:re?"Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬...":"Loading your forms..."})]})]});if(R&&!X)return e.jsxs("div",{className:"min-h-screen bg-background text-foreground flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx("div",{className:"fixed inset-0 bg-grid-pattern opacity-30 pointer-events-none"}),e.jsxs("div",{className:"max-w-md w-full glass-effect rounded-2xl shadow-2xl p-8 text-center border border-border/30 relative z-10",children:[e.jsx("div",{className:"w-20 h-20 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(c,{className:"w-10 h-10 text-red-500"})}),e.jsx("h1",{className:"text-2xl font-bold text-foreground mb-3",children:re?"Ø¹Ø°Ø±Ø§Ù‹":"Oops!"}),e.jsx("p",{className:"text-text-secondary mb-6",children:R}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("img",{src:"/logo.png",alt:"GreenoFig",className:"w-8 h-8"}),e.jsx("span",{className:"text-lg font-extrabold gradient-text",children:"GreenoFig"})]})]})]});if(X)return e.jsxs("div",{className:"min-h-screen bg-background text-foreground flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx("div",{className:"fixed inset-0 bg-grid-pattern opacity-30 pointer-events-none"}),e.jsxs("div",{className:"max-w-lg w-full glass-effect rounded-2xl shadow-2xl overflow-hidden border border-border/30 relative z-10",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary to-green-400 p-8 text-center relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 opacity-10",children:[e.jsx("div",{className:"absolute top-0 left-0 w-40 h-40 bg-white rounded-full -translate-x-1/2 -translate-y-1/2"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-60 h-60 bg-white rounded-full translate-x-1/3 translate-y-1/3"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-24 h-24 bg-white rounded-full flex items-center justify-center mx-auto mb-4 shadow-xl",children:e.jsx(m,{className:"w-14 h-14 text-primary"})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:re?"ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­!":"Successfully Submitted!"}),e.jsx("p",{className:"text-white/90",children:re?"Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ Ø¹Ù„Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬":"Thank you for completing all the forms"})]})]}),e.jsxs("div",{className:"p-8",children:[e.jsx("div",{className:"glass-effect rounded-xl p-4 mb-6 border border-border/30",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-xl",children:e.jsx(x,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground",children:re?"ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ":"Check Your Email"}),e.jsx("p",{className:"text-sm text-text-secondary",children:re?`Ø£Ø±Ø³Ù„Ù†Ø§ Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ø¥Ù„Ù‰ ${se.email}`:`We sent a confirmation to ${se.email}`})]})]})}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("h4",{className:"font-semibold text-foreground flex items-center gap-2",children:[e.jsx(u,{className:"w-4 h-4 text-primary"}),re?"Ù…Ø§Ø°Ø§ Ø¨Ø¹Ø¯ØŸ":"What's Next?"]}),e.jsx("div",{className:"space-y-2 text-sm",children:[re?"Ø³ÙŠÙ‚ÙˆÙ… ÙØ±ÙŠÙ‚Ù†Ø§ Ø¨Ù…Ø±Ø§Ø¬Ø¹Ø© Ù†Ù…Ø§Ø°Ø¬Ùƒ Ø¨Ø¹Ù†Ø§ÙŠØ©":"Our team will carefully review your forms",re?"Ø³Ù†ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù„ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø©":"We'll contact you to schedule your consultation",re?"Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ Ù†Ø­Ùˆ Ø­ÙŠØ§Ø© ØµØ­ÙŠØ© Ø£ÙØ¶Ù„ Ù…Ø¹Ù†Ø§":"Start your journey to a healthier life with us",re?"Ø³ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø®Ø·Ø© ØªØºØ°ÙŠØ© Ù…Ø®ØµØµØ© Ù„Ùƒ":"You'll receive a personalized nutrition plan",re?"Ø¯Ø¹Ù… Ù…ØªÙˆØ§ØµÙ„ Ø·ÙˆØ§Ù„ Ø±Ø­Ù„ØªÙƒ Ø§Ù„ØµØ­ÙŠØ©":"Continuous support throughout your health journey"].map((r,s)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 glass-effect rounded-xl border border-border/20",children:[e.jsx("div",{className:"w-6 h-6 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-primary text-xs font-bold",children:s+1})}),e.jsx("p",{className:"text-text-secondary",children:r})]},s))})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 pt-4 border-t border-border/30",children:[e.jsx("img",{src:"/logo.png",alt:"GreenoFig",className:"w-8 h-8"}),e.jsx("span",{className:"text-lg font-extrabold gradient-text",children:"GreenoFig"})]})]})]})]});if(!ne)return e.jsxs("div",{className:"min-h-screen bg-background text-foreground "+(re?"rtl":"ltr"),dir:re?"rtl":"ltr",children:[e.jsx("div",{className:"fixed inset-0 bg-grid-pattern opacity-30 pointer-events-none"}),e.jsx("header",{className:"sticky top-0 z-50",children:e.jsx("div",{className:"glass-effect border-b border-border/30 shadow-lg",children:e.jsx("div",{className:"max-w-3xl mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/logo.png",alt:"GreenoFig",className:"w-10 h-10"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xl font-extrabold tracking-tight gradient-text",children:"GreenoFig"}),e.jsx("p",{className:"text-xs text-text-secondary",children:re?"Ù†Ù…ÙˆØ°Ø¬ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø±ÙŠØ¶":"Patient Information Form"})]})]})})})}),e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-12 relative z-10",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-primary/10 rounded-full text-primary text-sm font-medium mb-4 border border-primary/20",children:[e.jsx(p,{className:"w-4 h-4"}),re?"Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ Ø¢Ù…Ù†Ø© ÙˆÙ…Ø­Ù…ÙŠØ©":"Your information is safe & secure"]}),e.jsx("h2",{className:"text-3xl font-bold text-foreground mb-3",children:re?"Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ!":"Welcome!"}),e.jsx("p",{className:"text-text-secondary max-w-md mx-auto",children:re?"ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© Ù„Ù„Ø¨Ø¯Ø¡ ÙÙŠ Ø¥ÙƒÙ…Ø§Ù„ Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ù‚Ø¨ÙˆÙ„ Ø§Ù„ØµØ­ÙŠØ©":"Please fill in your personal information to start completing your health intake forms"})]}),e.jsxs("div",{className:"glass-effect rounded-2xl shadow-xl border border-border/30 p-8 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8 pb-6 border-b border-border/30",children:[e.jsx("div",{className:"p-3 rounded-xl bg-primary/10",children:e.jsx(h,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-foreground",children:re?"Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©":"Your Personal Information"}),e.jsx("p",{className:"text-sm text-text-secondary",children:re?"Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ù…Ø·Ù„ÙˆØ¨Ø©":"All fields are required"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-1.5",children:[re?"Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„":"Full Name"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(i,{value:se.fullName,onChange:e=>te({...se,fullName:e.target.value}),placeholder:re?"Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„":"Enter your full name",className:"w-full bg-background border border-border rounded-md py-2 px-3 focus:outline-none focus:ring-primary focus:border-primary "+(ye.fullName?"border-red-500":"")}),ye.fullName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:re?"Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨":"This field is required"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-1.5",children:[re?"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ":"Email Address"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(i,{type:"email",value:se.email,onChange:e=>te({...se,email:e.target.value}),placeholder:re?"Ø£Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ":"Enter your email",className:"w-full bg-background border border-border rounded-md py-2 px-3 focus:outline-none focus:ring-primary focus:border-primary "+(ye.email?"border-red-500":"")}),ye.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:re?"Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­":"Invalid email address"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-1.5",children:[re?"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ":"Phone Number"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(i,{type:"tel",value:se.phone,onChange:e=>te({...se,phone:e.target.value}),placeholder:re?"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ":"Phone",className:"w-full bg-background border border-border rounded-md py-2 px-3 focus:outline-none focus:ring-primary focus:border-primary "+(ye.phone?"border-red-500":"")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-1.5",children:[re?"ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯":"Date of Birth"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-3 items-end",children:[e.jsx("div",{className:"flex-1",children:e.jsx(i,{type:"date",value:se.birthDate,onChange:ae,max:(new Date).toISOString().split("T")[0],className:"w-full bg-background border border-border rounded-md py-2 px-3 focus:outline-none focus:ring-primary focus:border-primary "+(ye.birthDate?"border-red-500":"")})}),se.age&&e.jsx("div",{className:"px-4 py-2 bg-primary/10 border border-primary/30 rounded-md text-primary font-medium whitespace-nowrap",children:re?`${se.age} Ø³Ù†Ø©`:`${se.age} years`})]}),ye.birthDate&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:re?"Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨":"This field is required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-1.5",children:re?"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†":"Address"}),e.jsx(i,{value:se.address,onChange:e=>te({...se,address:e.target.value}),placeholder:re?"Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù†Ùƒ":"Enter your address",className:"w-full bg-background border border-border rounded-md py-2 px-3 focus:outline-none focus:ring-primary focus:border-primary"})]})]})]}),e.jsxs("div",{className:"glass-effect rounded-xl p-6 mb-8 border border-border/30",children:[e.jsxs("h4",{className:"font-semibold text-foreground mb-4 flex items-center gap-2",children:[e.jsx(b,{className:"w-5 h-5 text-primary"}),re?"Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„ØªÙŠ Ø³ØªÙ‚ÙˆÙ… Ø¨ØªØ¹Ø¨Ø¦ØªÙ‡Ø§:":"Forms you will complete:"]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["Exercise History","Health History","Medical History","Client Intake"].map((r,s)=>e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-primary/5 rounded-xl border border-primary/10",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-lg flex items-center justify-center",children:F(s)}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:r})]},s))})]}),e.jsxs(l,{onClick:Se,className:"w-full h-14 text-lg font-semibold bg-primary hover:bg-primary/90 text-primary-foreground rounded-xl shadow-lg",children:[re?"Ù…ØªØ§Ø¨Ø¹Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬":"Continue to Forms",re?e.jsx(f,{className:"w-5 h-5 mr-2"}):e.jsx(g,{className:"w-5 h-5 ml-2"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6 text-sm text-text-secondary",children:[e.jsx(y,{className:"w-4 h-4"}),re?"Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ Ù…Ø´ÙØ±Ø© ÙˆØ¢Ù…Ù†Ø©":"Your information is encrypted and secure"]})]})]});const Te=M[le],Ie=null==(o=null==Te?void 0:Te.sections)?void 0:o[de],ze=M.reduce((e,r)=>{var s;return e+((null==(s=r.sections)?void 0:s.length)||0)},0),Ae=ue.reduce((e,r)=>{var s,t;return e+((null==(t=null==(s=M[r])?void 0:s.sections)?void 0:t.length)||0)},0)+de,Ge=le===M.length-1&&de===((null==(N=null==Te?void 0:Te.sections)?void 0:N.length)||1)-1,Pe=0===le&&0===de;if(he&&fe){const r=fe,s=r.isLastSectionOfForm&&r.isLastForm;return e.jsxs("div",{className:"min-h-screen bg-background text-foreground "+(re?"rtl":"ltr"),dir:re?"rtl":"ltr",children:[e.jsx("div",{className:"fixed inset-0 bg-grid-pattern opacity-30 pointer-events-none"}),e.jsx("header",{className:"sticky top-0 z-50",children:e.jsx("div",{className:"glass-effect border-b border-border/30 shadow-lg",children:e.jsx("div",{className:"max-w-3xl mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/logo.png",alt:"GreenoFig",className:"w-8 h-8"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-lg font-extrabold tracking-tight gradient-text",children:"GreenoFig"}),e.jsx("p",{className:"text-xs text-text-secondary",children:se.fullName})]})]})})})}),e.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-6 relative z-10",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 bg-primary/10 rounded-full mb-3",children:e.jsx(m,{className:"w-7 h-7 text-primary"})}),e.jsx("h2",{className:"text-xl font-bold text-foreground mb-1",children:re?"Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¥Ø¬Ø§Ø¨Ø§ØªÙƒ":"Review Your Answers"}),e.jsx("p",{className:"text-sm text-text-secondary",children:re?`${r.sectionTitleAr||r.sectionTitle}`:`${r.sectionTitle}`})]}),e.jsxs("div",{className:"glass-effect rounded-2xl border border-border/30 overflow-hidden mb-6",children:[e.jsx("div",{className:"p-4 bg-primary/5 border-b border-border/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:F(r.sectionIndex)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground",children:re&&r.sectionTitleAr||r.sectionTitle}),e.jsx("p",{className:"text-xs text-text-secondary",children:re&&r.formNameAr||r.formName})]})]})}),e.jsx("div",{className:"p-4 space-y-2",children:null==(w=r.questions)?void 0:w.map((r,s)=>{const t=me[r.id];if("signature"===r.type)return e.jsxs("div",{className:"flex justify-between items-center py-2 px-3 rounded-lg bg-green-500/10 border-b border-border/10 last:border-0",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:re&&r.label_ar||r.label}),e.jsxs("span",{className:"text-sm font-medium text-green-600 flex items-center gap-1",children:[e.jsx(m,{className:"w-4 h-4"}),t?re?"ØªÙ… Ø§Ù„ØªÙˆÙ‚ÙŠØ¹":"Signed":re?"Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙˆÙ‚ÙŠØ¹":"Not signed"]})]},s);const a=!0===t?re?"Ù†Ø¹Ù…":"Yes":!1===t?re?"Ù„Ø§":"No":Array.isArray(t)?t.join(", "):t||"â€”",n=!0===t?"bg-green-500/10":!1===t?"bg-red-500/10":"bg-muted/30";return e.jsxs("div",{className:`flex justify-between items-start py-2 px-3 rounded-lg ${n}`,children:[e.jsx("span",{className:"text-sm text-text-secondary flex-1 pr-3",children:re&&r.label_ar||r.label}),e.jsx("span",{className:"text-sm font-medium text-right max-w-[50%] break-words "+(!0===t?"text-green-600":!1===t?"text-red-500":"text-foreground"),children:a})]},s)})})]}),e.jsx("div",{className:"glass-effect rounded-xl border border-border/20 p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:re?"Ø§Ù„ØªÙ‚Ø¯Ù…:":"Progress:"}),e.jsx("span",{className:"font-medium text-primary",children:re?`Ø§Ù„Ù‚Ø³Ù… ${r.sectionIndex+1} Ù…Ù† ${(null==(k=null==(_=M[r.formIndex])?void 0:_.sections)?void 0:k.length)||1}`:`Section ${r.sectionIndex+1} of ${(null==(S=null==(q=M[r.formIndex])?void 0:q.sections)?void 0:S.length)||1}`})]})}),e.jsx("div",{className:"flex justify-center",children:s?e.jsxs(l,{onClick:De,disabled:E,className:"px-8 h-14 text-lg font-semibold bg-primary hover:bg-primary/90 text-primary-foreground rounded-xl shadow-lg",children:[E?e.jsx(d,{className:"w-5 h-5 animate-spin mr-2"}):e.jsx(v,{className:"w-5 h-5 mr-2"}),re?"Ø¥Ø±Ø³Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬":"Submit All Forms"]}):e.jsxs(l,{onClick:$e,className:"px-8 h-12 text-base font-semibold bg-primary hover:bg-primary/90 text-primary-foreground rounded-xl shadow-lg",children:[r.isLastSectionOfForm?re?"Ù…ØªØ§Ø¨Ø¹Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ§Ù„ÙŠ":"Continue to Next Form":re?"Ù…ØªØ§Ø¨Ø¹Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„ØªØ§Ù„ÙŠ":"Continue to Next Section",re?e.jsx(f,{className:"w-5 h-5 mr-2"}):e.jsx(g,{className:"w-5 h-5 ml-2"})]})})]})]})}return e.jsxs("div",{className:"min-h-screen bg-background text-foreground "+(re?"rtl":"ltr"),dir:re?"rtl":"ltr",children:[e.jsx("div",{className:"fixed inset-0 bg-grid-pattern opacity-30 pointer-events-none"}),e.jsx("header",{className:"sticky top-0 z-50",children:e.jsx("div",{className:"glass-effect border-b border-border/30 shadow-lg",children:e.jsx("div",{className:"max-w-3xl mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/logo.png",alt:"GreenoFig",className:"w-8 h-8"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-lg font-extrabold tracking-tight gradient-text",children:"GreenoFig"}),e.jsx("p",{className:"text-xs text-text-secondary",children:se.fullName})]})]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:Ce,disabled:H,className:"text-xs border-primary/30 text-primary hover:bg-primary/10",children:[H?e.jsx(d,{className:"w-3 h-3 animate-spin mr-1"}):e.jsx(j,{className:"w-3 h-3 mr-1"}),re?"Ø­ÙØ¸":"Save Draft"]})]})})})}),e.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-6 relative z-10",children:[e.jsx("div",{className:"flex gap-2 mb-6 overflow-x-auto pb-2",children:M.map((r,s)=>{var t;const a=ue.includes(s),n=s===le;return e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 rounded-xl whitespace-nowrap transition-all border "+(a?"bg-primary/10 text-primary border-primary/30":n?"bg-primary text-primary-foreground border-primary shadow-lg":"bg-card/50 text-text-secondary border-border/30"),children:[a?e.jsx(m,{className:"w-4 h-4"}):e.jsx("span",{className:"w-5 h-5 rounded-full bg-current/20 flex items-center justify-center text-xs font-bold",children:s+1}),e.jsx("span",{className:"text-sm font-medium",children:re&&(null==(t=r.name_ar)?void 0:t.split(" ")[0])||r.name.split(" ")[0]})]},s)})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"font-medium text-foreground",children:re&&(null==Te?void 0:Te.name_ar)||(null==Te?void 0:Te.name)}),e.jsxs("span",{className:"text-primary font-semibold",children:[Math.round(Ae/ze*100),"%"]})]}),e.jsx("div",{className:"w-full bg-card/50 rounded-full h-2.5 overflow-hidden border border-border/30",children:e.jsx("div",{className:"bg-gradient-to-r from-primary to-green-400 h-2.5 rounded-full transition-all duration-500",style:{width:Ae/ze*100+"%"}})}),e.jsx("p",{className:"text-xs text-text-secondary mt-2",children:re?`Ø§Ù„Ù‚Ø³Ù… ${de+1} Ù…Ù† ${(null==($=null==Te?void 0:Te.sections)?void 0:$.length)||1}`:`Section ${de+1} of ${(null==(T=null==Te?void 0:Te.sections)?void 0:T.length)||1}`})]}),e.jsxs("div",{className:"glass-effect rounded-2xl shadow-xl border border-border/30 p-6 sm:p-8 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-5 border-b border-border/30",children:[e.jsx("div",{className:"p-3 rounded-xl bg-primary/10",children:F(de)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-foreground",children:re&&(null==Ie?void 0:Ie.title_ar)||(null==Ie?void 0:Ie.title)}),(null==Ie?void 0:Ie.description)&&e.jsx("p",{className:"text-sm text-text-secondary mt-1",children:re&&(null==Ie?void 0:Ie.description_ar)||(null==Ie?void 0:Ie.description)})]})]}),e.jsx("div",{className:"space-y-5",children:null==(I=null==Ie?void 0:Ie.questions)?void 0:I.map(r=>e.jsxs("div",{className:ye[r.id]?"ring-2 ring-red-500/30 rounded-xl p-4 -m-2 bg-red-500/5":"",children:[e.jsx(C,{question:r,value:me[r.id],onChange:ke,language:ee}),ye[r.id]&&e.jsxs("p",{className:"text-red-500 text-xs mt-2 flex items-center gap-1",children:[e.jsx(c,{className:"w-3 h-3"}),re?"Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨":"This field is required"]})]},r.id))})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs(l,{variant:"outline",onClick:()=>{if(de>0)ce(e=>e-1);else if(le>0){oe(e=>e-1);const e=M[le-1];ce(e.sections.length-1)}},disabled:Pe,className:"flex items-center gap-2 border-border/50 text-foreground hover:bg-card/50 rounded-xl px-6 h-12",children:[re?e.jsx(g,{className:"w-5 h-5"}):e.jsx(f,{className:"w-5 h-5"}),re?"Ø§Ù„Ø³Ø§Ø¨Ù‚":"Previous"]}),Ge?e.jsxs(l,{onClick:De,disabled:E,className:"flex items-center gap-2 bg-primary hover:bg-primary/90 text-primary-foreground shadow-lg rounded-xl px-8 h-12 text-base font-semibold",children:[E?e.jsx(d,{className:"w-5 h-5 animate-spin"}):e.jsx(v,{className:"w-5 h-5"}),re?"Ø¥Ø±Ø³Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬":"Submit All Forms"]}):e.jsxs(l,{onClick:()=>{var e;if(qe()){const r=M[le],s=null==(e=null==r?void 0:r.sections)?void 0:e[de];s&&(ge({formIndex:le,sectionIndex:de,formName:r.name,formNameAr:r.name_ar,sectionTitle:s.title,sectionTitleAr:s.title_ar,questions:s.questions,isLastSectionOfForm:de>=r.sections.length-1,isLastForm:le>=M.length-1}),be(!0)),Ce()}},className:"flex items-center gap-2 bg-primary hover:bg-primary/90 text-primary-foreground shadow-lg rounded-xl px-6 h-12",children:[re?"Ø§Ù„ØªØ§Ù„ÙŠ":"Next",re?e.jsx(f,{className:"w-5 h-5"}):e.jsx(g,{className:"w-5 h-5"})]})]}),H&&e.jsxs("div",{className:"fixed bottom-4 right-4 flex items-center gap-2 glass-effect px-4 py-2 rounded-full shadow-lg text-sm text-primary border border-primary/20",children:[e.jsx(d,{className:"w-4 h-4 animate-spin"}),re?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...":"Saving..."]})]})]})}export{T as default};
