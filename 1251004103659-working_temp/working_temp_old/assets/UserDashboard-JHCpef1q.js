import{j as e}from"./vendor-ui-CAdTc8ma.js";import{a as s}from"./vendor-react-DYWoKpfz.js";import{u as t,B as a,L as r,I as i,s as l,t as n,T as d,H as o}from"./index-nShX8awQ.js";import{C as c,a as m,b as u,c as h}from"./card-C7hgc_SI.js";import{D as x,a as g,b as p,c as j,d as f}from"./dialog-7ALlfJO-.js";import{z as y,D as v,au as _,av as w,ad as N,aw as b,J as k,ax as S,w as C,ay as F,t as q,Z as D,N as P,az as I,aa as M,aA as L,m as T,x as $,aB as A,aC as W,u as E,T as G,P as B}from"./vendor-utils-7_dm-8Ld.js";import{Q as O}from"./QuickLogMeal-BgWpElps.js";import{S as Y,a as z,b as H,c as R,d as V}from"./select-DE_tMXKr.js";import{T as U,a as K,b as Q,c as J}from"./tabs-BS8_RaWa.js";import"./vendor-editor-CURn2XBo.js";const Z=({onSuccess:d})=>{const{userProfile:o}=t(),[c,m]=s.useState(!1),[u,h]=s.useState(!1),[v,_]=s.useState({weight_kg:o?.weight_kg||"",body_fat_percentage:"",date:(new Date).toISOString().split("T")[0]});return e.jsxs(x,{open:c,onOpenChange:m,children:[e.jsx(g,{asChild:!0,children:e.jsxs(a,{className:"w-full h-12 min-h-[44px] text-sm sm:text-base",children:[e.jsx(y,{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2"}),e.jsx("span",{className:"truncate",children:"Log Weight"})]})}),e.jsxs(p,{className:"glass-effect custom-scrollbar sm:max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsx(j,{children:e.jsx(f,{children:"Log Your Weight"})}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),h(!0);try{const e=v.date,{data:s}=await l.from("daily_metrics").select("*").eq("user_id",o.id).eq("date",e).single();if(s){const{error:e}=await l.from("daily_metrics").update({weight_kg:parseFloat(v.weight_kg),body_fat_percentage:v.body_fat_percentage?parseFloat(v.body_fat_percentage):null}).eq("id",s.id);if(e)throw e}else{const{error:s}=await l.from("daily_metrics").insert({user_id:o.id,date:e,weight_kg:parseFloat(v.weight_kg),body_fat_percentage:v.body_fat_percentage?parseFloat(v.body_fat_percentage):null});if(s)throw s}await l.from("user_profiles").update({weight_kg:parseFloat(v.weight_kg)}).eq("id",o.id),await l.from("activity_feed").insert({user_id:o.id,activity_type:"weight_update",activity_title:"Weight Updated",activity_description:`Logged weight: ${v.weight_kg} kg`,metadata:{weight_kg:parseFloat(v.weight_kg)}}),await l.rpc("update_user_streak",{p_user_id:o.id,p_streak_type:"weight_log",p_activity_date:e}),n({title:"Weight Logged!",description:`Successfully logged ${v.weight_kg} kg`}),m(!1),d&&d()}catch(s){console.error("Error logging weight:",s),n({title:"Error",description:"Failed to log weight. Please try again.",variant:"destructive"})}finally{h(!1)}},className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx(r,{htmlFor:"date",className:"text-sm sm:text-base",children:"Date"}),e.jsx(i,{id:"date",type:"date",value:v.date,onChange:e=>_({...v,date:e.target.value}),max:(new Date).toISOString().split("T")[0],required:!0,className:"mt-1.5 w-full min-w-0"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"weight",className:"text-sm sm:text-base",children:"Weight (kg) *"}),e.jsx(i,{id:"weight",type:"number",step:"0.1",placeholder:"70.5",value:v.weight_kg,onChange:e=>_({...v,weight_kg:e.target.value}),required:!0,className:"mt-1.5"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"body_fat",className:"text-sm sm:text-base",children:"Body Fat % (optional)"}),e.jsx(i,{id:"body_fat",type:"number",step:"0.1",placeholder:"18.5",value:v.body_fat_percentage,onChange:e=>_({...v,body_fat_percentage:e.target.value}),className:"mt-1.5"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 pt-2",children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>m(!1),className:"flex-1 h-12 min-h-[44px] text-sm sm:text-base",children:"Cancel"}),e.jsx(a,{type:"submit",disabled:u,className:"flex-1 h-12 min-h-[44px] text-sm sm:text-base",children:u?"Logging...":"Log Weight"})]})]})]})]})},X=({onSuccess:o})=>{const{userProfile:c}=t(),[m,u]=s.useState(!1),[h,y]=s.useState(!1),[_,w]=s.useState({workout_name:"",workout_type:"cardio",duration_minutes:"",calories_burned:"",intensity:"moderate",notes:"",feeling:"good",date:(new Date).toISOString().split("T")[0]});return e.jsxs(x,{open:m,onOpenChange:u,children:[e.jsx(g,{asChild:!0,children:e.jsxs(a,{className:"w-full",children:[e.jsx(v,{className:"w-10 h-10 mr-2",strokeWidth:3}),"Log Workout"]})}),e.jsxs(p,{className:"glass-effect custom-scrollbar sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx(j,{children:e.jsx(f,{children:"Log Your Workout"})}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),y(!0);try{const e={user_id:c.id,workout_name:_.workout_name,workout_type:_.workout_type,duration_minutes:parseInt(_.duration_minutes),calories_burned:_.calories_burned?parseInt(_.calories_burned):null,intensity:_.intensity,notes:_.notes,feeling:_.feeling,date:_.date},{error:s}=await l.from("workout_logs").insert(e);if(s)throw s;const{data:t}=await l.from("daily_metrics").select("*").eq("user_id",c.id).eq("date",_.date).single(),a=(t?.calories_burned||0)+(_.calories_burned?parseInt(_.calories_burned):0),r=(t?.active_minutes||0)+parseInt(_.duration_minutes);t?await l.from("daily_metrics").update({calories_burned:a,active_minutes:r}).eq("id",t.id):await l.from("daily_metrics").insert({user_id:c.id,date:_.date,calories_burned:a,active_minutes:r}),await l.from("activity_feed").insert({user_id:c.id,activity_type:"completed_workout",activity_title:"Completed Workout",activity_description:_.workout_name,metadata:{duration:parseInt(_.duration_minutes),calories:_.calories_burned?parseInt(_.calories_burned):0}}),await l.rpc("update_user_streak",{p_user_id:c.id,p_streak_type:"workout",p_activity_date:_.date}),n({title:"Workout Logged!",description:`Great job completing ${_.workout_name}!`}),w({workout_name:"",workout_type:"cardio",duration_minutes:"",calories_burned:"",intensity:"moderate",notes:"",feeling:"good",date:(new Date).toISOString().split("T")[0]}),u(!1),o&&o()}catch(s){console.error("Error logging workout:",s),n({title:"Error",description:"Failed to log workout. Please try again.",variant:"destructive"})}finally{y(!1)}},className:"space-y-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx(r,{htmlFor:"date",children:"Date"}),e.jsx(i,{id:"date",type:"date",value:_.date,onChange:e=>w({..._,date:e.target.value}),max:(new Date).toISOString().split("T")[0],required:!0,className:"w-full min-w-0"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"workout_name",children:"Workout Name *"}),e.jsx(i,{id:"workout_name",placeholder:"e.g., Morning Run",value:_.workout_name,onChange:e=>w({..._,workout_name:e.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"workout_type",children:"Workout Type *"}),e.jsxs(Y,{value:_.workout_type,onValueChange:e=>w({..._,workout_type:e}),children:[e.jsx(z,{children:e.jsx(H,{})}),e.jsxs(R,{children:[e.jsx(V,{value:"cardio",children:"Cardio"}),e.jsx(V,{value:"strength",children:"Strength Training"}),e.jsx(V,{value:"yoga",children:"Yoga"}),e.jsx(V,{value:"sports",children:"Sports"}),e.jsx(V,{value:"hiit",children:"HIIT"}),e.jsx(V,{value:"pilates",children:"Pilates"}),e.jsx(V,{value:"swimming",children:"Swimming"}),e.jsx(V,{value:"cycling",children:"Cycling"}),e.jsx(V,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"duration",children:"Duration (minutes) *"}),e.jsx(i,{id:"duration",type:"number",placeholder:"30",value:_.duration_minutes,onChange:e=>w({..._,duration_minutes:e.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"calories",children:"Calories Burned"}),e.jsx(i,{id:"calories",type:"number",placeholder:"300",value:_.calories_burned,onChange:e=>w({..._,calories_burned:e.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"intensity",children:"Intensity *"}),e.jsxs(Y,{value:_.intensity,onValueChange:e=>w({..._,intensity:e}),children:[e.jsx(z,{children:e.jsx(H,{})}),e.jsxs(R,{children:[e.jsx(V,{value:"light",children:"Light"}),e.jsx(V,{value:"moderate",children:"Moderate"}),e.jsx(V,{value:"intense",children:"Intense"})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"feeling",children:"How did you feel?"}),e.jsxs(Y,{value:_.feeling,onValueChange:e=>w({..._,feeling:e}),children:[e.jsx(z,{children:e.jsx(H,{})}),e.jsxs(R,{children:[e.jsx(V,{value:"exhausted",children:"Exhausted"}),e.jsx(V,{value:"tired",children:"Tired"}),e.jsx(V,{value:"good",children:"Good"}),e.jsx(V,{value:"energized",children:"Energized"})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"notes",children:"Notes (optional)"}),e.jsx(d,{id:"notes",placeholder:"How was your workout?",value:_.notes,onChange:e=>w({..._,notes:e.target.value}),rows:2})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>u(!1),className:"flex-1",children:"Cancel"}),e.jsx(a,{type:"submit",disabled:h,className:"flex-1",children:h?"Logging...":"Log Workout"})]})]})]})]})},ee=({onSuccess:r})=>{const{userProfile:i}=t(),[d,o]=s.useState(0),[x,g]=s.useState(!1),p=250;s.useEffect(()=>{i?.id&&j()},[i?.id]);const j=async()=>{try{const e=(new Date).toISOString().split("T")[0],{data:s}=await l.from("daily_metrics").select("water_ml").eq("user_id",i.id).eq("date",e).single();s&&o(s.water_ml||0)}catch(e){}},f=async e=>{g(!0);try{const s=Math.max(0,d+e),t=(new Date).toISOString().split("T")[0],{data:a}=await l.from("daily_metrics").select("*").eq("user_id",i.id).eq("date",t).single();a?await l.from("daily_metrics").update({water_ml:s}).eq("id",a.id):await l.from("daily_metrics").insert({user_id:i.id,date:t,water_ml:s}),o(s),e>0&&(await l.from("activity_feed").insert({user_id:i.id,activity_type:"water_intake",activity_title:"Water Logged",activity_description:`Added ${e}ml of water`,metadata:{water_ml:e}}),await l.rpc("update_user_streak",{p_user_id:i.id,p_streak_type:"water_intake",p_activity_date:t})),r&&r()}catch(s){console.error("Error updating water:",s),n({title:"Error",description:"Failed to update water intake.",variant:"destructive"})}finally{g(!1)}},y=Math.min(d/2e3*100,100),v=Math.floor(d/p);return e.jsxs(c,{className:"glass-effect h-full",children:[e.jsx(m,{className:"pb-2",children:e.jsxs(u,{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5 text-blue-500"}),"Water Intake"]})}),e.jsxs(h,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-500",children:[d,"ml"]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["/ ",2e3,"ml"]}),e.jsxs("div",{className:"text-xs text-muted-foreground ml-auto",children:[v," glasses"]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-3",children:e.jsx("div",{className:"bg-blue-500 h-3 rounded-full transition-all duration-300 flex items-center justify-end pr-2",style:{width:`${y}%`},children:y>15&&e.jsxs("span",{className:"text-[10px] font-semibold text-white",children:[Math.round(y),"%"]})})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[e.jsxs(a,{variant:"outline",size:"sm",onClick:()=>f(-250),disabled:x||0===d,children:[e.jsx(w,{className:"w-4 h-4 mr-1"}),"Remove"]}),e.jsxs(a,{size:"sm",onClick:()=>f(p),disabled:x,className:"bg-blue-500 hover:bg-blue-600",children:[e.jsx(N,{className:"w-4 h-4 mr-1"}),"Add Glass"]})]}),e.jsxs("div",{className:"text-xs text-center text-muted-foreground pt-1",children:["1 glass = ",p,"ml"]})]})]})},se=({onSuccess:d})=>{const{userProfile:o}=t(),[c,m]=s.useState(!1),[u,h]=s.useState(!1),[y,v]=s.useState({sleep_hours:"",sleep_quality:"good",date:new Date(Date.now()-864e5).toISOString().split("T")[0]});return e.jsxs(x,{open:c,onOpenChange:m,children:[e.jsx(g,{asChild:!0,children:e.jsxs(a,{className:"w-full",children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Log Sleep"]})}),e.jsxs(p,{className:"glass-effect custom-scrollbar sm:max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsx(j,{children:e.jsx(f,{children:"Log Your Sleep"})}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),h(!0);try{const{data:e}=await l.from("daily_metrics").select("*").eq("user_id",o.id).eq("date",y.date).single();e?await l.from("daily_metrics").update({sleep_hours:parseFloat(y.sleep_hours),sleep_quality:y.sleep_quality}).eq("id",e.id):await l.from("daily_metrics").insert({user_id:o.id,date:y.date,sleep_hours:parseFloat(y.sleep_hours),sleep_quality:y.sleep_quality}),await l.from("activity_feed").insert({user_id:o.id,activity_type:"sleep_log",activity_title:"Sleep Logged",activity_description:`${y.sleep_hours}h of ${y.sleep_quality} sleep`,metadata:{hours:parseFloat(y.sleep_hours),quality:y.sleep_quality}}),n({title:"Sleep Logged!",description:`Logged ${y.sleep_hours} hours of sleep`}),v({sleep_hours:"",sleep_quality:"good",date:new Date(Date.now()-864e5).toISOString().split("T")[0]}),m(!1),d&&d()}catch(s){console.error("Error logging sleep:",s),n({title:"Error",description:"Failed to log sleep. Please try again.",variant:"destructive"})}finally{h(!1)}},className:"space-y-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx(r,{htmlFor:"date",children:"Night of"}),e.jsx(i,{id:"date",type:"date",value:y.date,onChange:e=>v({...y,date:e.target.value}),max:(new Date).toISOString().split("T")[0],required:!0,className:"w-full min-w-0"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select the night you went to bed"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"sleep_hours",children:"Hours of Sleep *"}),e.jsx(i,{id:"sleep_hours",type:"number",step:"0.5",placeholder:"7.5",value:y.sleep_hours,onChange:e=>v({...y,sleep_hours:e.target.value}),min:"0",max:"24",required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"sleep_quality",children:"Sleep Quality"}),e.jsxs(Y,{value:y.sleep_quality,onValueChange:e=>v({...y,sleep_quality:e}),children:[e.jsx(z,{children:e.jsx(H,{})}),e.jsxs(R,{children:[e.jsx(V,{value:"poor",children:"Poor ðŸ˜´"}),e.jsx(V,{value:"fair",children:"Fair ðŸ˜"}),e.jsx(V,{value:"good",children:"Good ðŸ˜Š"}),e.jsx(V,{value:"excellent",children:"Excellent ðŸŒŸ"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>m(!1),className:"flex-1",children:"Cancel"}),e.jsx(a,{type:"submit",disabled:u,className:"flex-1",children:u?"Logging...":"Log Sleep"})]})]})]})]})},te=()=>{const{userProfile:a}=t(),[r,i]=s.useState([]),[n,d]=s.useState([]),[o,x]=s.useState([]),[g,p]=s.useState(!0),[j,f]=s.useState("7");s.useEffect(()=>{a?.id&&y()},[a?.id,j]);const y=async()=>{try{const e=new Date;e.setDate(e.getDate()-parseInt(j));const s=e.toISOString().split("T")[0],{data:t}=await l.from("daily_metrics").select("*").eq("user_id",a.id).gte("date",s).order("date",{ascending:!0});t&&(i(t.filter(e=>e.weight_kg).map(e=>({date:e.date,value:e.weight_kg}))),d(t.map(e=>({date:e.date,burned:e.calories_burned||0,consumed:e.calories_consumed||0}))),x(t.filter(e=>e.sleep_hours).map(e=>({date:e.date,value:e.sleep_hours,quality:e.sleep_quality})))),p(!1)}catch(e){console.error("Error fetching progress data:",e),p(!1)}},v=(s,t,a="",r="primary")=>{if(0===s.length)return e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsx("p",{children:"No data yet for the selected period"})});const i=Math.max(...s.map(e=>e.value||0)),l=Math.min(...s.map(e=>e.value||0)),n=i-l,d=(e=>{if(e.length<2)return{trend:"neutral",percent:0};const s=e.slice(-Math.min(3,e.length)),t=e.slice(0,Math.min(3,e.length)),a=s.reduce((e,s)=>e+s.value,0)/s.length,r=t.reduce((e,s)=>e+s.value,0)/t.length,i=(a-r)/r*100;return{trend:i>2?"up":i<-2?"down":"neutral",percent:Math.abs(i).toFixed(1)}})(s);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-3xl font-bold",children:[s[s.length-1]?.value?.toFixed(1)||"N/A",s[s.length-1]?.value&&a]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Latest ",t]})]}),e.jsxs("div",{className:"flex items-center gap-2 "+("up"===d.trend?"text-green-500":"down"===d.trend?"text-red-500":"text-muted-foreground"),children:["up"===d.trend&&e.jsx(k,{className:"w-5 h-5"}),"down"===d.trend&&e.jsx(S,{className:"w-5 h-5"}),"neutral"===d.trend&&e.jsx(w,{className:"w-5 h-5"}),e.jsxs("span",{className:"text-sm font-semibold",children:[d.percent,"%"]})]})]}),e.jsx("div",{className:"space-y-2",children:s.map((s,t)=>{const r=n>0?(s.value-l)/n*100:50;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-xs text-muted-foreground w-20",children:new Date(s.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsxs("div",{className:"flex-1 h-8 bg-muted rounded-full overflow-hidden relative",children:[e.jsx("div",{className:"h-full bg-gradient-to-r from-primary to-green-400 rounded-full transition-all duration-300",style:{width:`${Math.max(r,5)}%`}}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-end pr-3",children:e.jsxs("span",{className:"text-xs font-medium",children:[s.value?.toFixed(1),a]})})]})]},t)})}),s.length>1&&e.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-sm font-semibold",children:[i.toFixed(1),a]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Highest"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-sm font-semibold",children:[(s.reduce((e,s)=>e+s.value,0)/s.length).toFixed(1),a]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Average"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-sm font-semibold",children:[l.toFixed(1),a]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Lowest"})]})]})]})};return g?e.jsx(c,{className:"glass-effect",children:e.jsx(h,{className:"p-8 text-center text-muted-foreground",children:"Loading progress data..."})}):e.jsxs(c,{className:"glass-effect",children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{className:"text-xl font-bold",children:"Progress Tracking"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f("7"),className:"px-3 py-1 rounded text-sm "+("7"===j?"bg-primary text-primary-foreground":"bg-muted"),children:"7D"}),e.jsx("button",{onClick:()=>f("30"),className:"px-3 py-1 rounded text-sm "+("30"===j?"bg-primary text-primary-foreground":"bg-muted"),children:"30D"}),e.jsx("button",{onClick:()=>f("90"),className:"px-3 py-1 rounded text-sm "+("90"===j?"bg-primary text-primary-foreground":"bg-muted"),children:"90D"})]})]})}),e.jsx(h,{children:e.jsxs(U,{defaultValue:"weight",children:[e.jsxs(K,{className:"grid w-full grid-cols-3",children:[e.jsx(Q,{value:"weight",children:"Weight"}),e.jsx(Q,{value:"calories",children:"Calories"}),e.jsx(Q,{value:"sleep",children:"Sleep"})]}),e.jsx(J,{value:"weight",className:"mt-6",children:v(r,"weight"," kg")}),e.jsx(J,{value:"calories",className:"mt-6",children:0===n.length?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsx("p",{children:"No calorie data yet for the selected period"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-500",children:Math.round(n.reduce((e,s)=>e+s.consumed,0)/n.length)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Consumed"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-500",children:Math.round(n.reduce((e,s)=>e+s.burned,0)/n.length)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Burned"})]})]}),e.jsx("div",{className:"space-y-2",children:n.map((s,t)=>{const a=Math.max(s.consumed,s.burned,2e3);return e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(s.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs",children:"Consumed"}),e.jsx("span",{className:"text-xs font-semibold",children:s.consumed})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-red-500 rounded-full",style:{width:s.consumed/a*100+"%"}})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs",children:"Burned"}),e.jsx("span",{className:"text-xs font-semibold",children:s.burned})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:s.burned/a*100+"%"}})})]})]})]},t)})})]})}),e.jsx(J,{value:"sleep",className:"mt-6",children:v(o,"sleep"," hrs")})]})})]})},ae=({onSuccess:d})=>{const{userProfile:o}=t(),[c,m]=s.useState(!1),[u,h]=s.useState(!1),[y,v]=s.useState(1),[_,w]=s.useState({plan_type:"daily",target_calories:"",dietary_preferences:"",meals_per_day:"3",allergies:"",cuisine_preference:"",cooking_time:"moderate"}),[N,b]=s.useState(null);return e.jsxs(x,{open:c,onOpenChange:m,children:[e.jsx(g,{asChild:!0,children:e.jsxs(a,{className:"w-full",size:"lg",children:[e.jsx(C,{className:"w-5 h-5 mr-2"}),"Generate AI Meal Plan"]})}),e.jsxs(p,{className:"glass-effect custom-scrollbar max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(j,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-6 h-6 text-primary"}),"AI Meal Plan Generator"]})}),1===y?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"plan_type",children:"Plan Type"}),e.jsxs(Y,{value:_.plan_type,onValueChange:e=>w({..._,plan_type:e}),children:[e.jsx(z,{children:e.jsx(H,{})}),e.jsxs(R,{children:[e.jsx(V,{value:"daily",children:"Daily Plan"}),e.jsx(V,{value:"weekly",children:"Weekly Plan"})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"target_calories",children:"Target Calories"}),e.jsx(i,{id:"target_calories",type:"number",placeholder:o?.target_calories||"2000",value:_.target_calories,onChange:e=>w({..._,target_calories:e.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"meals_per_day",children:"Meals per Day"}),e.jsxs(Y,{value:_.meals_per_day,onValueChange:e=>w({..._,meals_per_day:e}),children:[e.jsx(z,{children:e.jsx(H,{})}),e.jsxs(R,{children:[e.jsx(V,{value:"2",children:"2 Meals"}),e.jsx(V,{value:"3",children:"3 Meals"}),e.jsx(V,{value:"4",children:"4 Meals"}),e.jsx(V,{value:"5",children:"5 Meals"})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"cooking_time",children:"Cooking Time"}),e.jsxs(Y,{value:_.cooking_time,onValueChange:e=>w({..._,cooking_time:e}),children:[e.jsx(z,{children:e.jsx(H,{})}),e.jsxs(R,{children:[e.jsx(V,{value:"quick",children:"Quick (15-20 min)"}),e.jsx(V,{value:"moderate",children:"Moderate (30-40 min)"}),e.jsx(V,{value:"extended",children:"Extended (1+ hour)"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"dietary_preferences",children:"Dietary Preferences"}),e.jsx(i,{id:"dietary_preferences",placeholder:o?.dietary_restrictions?.join(", ")||"e.g., Vegetarian, Low-carb, Keto",value:_.dietary_preferences,onChange:e=>w({..._,dietary_preferences:e.target.value})})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"allergies",children:"Allergies/Restrictions"}),e.jsx(i,{id:"allergies",placeholder:"e.g., Nuts, Dairy, Gluten",value:_.allergies,onChange:e=>w({..._,allergies:e.target.value})})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"cuisine_preference",children:"Cuisine Preference (optional)"}),e.jsx(i,{id:"cuisine_preference",placeholder:"e.g., Mediterranean, Asian, American",value:_.cuisine_preference,onChange:e=>w({..._,cuisine_preference:e.target.value})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>m(!1),className:"flex-1",children:"Cancel"}),e.jsx(a,{onClick:async()=>{h(!0);try{const e=`Create a ${_.plan_type} meal plan for a person with the following requirements:\n- Target Calories: ${_.target_calories||o?.target_calories||2e3} kcal\n- Dietary Preferences: ${_.dietary_preferences||o?.dietary_restrictions?.join(", ")||"None"}\n- Meals per Day: ${_.meals_per_day}\n- Allergies/Restrictions: ${_.allergies||"None"}\n- Cuisine Preference: ${_.cuisine_preference||"Any"}\n- Cooking Time: ${_.cooking_time}\n- Health Goals: ${o?.health_goals?.join(", ")||"General wellness"}\n\nPlease provide detailed meal suggestions with ingredients, portions, and nutritional breakdown for each meal.`,s=re(_,o),{data:t,error:a}=await l.from("ai_meal_plans").insert({user_id:o.id,plan_name:`${_.plan_type} Meal Plan - ${(new Date).toLocaleDateString()}`,plan_type:_.plan_type,target_date:(new Date).toISOString().split("T")[0],target_calories:parseInt(_.target_calories||2e3),meals:s.meals,ai_prompt:e,ai_model:"gpt-4",status:"active"}).select().single();if(a)throw a;b(s),v(2),n({title:"Meal Plan Generated!",description:"Your personalized meal plan is ready"})}catch(e){console.error("Error generating meal plan:",e),n({title:"Error",description:"Failed to generate meal plan. Please try again.",variant:"destructive"})}finally{h(!1)}},disabled:u,className:"flex-1",children:u?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 mr-2 animate-pulse"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Generate Plan"]})})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-primary/10 rounded-lg border border-primary/20",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Your Personalized Meal Plan"}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Calories"}),e.jsx("div",{className:"font-semibold",children:N?.totalCalories})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Protein"}),e.jsxs("div",{className:"font-semibold",children:[N?.totalProtein,"g"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Carbs"}),e.jsxs("div",{className:"font-semibold",children:[N?.totalCarbs,"g"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Fats"}),e.jsxs("div",{className:"font-semibold",children:[N?.totalFats,"g"]})]})]})]}),e.jsx("div",{className:"space-y-4",children:N?.meals.map((s,t)=>e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-primary"}),e.jsx("h4",{className:"font-semibold capitalize",children:s.type})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[s.calories," kcal"]})]}),e.jsx("h5",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.description}),e.jsxs("div",{className:"flex gap-4 mt-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["P: ",s.protein,"g"]}),e.jsxs("span",{children:["C: ",s.carbs,"g"]}),e.jsxs("span",{children:["F: ",s.fats,"g"]})]}),s.ingredients&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("strong",{children:"Ingredients:"})," ",s.ingredients]})]},t))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>v(1),className:"flex-1",children:"Regenerate"}),e.jsx(a,{onClick:async()=>{h(!0);try{const e=(new Date).toISOString().split("T")[0];for(const s of N.meals)await l.from("meal_logs").insert({user_id:o.id,meal_type:s.type.toLowerCase(),meal_name:s.name,description:s.description,calories:s.calories,protein_g:s.protein,carbs_g:s.carbs,fats_g:s.fats,date:e,ai_generated:!0}),await l.from("activity_feed").insert({user_id:o.id,activity_type:"ai_meal_plan",activity_title:"AI Meal Plan Created",activity_description:`Generated ${N.meals.length} meal suggestions`,metadata:{meal_count:N.meals.length}});n({title:"Meals Saved!",description:"Your meal plan has been added to today's log"}),m(!1),v(1),b(null),d&&d()}catch(e){console.error("Error saving meals:",e),n({title:"Error",description:"Failed to save meals. Please try again.",variant:"destructive"})}finally{h(!1)}},disabled:u,className:"flex-1",children:u?"Saving...":"Save to Today"})]})]})]})]})},re=(e,s)=>{const t=parseInt(e.target_calories||2e3),a=parseInt(e.meals_per_day),r=Math.floor(t/a),i=["breakfast","lunch","dinner","snack"],l=[],n={breakfast:[{name:"Greek Yogurt Bowl",desc:"Greek yogurt with berries, granola, and honey",ingredients:"Greek yogurt, mixed berries, granola, honey, almonds"},{name:"Avocado Toast",desc:"Whole grain toast with mashed avocado and poached eggs",ingredients:"Whole grain bread, avocado, eggs, cherry tomatoes, olive oil"},{name:"Protein Smoothie",desc:"Banana, protein powder, spinach, and almond milk",ingredients:"Banana, protein powder, spinach, almond milk, peanut butter"}],lunch:[{name:"Grilled Chicken Salad",desc:"Mixed greens with grilled chicken, quinoa, and vinaigrette",ingredients:"Chicken breast, mixed greens, quinoa, cherry tomatoes, cucumber, olive oil"},{name:"Salmon Bowl",desc:"Brown rice with baked salmon, edamame, and avocado",ingredients:"Salmon fillet, brown rice, edamame, avocado, sesame seeds, soy sauce"},{name:"Turkey Wrap",desc:"Whole wheat wrap with turkey, hummus, and veggies",ingredients:"Whole wheat tortilla, turkey breast, hummus, lettuce, tomato, cucumber"}],dinner:[{name:"Stir-Fry Chicken",desc:"Chicken with colorful vegetables and brown rice",ingredients:"Chicken breast, broccoli, bell peppers, carrots, brown rice, soy sauce"},{name:"Baked Cod",desc:"Lemon herb cod with roasted vegetables",ingredients:"Cod fillet, lemon, herbs, sweet potato, asparagus, olive oil"},{name:"Lean Beef & Quinoa",desc:"Seasoned lean beef with quinoa and steamed broccoli",ingredients:"Lean beef, quinoa, broccoli, garlic, spices"}],snack:[{name:"Apple & Almond Butter",desc:"Sliced apple with natural almond butter",ingredients:"Apple, almond butter"},{name:"Protein Bar",desc:"High-protein, low-sugar protein bar",ingredients:"Protein bar"},{name:"Mixed Nuts",desc:"Handful of mixed nuts and dried fruit",ingredients:"Almonds, cashews, dried cranberries"}]};for(let d=0;d<a;d++){const e=i[d%4],s=n[e],t=s[Math.floor(Math.random()*s.length)];l.push({type:e,name:t.name,description:t.desc,ingredients:t.ingredients,calories:r+Math.floor(100*Math.random()-50),protein:Math.floor(.3*r/4),carbs:Math.floor(.4*r/4),fats:Math.floor(.3*r/9)})}return{meals:l,totalCalories:l.reduce((e,s)=>e+s.calories,0),totalProtein:l.reduce((e,s)=>e+s.protein,0),totalCarbs:l.reduce((e,s)=>e+s.carbs,0),totalFats:l.reduce((e,s)=>e+s.fats,0)}},ie=({onSuccess:i})=>{const{userProfile:d}=t(),[o,c]=s.useState(!1),[m,u]=s.useState(!1),[h,y]=s.useState(1),[_,w]=s.useState({plan_type:"daily",fitness_level:"intermediate",workout_duration:"30",equipment:"bodyweight",focus_area:"full_body",intensity:"moderate"}),[N,b]=s.useState(null);return e.jsxs(x,{open:o,onOpenChange:c,children:[e.jsx(g,{asChild:!0,children:e.jsxs(a,{className:"w-full",size:"lg",variant:"outline",children:[e.jsx(C,{className:"w-5 h-5 mr-2"}),"Generate AI Workout"]})}),e.jsxs(p,{className:"glass-effect custom-scrollbar max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(j,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-6 h-6 text-primary"}),"AI Workout Planner"]})}),1===h?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"plan_type",children:"Plan Type"}),e.jsxs(Y,{value:_.plan_type,onValueChange:e=>w({..._,plan_type:e}),children:[e.jsx(z,{children:e.jsx(H,{})}),e.jsxs(R,{children:[e.jsx(V,{value:"daily",children:"Single Workout"}),e.jsx(V,{value:"weekly",children:"Weekly Program"})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"fitness_level",children:"Fitness Level"}),e.jsxs(Y,{value:_.fitness_level,onValueChange:e=>w({..._,fitness_level:e}),children:[e.jsx(z,{children:e.jsx(H,{})}),e.jsxs(R,{children:[e.jsx(V,{value:"beginner",children:"Beginner"}),e.jsx(V,{value:"intermediate",children:"Intermediate"}),e.jsx(V,{value:"advanced",children:"Advanced"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"duration",children:"Duration (minutes)"}),e.jsxs(Y,{value:_.workout_duration,onValueChange:e=>w({..._,workout_duration:e}),children:[e.jsx(z,{children:e.jsx(H,{})}),e.jsxs(R,{children:[e.jsx(V,{value:"15",children:"15 minutes"}),e.jsx(V,{value:"30",children:"30 minutes"}),e.jsx(V,{value:"45",children:"45 minutes"}),e.jsx(V,{value:"60",children:"60 minutes"})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"intensity",children:"Intensity"}),e.jsxs(Y,{value:_.intensity,onValueChange:e=>w({..._,intensity:e}),children:[e.jsx(z,{children:e.jsx(H,{})}),e.jsxs(R,{children:[e.jsx(V,{value:"light",children:"Light"}),e.jsx(V,{value:"moderate",children:"Moderate"}),e.jsx(V,{value:"intense",children:"Intense"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"equipment",children:"Available Equipment"}),e.jsxs(Y,{value:_.equipment,onValueChange:e=>w({..._,equipment:e}),children:[e.jsx(z,{children:e.jsx(H,{})}),e.jsxs(R,{children:[e.jsx(V,{value:"bodyweight",children:"Bodyweight Only"}),e.jsx(V,{value:"dumbbells",children:"Dumbbells"}),e.jsx(V,{value:"gym",children:"Full Gym Access"}),e.jsx(V,{value:"home",children:"Home Equipment (bands, weights)"})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"focus_area",children:"Focus Area"}),e.jsxs(Y,{value:_.focus_area,onValueChange:e=>w({..._,focus_area:e}),children:[e.jsx(z,{children:e.jsx(H,{})}),e.jsxs(R,{children:[e.jsx(V,{value:"full_body",children:"Full Body"}),e.jsx(V,{value:"upper_body",children:"Upper Body"}),e.jsx(V,{value:"lower_body",children:"Lower Body"}),e.jsx(V,{value:"core",children:"Core & Abs"}),e.jsx(V,{value:"cardio",children:"Cardio"}),e.jsx(V,{value:"flexibility",children:"Flexibility & Mobility"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>c(!1),className:"flex-1",children:"Cancel"}),e.jsx(a,{onClick:async()=>{u(!0);try{const e=`Create a ${_.plan_type} workout plan with:\n- Fitness Level: ${_.fitness_level}\n- Duration: ${_.workout_duration} minutes\n- Equipment: ${_.equipment}\n- Focus Area: ${_.focus_area}\n- Intensity: ${_.intensity}\n- Health Goals: ${d?.health_goals?.join(", ")||"General fitness"}\n\nProvide detailed exercises with sets, reps, and instructions.`,s=le(_,d),{data:t,error:a}=await l.from("ai_workout_plans").insert({user_id:d.id,plan_name:`${_.focus_area} Workout - ${(new Date).toLocaleDateString()}`,plan_type:_.plan_type,target_date:(new Date).toISOString().split("T")[0],difficulty:_.fitness_level,workouts:s.workouts,ai_prompt:e,ai_model:"gpt-4",status:"active"}).select().single();if(a)throw a;b(s),y(2),n({title:"Workout Plan Generated!",description:"Your personalized workout is ready"})}catch(e){console.error("Error generating workout:",e),n({title:"Error",description:"Failed to generate workout. Please try again.",variant:"destructive"})}finally{u(!1)}},disabled:m,className:"flex-1",children:m?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 mr-2 animate-pulse"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Generate Workout"]})})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-primary/10 rounded-lg border border-primary/20",children:[e.jsx("h3",{className:"font-semibold mb-2",children:N?.name}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Duration"}),e.jsxs("div",{className:"font-semibold",children:[N?.totalDuration," min"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Exercises"}),e.jsx("div",{className:"font-semibold",children:N?.workouts.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Est. Calories"}),e.jsx("div",{className:"font-semibold",children:N?.estimatedCalories})]})]})]}),e.jsx("div",{className:"space-y-3",children:N?.workouts.map((s,t)=>e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-primary"}),e.jsx("h4",{className:"font-semibold",children:s.name})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[s.sets,"x",s.reps]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.instructions}),s.rest&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Rest: ",s.rest,"s"]})]},t))}),e.jsxs("div",{className:"p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg text-sm",children:[e.jsx("strong",{children:"ðŸ’¡ Pro Tip:"})," Remember to warm up for 5 minutes before starting and cool down with stretching afterwards!"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>y(1),className:"flex-1",children:"Regenerate"}),e.jsx(a,{onClick:async()=>{u(!0);try{const e=(new Date).toISOString().split("T")[0];await l.from("workout_logs").insert({user_id:d.id,workout_name:N.name,workout_type:_.focus_area,duration_minutes:N.totalDuration,calories_burned:N.estimatedCalories,intensity:_.intensity,exercises:N.workouts,date:e,ai_generated:!0,notes:"AI Generated Workout"}),await l.from("activity_feed").insert({user_id:d.id,activity_type:"ai_workout_plan",activity_title:"AI Workout Plan Created",activity_description:N.name,metadata:{exercises:N.workouts.length}}),n({title:"Workout Saved!",description:"Your workout has been added to today's log"}),c(!1),y(1),b(null),i&&i()}catch(e){console.error("Error saving workout:",e),n({title:"Error",description:"Failed to save workout. Please try again.",variant:"destructive"})}finally{u(!1)}},disabled:m,className:"flex-1",children:m?"Saving...":"Save Workout"})]})]})]})]})},le=(e,s)=>{const t={full_body:[{name:"Push-ups",sets:3,reps:12,instructions:"Keep body straight, lower until chest nearly touches floor",rest:60},{name:"Squats",sets:3,reps:15,instructions:"Feet shoulder-width apart, lower until thighs parallel to ground",rest:60},{name:"Plank",sets:3,reps:"30s",instructions:"Hold body straight in plank position",rest:45},{name:"Lunges",sets:3,reps:"10 each",instructions:"Step forward, lower back knee toward floor",rest:60},{name:"Mountain Climbers",sets:3,reps:20,instructions:"Bring knees to chest alternately in plank position",rest:45}],upper_body:[{name:"Push-ups",sets:4,reps:12,instructions:"Standard push-up form",rest:60},{name:"Dips",sets:3,reps:10,instructions:"Use chair or parallel bars",rest:60},{name:"Pike Push-ups",sets:3,reps:8,instructions:"Hips up, head down between arms",rest:60},{name:"Arm Circles",sets:2,reps:30,instructions:"Small to large circles, both directions",rest:30}],lower_body:[{name:"Squats",sets:4,reps:15,instructions:"Bodyweight squats, full range of motion",rest:60},{name:"Lunges",sets:3,reps:"12 each",instructions:"Alternating forward lunges",rest:60},{name:"Glute Bridges",sets:3,reps:15,instructions:"Lift hips, squeeze glutes at top",rest:45},{name:"Calf Raises",sets:3,reps:20,instructions:"Rise up on toes, slow descent",rest:45}],core:[{name:"Plank",sets:3,reps:"45s",instructions:"Hold strong plank position",rest:45},{name:"Bicycle Crunches",sets:3,reps:20,instructions:"Bring opposite elbow to knee",rest:45},{name:"Russian Twists",sets:3,reps:30,instructions:"Rotate torso side to side",rest:45},{name:"Leg Raises",sets:3,reps:12,instructions:"Lift legs up, control descent",rest:60}],cardio:[{name:"Jumping Jacks",sets:3,reps:30,instructions:"Full range jumping jacks",rest:30},{name:"High Knees",sets:3,reps:40,instructions:"Run in place with high knees",rest:30},{name:"Burpees",sets:3,reps:10,instructions:"Full burpee with jump",rest:60},{name:"Mountain Climbers",sets:3,reps:30,instructions:"Fast-paced mountain climbers",rest:45}]},a=t[e.focus_area]||t.full_body,r=parseInt(e.workout_duration),i="intense"===e.intensity?10:"moderate"===e.intensity?7:5;return{name:`${e.focus_area.replace("_"," ").toUpperCase()} ${e.intensity} Workout`,workouts:a.slice(0,Math.floor(r/5)),totalDuration:r,estimatedCalories:r*i}},ne=()=>{const{userProfile:a}=t(),[r,i]=s.useState([]),[n,d]=s.useState(!0);s.useEffect(()=>{a?.id&&o()},[a?.id]);const o=async()=>{try{const e=(new Date).toISOString().split("T")[0],s=new Date;s.setDate(s.getDate()-7);const t=s.toISOString().split("T")[0],{data:r}=await l.from("daily_metrics").select("*").eq("user_id",a.id).gte("date",t).order("date",{ascending:!0}),{data:n}=await l.from("daily_metrics").select("*").eq("user_id",a.id).eq("date",e).single(),{data:o}=await l.from("workout_logs").select("*").eq("user_id",a.id).gte("date",t),{data:c}=await l.from("meal_logs").select("*").eq("user_id",a.id).gte("date",t),m=x(r||[],n,o||[],c||[],a);i(m),d(!1)}catch(e){console.error("Error generating insights:",e),d(!1)}},x=(e,s,t,a,r)=>{const i=[],l=e.filter(e=>e.weight_kg);if(l.length>=2){const e=l[0].weight_kg,s=l[l.length-1].weight_kg-e;Math.abs(s)>.5&&i.push({type:s<0?"success":"info",icon:k,title:s<0?"Weight Loss Progress":"Weight Gain",message:`You've ${s<0?"lost":"gained"} ${Math.abs(s).toFixed(1)}kg this week. ${s<0?"Great work! Keep it up!":"This might be muscle gain if you're strength training."}`})}if(s){const e=s.calories_consumed||0;s.calories_burned;const t=r.target_calories||2e3;e<.8*t?i.push({type:"warning",icon:P,title:"Low Calorie Intake",message:`You've consumed ${e} calories today, which is below your goal of ${t}. Consider adding a healthy snack!`}):e>1.2*t&&i.push({type:"info",icon:I,title:"High Calorie Day",message:`You've consumed ${e} calories today. If this was planned, great! Otherwise, try balancing tomorrow.`})}if(s){const e=s.water_ml||0;e<1500?i.push({type:"warning",icon:P,title:"Hydration Reminder",message:`You've had ${e}ml of water today. Aim for at least 2000ml for optimal hydration!`}):e>=2e3&&i.push({type:"success",icon:M,title:"Great Hydration!",message:`You've hit your water goal with ${e}ml today. Keep up the excellent hydration!`})}const n=e.filter(e=>e.sleep_hours);if(n.length>=3){const e=n.reduce((e,s)=>e+s.sleep_hours,0)/n.length;e<6.5?i.push({type:"warning",icon:P,title:"Insufficient Sleep",message:`Your average sleep is ${e.toFixed(1)} hours. Aim for 7-9 hours for better recovery and health.`}):e>=7&&e<=9&&i.push({type:"success",icon:M,title:"Excellent Sleep Pattern",message:`You're averaging ${e.toFixed(1)} hours of sleep. This is optimal for recovery and performance!`})}if(0===t.length?i.push({type:"info",icon:I,title:"Time to Move",message:"No workouts logged this week. Even a 15-minute walk can make a difference! Try our AI workout generator."}):t.length>=3&&i.push({type:"success",icon:M,title:"Active Week!",message:`You've completed ${t.length} workouts this week. You're crushing your fitness goals!`}),0===a.length&&i.push({type:"info",icon:I,title:"Start Tracking Meals",message:"Logging your meals helps you stay accountable and reach your nutrition goals faster."}),r.health_goals?.includes("lose_weight")){(consumed||0)-(burned||0)>0&&s&&i.push({type:"info",icon:I,title:"Calorie Deficit",message:"To lose weight, aim to burn more calories than you consume. Consider adding a workout or reducing portion sizes."})}if(r.health_goals?.includes("build_muscle")){const s=1.6*(r.weight_kg||70),t=e.reduce((e,s)=>e+(s.protein_g||0),0)/Math.max(e.length,1);t<.8*s&&i.push({type:"info",icon:I,title:"Increase Protein Intake",message:`For muscle building, aim for ${s.toFixed(0)}g of protein daily. You're averaging ${t.toFixed(0)}g.`})}return 0===i.length&&i.push({type:"success",icon:M,title:"Looking Good!",message:"Keep logging your data to get personalized insights and track your progress effectively."}),i.slice(0,5)},g=e=>{switch(e){case"success":return"text-green-500";case"warning":return"text-yellow-500";case"info":return"text-blue-500";default:return"text-muted-foreground"}},p=e=>{switch(e){case"success":return"bg-green-500/10 border-green-500/20";case"warning":return"bg-yellow-500/10 border-yellow-500/20";case"info":return"bg-blue-500/10 border-blue-500/20";default:return"bg-muted border-border"}};return n?e.jsx(c,{className:"glass-effect",children:e.jsx(h,{className:"p-8 text-center text-muted-foreground",children:"Analyzing your data..."})}):e.jsxs(c,{className:"glass-effect",children:[e.jsx(m,{children:e.jsxs(u,{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5 text-primary"}),"Personalized Insights"]})}),e.jsx(h,{className:"space-y-3",children:r.map((s,t)=>{const a=s.icon;return e.jsx("div",{className:`p-4 rounded-lg border ${p(s.type)}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(a,{className:`w-5 h-5 flex-shrink-0 mt-0.5 ${g(s.type)}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold mb-1",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.message})]})]})},t)})})]})},de=s.memo(({logoUrl:a})=>{const{userProfile:r}=t(),[i,n]=s.useState(null),[d,x]=s.useState([]),[g,p]=s.useState([]),[j,f]=s.useState(!0),[w,N]=s.useState(0);s.useEffect(()=>{r?.id&&k()},[r?.id,w]);const k=async()=>{try{const e=(new Date).toISOString().split("T")[0],{data:s,error:t}=await l.from("daily_metrics").select("*").eq("user_id",r.id).eq("date",e).maybeSingle();t&&"PGRST116"!==t.code&&console.error("Error fetching metrics:",t),n(s);const{data:a}=await l.from("activity_feed").select("*").eq("user_id",r.id).order("created_at",{ascending:!1}).limit(5);x(a||[]);const{data:i}=await l.from("user_streaks").select("*").eq("user_id",r.id);p(i||[]),f(!1)}catch(e){console.error("Error fetching dashboard data:",e),f(!1)}},S=()=>{N(e=>e+1)},C=s=>{switch(s){case"lose_weight":return e.jsx(y,{className:"w-6 h-6 text-primary"});case"build_muscle":return e.jsx(v,{className:"w-6 h-6 text-primary"});case"improve_endurance":return e.jsx($,{className:"w-6 h-6 text-primary"});case"eat_healthier":return e.jsx(B,{className:"w-6 h-6 text-primary"});case"increase_energy":return e.jsx(D,{className:"w-6 h-6 text-primary"});default:return e.jsx(G,{className:"w-6 h-6 text-primary"})}},{bmi:F,category:P}=s.useMemo(()=>((e,s)=>{if(!e||!s)return{bmi:"N/A",category:"N/A"};const t=s/100,a=(e/(t*t)).toFixed(1);let r="";return r=a<18.5?"Underweight":a>=18.5&&a<=24.9?"Normal":a>=25&&a<=29.9?"Overweight":"Obese",{bmi:a,category:r}})(r?.weight_kg,r?.height_cm),[r?.weight_kg,r?.height_cm]),I=s.useMemo(()=>({hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}}),[]),M=s.useMemo(()=>({hidden:{y:20,opacity:0},visible:{y:0,opacity:1}}),[]);return e.jsxs(e.Fragment,{children:[e.jsxs(o,{children:[e.jsx("title",{children:"Dashboard - GreenoFig"}),e.jsx("meta",{name:"description",content:"Your personal health and wellness dashboard."})]}),e.jsxs(T.div,{variants:I,initial:"hidden",animate:"visible",className:"w-full space-y-6 sm:space-y-8 lg:space-y-10 xl:space-y-12 px-4 sm:px-0",children:[e.jsxs(T.div,{variants:M,children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-bold leading-tight",children:["Welcome back, ",e.jsxs("span",{className:"gradient-text",children:[(r?.full_name||"User").split(" ")[0],"!"]})]}),e.jsx("p",{className:"text-sm sm:text-base lg:text-lg xl:text-xl text-text-secondary mt-2",children:"Here's your wellness snapshot for today. Let's make it a great one!"})]}),e.jsxs(T.div,{variants:I,className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8",children:[e.jsx(T.div,{variants:M,className:"lg:col-span-2",children:e.jsxs(c,{className:"glass-effect",children:[e.jsx(m,{className:"p-4 sm:p-6 lg:p-8",children:e.jsx(u,{className:"text-lg sm:text-xl lg:text-2xl xl:text-3xl font-bold",children:"Quick Actions"})}),e.jsxs(h,{className:"grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-3 lg:gap-4 p-4 sm:p-6 lg:p-8 pt-0",children:[e.jsx(Z,{onSuccess:S}),e.jsx(O,{onSuccess:S}),e.jsx(X,{onSuccess:S}),e.jsx(se,{onSuccess:S})]})]})}),e.jsx(T.div,{variants:M,children:e.jsx(ee,{onSuccess:S})})]}),e.jsxs(T.div,{variants:I,className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 lg:gap-8",children:[e.jsx(T.div,{variants:M,children:e.jsxs(c,{className:"glass-effect h-full",children:[e.jsxs(m,{className:"flex flex-row items-center justify-between space-y-0 pb-2 p-4 sm:p-6 lg:p-8 lg:pb-4",children:[e.jsx(u,{className:"text-xs sm:text-sm lg:text-base xl:text-lg font-medium",children:"Weight"}),e.jsx(y,{className:"h-4 w-4 sm:h-5 sm:w-5 lg:h-6 lg:w-6 text-muted-foreground"})]}),e.jsxs(h,{className:"p-4 sm:p-6 lg:p-8 pt-0 lg:pt-0",children:[e.jsxs("div",{className:"text-xl sm:text-2xl lg:text-3xl xl:text-4xl font-bold",children:[i?.weight_kg||r?.weight_kg||"N/A",(i?.weight_kg||r?.weight_kg)&&" kg"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i?.weight_kg?"Today's weight":"Last logged weight"})]})]})}),e.jsx(T.div,{variants:M,children:e.jsxs(c,{className:"glass-effect h-full",children:[e.jsxs(m,{className:"flex flex-row items-center justify-between space-y-0 pb-2 p-4 sm:p-6",children:[e.jsx(u,{className:"text-xs sm:text-sm font-medium",children:"BMI"}),e.jsx($,{className:"h-4 w-4 sm:h-5 sm:w-5 text-muted-foreground"})]}),e.jsxs(h,{className:"p-4 sm:p-6 pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:F}),e.jsx("p",{className:"text-xs text-muted-foreground",children:P})]})]})}),e.jsx(T.div,{variants:M,children:e.jsxs(c,{className:"glass-effect h-full",children:[e.jsxs(m,{className:"flex flex-row items-center justify-between space-y-0 pb-2 p-4 sm:p-6",children:[e.jsx(u,{className:"text-xs sm:text-sm font-medium",children:"Calories Today"}),e.jsx(A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-muted-foreground"})]}),e.jsxs(h,{className:"p-4 sm:p-6 pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:i?.calories_burned||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Burned â€¢ ",i?.calories_consumed||0," consumed"]})]})]})}),e.jsx(T.div,{variants:M,children:e.jsxs(c,{className:"glass-effect h-full",children:[e.jsxs(m,{className:"flex flex-row items-center justify-between space-y-0 pb-2 p-4 sm:p-6",children:[e.jsx(u,{className:"text-xs sm:text-sm font-medium",children:"Sleep"}),e.jsx(b,{className:"h-4 w-4 sm:h-5 sm:w-5 text-muted-foreground"})]}),e.jsxs(h,{className:"p-4 sm:p-6 pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:i?.sleep_hours?`${i.sleep_hours}h`:"Not logged"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i?.sleep_quality||"Log your sleep"})]})]})})]}),1===g.length&&e.jsx(T.div,{variants:M,children:e.jsx(c,{className:"glass-effect",children:e.jsx(h,{className:"py-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx(W,{className:"w-5 h-5 text-yellow-500"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-primary",children:g[0].current_streak}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"day"}),e.jsxs("span",{className:"text-sm font-medium capitalize",children:[g[0].streak_type.replace(/_/g," ")," streak"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Best: ",g[0].longest_streak," days"]})]})})})}),g.length>=2&&e.jsx(T.div,{variants:M,children:e.jsxs(c,{className:"glass-effect",children:[e.jsx(m,{className:"p-4 sm:p-6",children:e.jsxs(u,{className:"text-lg sm:text-xl font-bold flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4 sm:w-5 sm:h-5 text-yellow-500"}),"Your Streaks"]})}),e.jsx(h,{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4 p-4 sm:p-6 pt-0",children:g.map(s=>e.jsxs("div",{className:"text-center p-3 sm:p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-primary",children:s.current_streak}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground capitalize",children:s.streak_type.replace(/_/g," ")}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Best: ",s.longest_streak]})]},s.id))})]})}),e.jsxs(T.div,{variants:I,className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsx(T.div,{variants:M,className:"lg:col-span-2",children:e.jsxs(c,{className:"glass-effect h-full",children:[e.jsx(m,{className:"p-4 sm:p-6",children:e.jsxs(u,{className:"text-lg sm:text-xl font-bold flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Recent Activity"]})}),e.jsx(h,{className:"space-y-3 p-4 sm:p-6 pt-0",children:d.length>0?d.map(s=>e.jsxs(T.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-start gap-3 p-3 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex-shrink-0 p-2 rounded-full bg-primary/20",children:["logged_meal"===s.activity_type&&e.jsx(q,{className:"w-4 h-4 text-primary"}),"completed_workout"===s.activity_type&&e.jsx(v,{className:"w-4 h-4 text-primary"}),"weight_update"===s.activity_type&&e.jsx(y,{className:"w-4 h-4 text-primary"}),"sleep_log"===s.activity_type&&e.jsx(b,{className:"w-4 h-4 text-primary"}),"water_intake"===s.activity_type&&e.jsx(_,{className:"w-4 h-4 text-primary"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:s.activity_title}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.activity_description}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:new Date(s.created_at).toLocaleString()})]})]},s.id)):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(E,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No activity yet. Start logging your health data!"})]})})]})}),e.jsx(T.div,{variants:M,children:e.jsxs(c,{className:"glass-effect h-full",children:[e.jsx(m,{className:"p-4 sm:p-6",children:e.jsx(u,{className:"text-lg sm:text-xl font-bold",children:"Your Goals"})}),e.jsx(h,{className:"space-y-3 sm:space-y-4 p-4 sm:p-6 pt-0",children:r?.health_goals&&r.health_goals.length>0?r.health_goals.map(s=>e.jsxs(T.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"flex items-center gap-3 sm:gap-4 bg-muted p-3 rounded-lg",children:[C(s),e.jsx("span",{className:"text-sm sm:text-base font-medium text-text-primary capitalize",children:s.replace(/_/g," ")})]},s)):e.jsx("p",{className:"text-sm sm:text-base text-text-secondary",children:"No goals set yet. Update your profile to add goals!"})})]})})]}),e.jsx(T.div,{variants:M,children:e.jsx(te,{})}),e.jsxs(T.div,{variants:I,className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsx(T.div,{variants:M,children:e.jsx(ne,{})}),e.jsx(T.div,{variants:M,children:e.jsxs(c,{className:"glass-effect h-full",children:[e.jsx(m,{className:"p-4 sm:p-6",children:e.jsx(u,{className:"text-lg sm:text-xl font-bold",children:"AI-Powered Tools"})}),e.jsxs(h,{className:"space-y-3 p-4 sm:p-6 pt-0",children:[e.jsx(ae,{onSuccess:S}),e.jsx(ie,{onSuccess:S})]})]})})]})]})]})});de.displayName="UserDashboard";export{de as default};
