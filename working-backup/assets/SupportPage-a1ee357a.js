import{j as e}from"./vendor-ui-8934955f.js";import{r as s}from"./vendor-react-c35372bd.js";import{u as t,a as r,B as a,T as i,I as l,s as c,t as n,b as o}from"./index-05934966.js";import{C as d,a as p,b as u,e as m,c as x}from"./card-5ef2c077.js";import{S as h,a as j,b as g,c as b,d as f}from"./select-b96110db.js";import{T as y,a as N,b as v,c as w}from"./tabs-2a9eaf96.js";import{m as k,V as S,co as C,cp as D,M as q,L as _,h as I,g as T,b0 as F,R as P,_ as B,I as L,an as H}from"./vendor-utils-1c9b7ece.js";import"./vendor-editor-7586347a.js";const M=()=>{const{t:M}=t(),{userProfile:V}=r(),[E,U]=s.useState(!1),[G,R]=s.useState([]),[$,z]=s.useState([]),[O,Y]=s.useState(!0),[A,J]=s.useState(""),[K,Q]=s.useState(""),[W,X]=s.useState(""),[Z,ee]=s.useState("medium"),[se,te]=s.useState(0),[re,ae]=s.useState("suggestion"),[ie,le]=s.useState(""),ce=async()=>{if(!(null==V?void 0:V.id))return;Y(!0);const{data:e,error:s}=await c.from("issues").select("*").eq("user_id",V.id).order("created_at",{ascending:!1});s||z(e||[]),Y(!1)};s.useEffect(()=>{(null==V?void 0:V.id)&&((async()=>{const{data:e}=await c.from("issue_categories").select("*").eq("is_active",!0).order("display_order");e&&R(e)})(),ce())},[null==V?void 0:V.id]);const ne=s=>{switch(s){case"open":return e.jsxs(o,{className:"bg-blue-500/20 text-blue-300 border-blue-500/30",children:[e.jsx(L,{className:"w-3 h-3 mr-1"}),M("support.statusOpen")]});case"in_progress":return e.jsxs(o,{className:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30",children:[e.jsx(B,{className:"w-3 h-3 mr-1"}),M("support.statusInProgress")]});case"resolved":return e.jsxs(o,{className:"bg-green-500/20 text-green-400 border-green-500/30",children:[e.jsx(P,{className:"w-3 h-3 mr-1"}),M("support.statusResolved")]});case"closed":return e.jsx(o,{variant:"outline",children:M("support.statusClosed")});default:return e.jsx(o,{children:s})}},oe=s=>{switch(s){case"urgent":return e.jsxs(o,{className:"bg-red-500/20 text-red-300 border-red-500/30",children:[e.jsx(H,{className:"w-3 h-3 mr-1"}),M("support.priorityUrgentBadge")]});case"high":return e.jsxs(o,{className:"bg-orange-500/20 text-orange-300 border-orange-500/30",children:[e.jsx(H,{className:"w-3 h-3 mr-1"}),M("support.priorityHighBadge")]});case"medium":return e.jsx(o,{className:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30",children:M("support.priorityMediumBadge")});case"low":return e.jsx(o,{className:"bg-gray-500/20 text-gray-300 border-gray-500/30",children:M("support.priorityLowBadge")});default:return e.jsx(o,{children:s})}};return e.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:M("support.title")}),e.jsx("p",{className:"text-text-secondary",children:M("support.subtitle")})]}),e.jsxs(y,{defaultValue:"feedback",className:"w-full",children:[e.jsxs(N,{className:"grid w-full grid-cols-3",children:[e.jsx(v,{value:"feedback",children:M("support.quickFeedback")}),e.jsx(v,{value:"create",children:M("support.createTicket")}),e.jsxs(v,{value:"mytickets",children:[M("support.myTickets")," (",$.length,")"]})]}),e.jsx(w,{value:"feedback",children:e.jsxs(d,{className:"glass-effect",children:[e.jsxs(p,{children:[e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-6 h-6 text-yellow-500"}),M("support.quickFeedback")]}),e.jsx(m,{children:M("support.quickFeedbackDesc")})]}),e.jsx(x,{children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!ie.trim())return void n({title:M("support.missingInfo"),description:M("support.missingFeedbackDesc"),variant:"destructive"});U(!0);const s=`${"suggestion"===re?"ðŸ’¡ Suggestion":"complaint"===re?"âš ï¸ Complaint":"â­ Praise"} - ${se} stars`,{error:t}=await c.from("issues").insert({user_id:V.id,subject:s,description:ie.trim(),category:"feedback",priority:"complaint"===re?"high":"low",status:"open"});t?n({title:M("support.errorSubmitting"),description:t.message,variant:"destructive"}):(n({title:M("support.feedbackSubmitted"),description:M("support.feedbackSubmittedDesc")}),te(0),ae("suggestion"),le(""),ce()),U(!1)},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-3",children:M("support.rateExperience")}),e.jsx("div",{className:"flex gap-2 justify-center py-4",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>te(s),className:"transition-all transform hover:scale-110",children:e.jsx(S,{className:"w-10 h-10 "+(s<=se?"fill-yellow-500 text-yellow-500":"text-gray-400")})},s))}),se>0&&e.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:[5===se&&M("support.ratingExcellent"),4===se&&M("support.ratingGreat"),3===se&&M("support.ratingGood"),2===se&&M("support.ratingCouldBeBetter"),1===se&&M("support.ratingNeedsImprovement")]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:M("support.feedbackType")}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs(a,{type:"button",variant:"suggestion"===re?"default":"outline",onClick:()=>ae("suggestion"),className:"h-auto py-4 flex flex-col items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5"}),e.jsx("span",{children:M("support.suggestion")})]}),e.jsxs(a,{type:"button",variant:"complaint"===re?"default":"outline",onClick:()=>ae("complaint"),className:"h-auto py-4 flex flex-col items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5"}),e.jsx("span",{children:M("support.issue")})]}),e.jsxs(a,{type:"button",variant:"praise"===re?"default":"outline",onClick:()=>ae("praise"),className:"h-auto py-4 flex flex-col items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5"}),e.jsx("span",{children:M("support.praise")})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[M("support.tellUsMore")," ",e.jsx("span",{className:"text-red-400",children:M("support.required")})]}),e.jsx(i,{placeholder:M("suggestion"===re?"support.feedbackPlaceholderSuggestion":"complaint"===re?"support.feedbackPlaceholderIssue":"support.feedbackPlaceholderPraise"),value:ie,onChange:e=>le(e.target.value),rows:6,required:!0})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(q,{className:"w-5 h-5 text-blue-400 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-blue-300 mb-1",children:M("support.conversationInfo")}),e.jsx("p",{className:"text-blue-200/70",children:M("support.conversationInfoDesc")})]})]}),e.jsx(a,{type:"submit",className:"w-full",disabled:E||!ie.trim(),children:E?e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-4 h-4 mr-2 animate-spin"}),M("support.submitting")]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),M("support.sendFeedback")]})})]})})]})}),e.jsx(w,{value:"create",children:e.jsxs(d,{className:"glass-effect",children:[e.jsxs(p,{children:[e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-6 h-6"}),M("support.submitTicket")]}),e.jsx(m,{children:M("support.submitTicketDesc")})]}),e.jsx(x,{children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!A.trim()||!K.trim()||!W)return void n({title:M("support.missingInfo"),description:M("support.missingInfoDesc"),variant:"destructive"});U(!0);const{error:s}=await c.from("issues").insert({user_id:V.id,subject:A.trim(),description:K.trim(),category:W,priority:Z,status:"open"});s?n({title:M("support.errorCreating"),description:s.message,variant:"destructive"}):(n({title:M("support.ticketCreated"),description:M("support.ticketCreatedDesc")}),J(""),Q(""),X(""),ee("medium"),ce()),U(!1)},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[M("support.subject")," ",e.jsx("span",{className:"text-red-400",children:M("support.required")})]}),e.jsx(l,{type:"text",placeholder:M("support.subjectPlaceholder"),value:A,onChange:e=>J(e.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[M("support.category")," ",e.jsx("span",{className:"text-red-400",children:M("support.required")})]}),e.jsxs(h,{value:W,onValueChange:X,required:!0,children:[e.jsx(j,{children:e.jsx(g,{placeholder:M("support.categoryPlaceholder")})}),e.jsx(b,{children:G.map(s=>e.jsxs(f,{value:s.slug,children:[s.name," - ",s.description]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:M("support.priority")}),e.jsxs(h,{value:Z,onValueChange:ee,children:[e.jsx(j,{children:e.jsx(g,{})}),e.jsxs(b,{children:[e.jsx(f,{value:"low",children:M("support.priorityLow")}),e.jsx(f,{value:"medium",children:M("support.priorityMedium")}),e.jsx(f,{value:"high",children:M("support.priorityHigh")}),e.jsx(f,{value:"urgent",children:M("support.priorityUrgent")})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[M("support.description")," ",e.jsx("span",{className:"text-red-400",children:M("support.required")})]}),e.jsx(i,{placeholder:M("support.descriptionPlaceholder"),value:K,onChange:e=>Q(e.target.value),rows:8,required:!0}),e.jsx("p",{className:"text-xs text-text-secondary mt-2",children:M("support.descriptionHelper")})]}),e.jsx(a,{type:"submit",className:"w-full",disabled:E,children:E?e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-4 h-4 mr-2 animate-spin"}),M("support.submitting")]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),M("support.submitButton")]})})]})})]})}),e.jsx(w,{value:"mytickets",children:e.jsxs(d,{className:"glass-effect",children:[e.jsxs(p,{children:[e.jsx(u,{children:M("support.myTicketsTitle")}),e.jsx(m,{children:M("support.myTicketsDesc")})]}),e.jsx(x,{children:O?e.jsx("div",{className:"flex justify-center items-center py-10",children:e.jsx(_,{className:"h-8 w-8 animate-spin text-primary"})}):0===$.length?e.jsxs("div",{className:"text-center py-10",children:[e.jsx(F,{className:"w-16 h-16 mx-auto text-text-secondary opacity-50 mb-4"}),e.jsx("p",{className:"text-text-secondary",children:M("support.noTicketsYet")})]}):e.jsx("div",{className:"space-y-4",children:$.map(s=>e.jsxs(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-4 rounded-lg glass-effect border border-white/10 hover:border-primary/30 transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg mb-1",children:s.subject}),e.jsx("p",{className:"text-sm text-text-secondary line-clamp-2",children:s.description})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[ne(s.status),oe(s.priority)]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-text-secondary",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:[M("support.ticketNumber"),s.id.slice(0,8)]}),s.category&&e.jsxs("span",{className:"capitalize",children:[M("support.categoryLabel")," ",s.category.replace("_"," ")]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:[M("support.created")," ",new Date(s.created_at).toLocaleDateString()]}),e.jsxs("span",{children:[M("support.updated")," ",new Date(s.updated_at).toLocaleDateString()]})]})]}),"resolved"===s.status&&e.jsx("div",{className:"mt-3 pt-3 border-t border-white/10",children:e.jsx("p",{className:"text-sm text-green-400",children:M("support.resolved")})})]},s.id))})})]})})]})]})};export{M as default};
