import{j as e}from"./vendor-ui-8934955f.js";import{u as i,r as s,L as a}from"./vendor-react-c35372bd.js";import{u as r,a as t,B as n,H as l,t as o,s as d}from"./index-05934966.js";import{D as c,a as m}from"./dialog-f70f7e7c.js";import{bB as x,D as h,b_ as b,bd as g,m as u,b as p,A as j,P as v,L as f,X as y,R as N}from"./vendor-utils-1c9b7ece.js";import"./vendor-editor-7586347a.js";const w=({logoUrl:w,isOpen:_,setIsOpen:k,inline:C=!1})=>{const{t:P}=r(),{user:S,userProfile:z,refreshUserProfile:L}=t(),F=i(),[A,D]=s.useState(1),[G,M]=s.useState(!1),[E,B]=s.useState("metric"),[T,H]=s.useState({age:(null==z?void 0:z.age)||"",gender:(null==z?void 0:z.gender)||"",height_cm:(null==z?void 0:z.height_cm)||"",weight_kg:(null==z?void 0:z.weight_kg)||"",activity_level:(null==z?void 0:z.activity_level)||"",health_goals:(null==z?void 0:z.health_goals)||[],dietary_preferences:(null==z?void 0:z.dietary_preferences)||[],health_conditions:(null==z?void 0:z.health_conditions)||[]});s.useEffect(()=>{z&&H({age:z.age||"",gender:z.gender||"",height_cm:z.height_cm||"",weight_kg:z.weight_kg||"",activity_level:z.activity_level||"",health_goals:z.health_goals||[],dietary_preferences:z.dietary_preferences||[],health_conditions:z.health_conditions||[]})},[z]);const I=[{id:"sedentary",label:P("onboarding.activitySedentary"),description:P("onboarding.activitySedentaryDesc")},{id:"lightly_active",label:P("onboarding.activityLightlyActive"),description:P("onboarding.activityLightlyActiveDesc")},{id:"moderately_active",label:P("onboarding.activityModeratelyActive"),description:P("onboarding.activityModeratelyActiveDesc")},{id:"very_active",label:P("onboarding.activityVeryActive"),description:P("onboarding.activityVeryActiveDesc")},{id:"super_active",label:P("onboarding.activitySuperActive"),description:P("onboarding.activitySuperActiveDesc")}],U=[{id:"lose_weight",label:P("onboarding.goalLoseWeight"),icon:x},{id:"build_muscle",label:P("onboarding.goalBuildMuscle"),icon:h},{id:"improve_endurance",label:P("onboarding.goalImproveEndurance"),icon:b},{id:"eat_healthier",label:P("onboarding.goalEatHealthier"),icon:b},{id:"increase_energy",label:P("onboarding.goalIncreaseEnergy"),icon:g}],O=[{id:"none",label:P("onboarding.dietNone")},{id:"vegetarian",label:P("onboarding.dietVegetarian")},{id:"vegan",label:P("onboarding.dietVegan")},{id:"gluten_free",label:P("onboarding.dietGlutenFree")},{id:"dairy_free",label:P("onboarding.dietDairyFree")},{id:"keto",label:P("onboarding.dietKeto")},{id:"paleo",label:P("onboarding.dietPaleo")},{id:"halal",label:P("onboarding.dietHalal")},{id:"kosher",label:P("onboarding.dietKosher")}],V=[{id:"none",label:P("onboarding.conditionNone")},{id:"diabetes",label:P("onboarding.conditionDiabetes")},{id:"high_blood_pressure",label:P("onboarding.conditionHighBloodPressure")},{id:"heart_disease",label:P("onboarding.conditionHeartDisease")},{id:"asthma",label:P("onboarding.conditionAsthma")},{id:"arthritis",label:P("onboarding.conditionArthritis")},{id:"thyroid_issues",label:P("onboarding.conditionThyroid")},{id:"food_allergies",label:P("onboarding.conditionFoodAllergies")}],q=e=>{const{name:i,value:s}=e.target;H(e=>({...e,[i]:s}))},W=e=>{const i=e.target.value;if("metric"===E)H(e=>({...e,height_cm:i}));else{const e=(2.54*i).toFixed(1);H(i=>({...i,height_cm:e}))}},K=e=>{const i=e.target.value;if("metric"===E)H(e=>({...e,weight_kg:i}));else{const e=(i/2.20462).toFixed(1);H(i=>({...i,weight_kg:e}))}},R=()=>{A<6&&D(e=>e+1)},Y=()=>{A>1&&D(e=>e-1)},J=async()=>{if(!S)return o({title:"Sign Up Required",description:"Please sign up to save your personalized profile"}),void F("/signup");M(!0);try{const{error:e}=await d.from("user_profiles").update(T).eq("id",S.id);if(e)throw e;const{error:i}=await d.from("survey_responses").insert({user_id:S.id,...T});await L(),o({title:"Success! ðŸŽ‰",description:"Your profile has been updated successfully"}),M(!1),D(e=>e+1)}catch(e){M(!1),o({title:"Error updating profile",description:e.message||"Something went wrong. Please try again.",variant:"destructive"})}},Q=()=>{C?D(1):(k&&(k(!1),D(1)),F("/app",{replace:!0}))},X=()=>{k&&(k(!1),D(1))},Z=()=>{switch(A){case 1:return e.jsxs(u.div,{className:"space-y-3",children:[e.jsx("h2",{className:"text-lg font-bold",children:P("onboarding.aboutYou")}),e.jsxs("div",{className:"space-y-2.5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1",children:P("onboarding.age")}),e.jsx("input",{type:"number",name:"age",value:T.age,onChange:q,className:"w-full bg-background border border-border rounded-md p-2 text-sm",placeholder:P("onboarding.agePlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1",children:P("onboarding.gender")}),e.jsxs("select",{name:"gender",value:T.gender,onChange:q,className:"w-full bg-background border border-border rounded-md p-2 text-sm",children:[e.jsx("option",{value:"",children:P("onboarding.selectGender")}),e.jsx("option",{value:"male",children:P("onboarding.male")}),e.jsx("option",{value:"female",children:P("onboarding.female")}),e.jsx("option",{value:"other",children:P("onboarding.other")}),e.jsx("option",{value:"prefer_not_to_say",children:P("onboarding.preferNotToSay")})]})]})]})]},"step1");case 2:return e.jsxs(u.div,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-lg font-bold",children:P("onboarding.bodyMetrics")}),e.jsxs("div",{className:"flex gap-1 bg-muted rounded-md p-0.5",children:[e.jsx("button",{onClick:()=>B("metric"),className:"px-2 py-1 text-xs rounded-md transition-colors "+("metric"===E?"bg-primary text-primary-foreground":"text-muted-foreground"),children:P("onboarding.metric")}),e.jsx("button",{onClick:()=>B("imperial"),className:"px-2 py-1 text-xs rounded-md transition-colors "+("imperial"===E?"bg-primary text-primary-foreground":"text-muted-foreground"),children:P("onboarding.imperial")})]})]}),e.jsxs("div",{className:"space-y-2.5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-text-secondary mb-1",children:[P("onboarding.height")," ","metric"===E?"(cm)":"(inches)"]}),e.jsx("input",{type:"number",value:T.height_cm?"metric"===E?T.height_cm:(T.height_cm/2.54).toFixed(1):"",onChange:W,className:"w-full bg-background border border-border rounded-md p-2 text-sm",placeholder:P("metric"===E?"onboarding.heightPlaceholderMetric":"onboarding.heightPlaceholderImperial"),step:"0.1"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-text-secondary mb-1",children:[P("onboarding.weight")," ","metric"===E?"(kg)":"(lbs)"]}),e.jsx("input",{type:"number",value:T.weight_kg?"metric"===E?T.weight_kg:(2.20462*T.weight_kg).toFixed(1):"",onChange:K,className:"w-full bg-background border border-border rounded-md p-2 text-sm",placeholder:P("metric"===E?"onboarding.weightPlaceholderMetric":"onboarding.weightPlaceholderImperial"),step:"0.1"})]})]})]},"step2");case 3:return e.jsxs(u.div,{className:"space-y-3",children:[e.jsx("h2",{className:"text-lg font-bold",children:P("onboarding.lifestyle")}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1",children:P("onboarding.activityLevel")}),I.map(i=>e.jsxs("button",{onClick:()=>H(e=>({...e,activity_level:i.id})),className:"w-full text-left p-2 rounded-md border-2 transition-all "+(T.activity_level===i.id?"border-primary bg-primary/10":"border-border hover:border-primary/50"),children:[e.jsx("p",{className:"text-xs font-semibold",children:i.label}),e.jsx("p",{className:"text-xs text-text-secondary",children:i.description})]},i.id))]})]},"step3");case 4:return e.jsxs(u.div,{className:"space-y-3",children:[e.jsx("h2",{className:"text-lg font-bold",children:P("onboarding.goals")}),e.jsx("p",{className:"text-xs text-text-secondary",children:P("onboarding.goalsSubtitle")}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:U.map(i=>{const s=i.icon;return e.jsxs("button",{onClick:()=>{return e=i.id,void H(i=>{const s=i.health_goals.includes(e)?i.health_goals.filter(i=>i!==e):[...i.health_goals,e];return{...i,health_goals:s}});var e},className:"flex flex-col items-center justify-center p-2 aspect-square rounded-md border-2 transition-all "+(T.health_goals.includes(i.id)?"border-primary bg-primary/10":"border-border hover:border-primary/50"),children:[e.jsx(s,{className:"w-5 h-5 mb-1 text-primary"}),e.jsx("span",{className:"text-xs font-semibold text-center",children:i.label})]},i.id)})})]},"step4");case 5:return e.jsxs(u.div,{className:"space-y-3",children:[e.jsx("h2",{className:"text-lg font-bold",children:P("onboarding.dietaryPreferences")}),e.jsx("p",{className:"text-xs text-text-secondary",children:P("onboarding.dietaryPreferencesSubtitle")}),e.jsx("div",{className:"space-y-2",children:O.map(i=>e.jsxs("button",{onClick:()=>{return e=i.id,void H(i=>{let s;return"none"===e?s=i.dietary_preferences.includes("none")?[]:["none"]:(s=i.dietary_preferences.filter(e=>"none"!==e),s=s.includes(e)?s.filter(i=>i!==e):[...s,e]),{...i,dietary_preferences:s}});var e},className:"w-full text-left p-2.5 rounded-md border-2 transition-all flex items-center "+(T.dietary_preferences.includes(i.id)?"border-primary bg-primary/10":"border-border hover:border-primary/50"),children:[e.jsx("div",{className:"w-4 h-4 rounded border-2 mr-2 flex items-center justify-center "+(T.dietary_preferences.includes(i.id)?"bg-primary border-primary":"border-border"),children:T.dietary_preferences.includes(i.id)&&e.jsx("svg",{className:"w-3 h-3 text-primary-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("span",{className:"text-sm font-medium",children:i.label})]},i.id))})]},"step5");case 6:return e.jsxs(u.div,{className:"space-y-3",children:[e.jsx("h2",{className:"text-lg font-bold",children:P("onboarding.healthConditions")}),e.jsx("p",{className:"text-xs text-text-secondary",children:P("onboarding.healthConditionsSubtitle")}),e.jsx("div",{className:"space-y-2",children:V.map(i=>e.jsxs("button",{onClick:()=>{return e=i.id,void H(i=>{let s;return"none"===e?s=i.health_conditions.includes("none")?[]:["none"]:(s=i.health_conditions.filter(e=>"none"!==e),s=s.includes(e)?s.filter(i=>i!==e):[...s,e]),{...i,health_conditions:s}});var e},className:"w-full text-left p-2.5 rounded-md border-2 transition-all flex items-center "+(T.health_conditions.includes(i.id)?"border-primary bg-primary/10":"border-border hover:border-primary/50"),children:[e.jsx("div",{className:"w-4 h-4 rounded border-2 mr-2 flex items-center justify-center "+(T.health_conditions.includes(i.id)?"bg-primary border-primary":"border-border"),children:T.health_conditions.includes(i.id)&&e.jsx("svg",{className:"w-3 h-3 text-primary-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("span",{className:"text-sm font-medium",children:i.label})]},i.id))})]},"step6");case 7:return e.jsxs(u.div,{className:"text-center flex flex-col items-center py-3",children:[e.jsx(N,{className:"w-12 h-12 text-green-500 mb-3"}),e.jsx("h2",{className:"text-lg font-bold",children:P("onboarding.setupComplete")}),e.jsx("p",{className:"text-xs text-text-secondary mt-1.5 mb-4",children:P("onboarding.setupCompleteDesc")}),e.jsx(n,{onClick:Q,size:"sm",children:P("onboarding.goToDashboard")})]},"step7");default:return null}};if(C){const i=S&&z;return e.jsx("div",{className:"w-full max-w-4xl mx-auto relative",children:e.jsxs("div",{className:"glass-effect rounded-lg p-4 shadow-lg border border-border",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("img",{src:w,alt:"GreenoFig Logo",className:"w-8 h-8"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-sm font-bold gradient-text",children:P(i?"onboarding.completeProfile":"onboarding.getPersonalizedGuidance")}),e.jsx("p",{className:"text-xs text-text-secondary",children:P(i?"onboarding.personalizeExperience":"onboarding.signUpToPlan")})]}),!i&&e.jsx(n,{size:"sm",onClick:()=>F("/signup"),className:"bg-primary text-primary-foreground text-xs px-3 py-1 h-auto",children:P("onboarding.signUp")})]}),e.jsx("div",{className:"mb-3",children:e.jsx("div",{className:"w-full bg-muted rounded-full h-1.5",children:e.jsx(u.div,{className:"bg-primary h-1.5 rounded-full",initial:{width:"0%"},animate:{width:(A-1)/6*100+"%"}})})}),e.jsx(p,{mode:"wait",children:e.jsx(u.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:Z()},A)}),A<=6&&e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs(n,{variant:"outline",size:"sm",onClick:Y,disabled:1===A||G,className:"text-xs",children:[e.jsx(j,{className:"w-3 h-3 mr-1"})," ",P("onboarding.back")]}),A<6?e.jsxs(n,{size:"sm",onClick:R,className:"text-xs",children:[P("onboarding.next")," ",e.jsx(v,{className:"w-3 h-3 ml-1"})]}):e.jsxs(n,{size:"sm",onClick:J,disabled:G,className:"text-xs",children:[G&&e.jsx(f,{className:"w-3 h-3 mr-1 animate-spin"}),P("onboarding.finish")]})]})]})})}return void 0!==_&&k?e.jsx(e.Fragment,{children:e.jsx(c,{open:_,onOpenChange:k,children:e.jsx(m,{className:"glass-effect custom-scrollbar max-w-md max-h-[90vh] overflow-y-auto p-0",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:w,alt:"GreenoFig Logo",className:"w-8 h-8"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-base font-bold gradient-text",children:P("onboarding.welcomeTitle")}),e.jsx("p",{className:"text-xs text-text-secondary",children:P("onboarding.welcomeSubtitle")})]})]}),e.jsx(n,{variant:"ghost",size:"icon",onClick:X,className:"h-8 w-8",children:e.jsx(y,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"glass-effect rounded-lg p-3 sm:p-4",children:[e.jsx("div",{className:"mb-3",children:A<=6&&e.jsx("div",{className:"w-full bg-muted rounded-full h-1.5",children:e.jsx(u.div,{className:"bg-primary h-1.5 rounded-full",initial:{width:"0%"},animate:{width:(A-1)/6*100+"%"}})})}),e.jsx(p,{mode:"wait",children:e.jsx(u.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},children:Z()},A)}),A<=6&&e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs(n,{variant:"outline",size:"sm",onClick:Y,disabled:1===A||G,className:"text-xs",children:[e.jsx(j,{className:"w-3 h-3 mr-1"})," ",P("onboarding.back")]}),A<6?e.jsxs(n,{size:"sm",onClick:R,className:"text-xs",children:[P("onboarding.next")," ",e.jsx(v,{className:"w-3 h-3 ml-1"})]}):e.jsxs(n,{size:"sm",onClick:J,disabled:G,className:"text-xs",children:[G&&e.jsx(f,{className:"w-3 h-3 mr-1 animate-spin"}),P("onboarding.finish")]})]})]})]})})})}):e.jsxs(e.Fragment,{children:[e.jsxs(l,{children:[e.jsx("title",{children:"Onboarding - GreenoFig"}),e.jsx("meta",{name:"description",content:"Personalize your GreenoFig experience."})]}),e.jsx("div",{className:"flex flex-col items-center py-8 px-3 sm:px-4 bg-background text-foreground",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-3",children:[e.jsx(a,{to:"/home",className:"inline-block mb-1.5",children:e.jsx("img",{src:w,alt:"GreenoFig Logo",className:"w-10 h-10"})}),e.jsx("h1",{className:"text-xl font-bold gradient-text",children:P("onboarding.welcomeTitle")}),e.jsx("p",{className:"text-xs text-text-secondary",children:P("onboarding.welcomeSubtitle")})]}),e.jsxs("div",{className:"glass-effect rounded-lg p-3 sm:p-4 shadow-xl",children:[e.jsx("div",{className:"mb-3",children:A<=6&&e.jsx("div",{className:"w-full bg-muted rounded-full h-1.5",children:e.jsx(u.div,{className:"bg-primary h-1.5 rounded-full",initial:{width:"0%"},animate:{width:(A-1)/6*100+"%"}})})}),e.jsx(p,{mode:"wait",children:e.jsx(u.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},children:Z()},A)}),A<=6&&e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs(n,{variant:"outline",size:"sm",onClick:Y,disabled:1===A||G,className:"text-xs",children:[e.jsx(j,{className:"w-3 h-3 mr-1"})," ",P("onboarding.back")]}),A<6?e.jsxs(n,{size:"sm",onClick:R,className:"text-xs",children:[P("onboarding.next")," ",e.jsx(v,{className:"w-3 h-3 ml-1"})]}):e.jsxs(n,{size:"sm",onClick:J,disabled:G,className:"text-xs",children:[G&&e.jsx(f,{className:"w-3 h-3 mr-1 animate-spin"}),P("onboarding.finish")]})]})]})]})})]})};export{w as default};
