# STANDARD DEPLOYMENT PROCESS FOR GREENOFIG

**This is the EXACT process that works every time. Use this for ALL deployments.**

## The Process That Works:

### Step 1: Clean Rebuild
```bash
rm -rf dist
npx vite build
```

### Step 2: Clear Old Files on Server
```bash
ssh greenofig-hostinger "cd domains/greenofig.com/public_html && rm -rf assets/*.js assets/*.css *.html"
```

### Step 3: Deploy New Files
```bash
cd dist && tar -czf ../deploy.tar.gz . && cd .. && cat deploy.tar.gz | ssh greenofig-hostinger "cd domains/greenofig.com/public_html && tar -xzf - && chmod 644 *.html .htaccess && chmod 755 assets && find assets -type f -exec chmod 644 {} \;" && rm deploy.tar.gz
```

### Step 4: Verify Deployment
```bash
ssh greenofig-hostinger "cd domains/greenofig.com/public_html && ls -lh index.html && grep -o 'index-[^\"]*\.js' index.html | head -1"
```

---

## Why This Works:

1. **Fresh Build** - Removes old dist folder completely
2. **Synchronous Build** - Uses npx vite build directly (not npm run build which can run in background)
3. **Clear Old Files** - Removes old JS/CSS/HTML before deploying new ones
4. **Tar Archive** - Creates compressed archive for faster upload
5. **SSH Pipe** - Uploads via SSH pipe (no rsync needed)
6. **Correct Permissions** - Sets 644 for files, 755 for folders
7. **Verification** - Checks the new file is actually deployed

---

## SSH Authentication:

- SSH key is configured at: `~/.ssh/greenofig_key`
- SSH config alias: `greenofig-hostinger`
- No password needed!

---

## Important Notes:

- **ALWAYS** do a fresh build (`rm -rf dist` first)
- **ALWAYS** clear old files on server before uploading
- **ALWAYS** verify the deployment worked
- Build takes ~18-23 seconds
- Deployment takes ~5-10 seconds
- Total time: ~30 seconds

---

## After Deployment:

User must clear browser cache to see changes:
1. Press Ctrl + Shift + Delete
2. Select "Cached images and files"
3. Select "All time"
4. Click "Clear data"
5. Visit site and press Ctrl + Shift + R

OR use Incognito mode to test immediately.

---

## Files on Server:

- Location: `domains/greenofig.com/public_html/`
- index.html (changes with each build)
- .htaccess (stable - has CSP headers)
- assets/ folder (all JS/CSS files with hashed names)

---

**This process was verified working on: Nov 1, 2025**
**Main JS file after deployment: index-Bp5hATV1.js**
